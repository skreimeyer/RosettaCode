{"task": "Main_step_of_GOST_28147-89", "blocks": [{"lang": "BBC BASIC", "loc": 31, "block": "<pre class=\"text highlighted_source\">      DIM table&amp;(7,15), test%(1)<br/>      table&amp;() =  4, 10,  9,  2, 13,  8,  0, 14,  6, 11,  1, 12,  7, 15,  5,  3, \\<br/>      \\          14, 11,  4, 12,  6, 13, 15, 10,  2,  3,  8,  1,  0,  7,  5,  9, \\<br/>      \\           5,  8,  1, 13, 10,  3,  4,  2, 14, 15, 12,  7,  6,  0,  9, 11, \\<br/>      \\           7, 13, 10,  1,  0,  8,  9, 15, 14,  4,  6, 12, 11,  2,  5,  3, \\<br/>      \\           6, 12,  7,  1,  5, 15, 13,  8,  4, 10,  9, 14,  0,  3, 11,  2, \\<br/>      \\           4, 11, 10,  0,  7,  2,  1, 13,  3,  6,  8,  5,  9, 12, 15, 14, \\<br/>      \\          13, 11,  4,  1,  3, 15,  5,  9,  0, 10, 14,  7,  6,  8,  2, 12, \\<br/>      \\           1, 15, 13,  0,  5,  7, 10,  4,  9,  2,  3, 14,  6, 11,  8, 12<br/>\u00a0<br/>      test%() = &amp;043B0421, &amp;04320430<br/>      key% = &amp;E2C104F9<br/>      PROCmainstep(test%(), key%, table&amp;())<br/>      PRINT ~ test%(0) test%(1)<br/>      END<br/>\u00a0<br/>      DEF PROCmainstep(n%(), key%, t&amp;())<br/>      LOCAL i%, s%, cell&amp;, new_s%<br/>      s% = FN32(n%(0) + key%)<br/>      FOR i% = 0 TO 3<br/>        cell&amp; = (s% &gt;&gt;&gt; (i%*8)) AND &amp;FF<br/>        new_s% += (t&amp;(i%*2,cell&amp; MOD 16) + 16*t&amp;(i%*2+1,cell&amp; DIV 16)) &lt;&lt; (i%*8)<br/>      NEXT<br/>      s% = ((new_s% &lt;&lt; 11) OR (new_s% &gt;&gt;&gt; 21)) EOR n%(1)<br/>      n%(1) = n%(0)\u00a0: n%(0) = s%<br/>      ENDPROC<br/>\u00a0<br/>      DEF FN32(v)<br/>      WHILE v&gt;&amp;7FFFFFFF\u00a0: v-=2^32\u00a0: ENDWHILE<br/>      WHILE v&lt;&amp;80000000\u00a0: v+=2^32\u00a0: ENDWHILE<br/>      = v</pre>"}, {"lang": "C", "loc": 33, "block": "<pre class=\"c highlighted_source\"><span class=\"kw4\">static</span> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">char</span> <span class=\"kw4\">const</span> k8<span class=\"br0\">[</span><span class=\"nu0\">16</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"br0\">{</span>\t<span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span> <span class=\"br0\">}</span><span class=\"sy0\">;</span> <br/><span class=\"kw4\">static</span> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">char</span> <span class=\"kw4\">const</span> k7<span class=\"br0\">[</span><span class=\"nu0\">16</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"br0\">{</span>\t<span class=\"nu0\">15</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span> <span class=\"br0\">}</span><span class=\"sy0\">;</span><br/><span class=\"kw4\">static</span> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">char</span> <span class=\"kw4\">const</span> k6<span class=\"br0\">[</span><span class=\"nu0\">16</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"br0\">{</span>\t<span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span> <span class=\"br0\">}</span><span class=\"sy0\">;</span><br/><span class=\"kw4\">static</span> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">char</span> <span class=\"kw4\">const</span> k5<span class=\"br0\">[</span><span class=\"nu0\">16</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"br0\">{</span>\t <span class=\"nu0\">7</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span> <span class=\"br0\">}</span><span class=\"sy0\">;</span><br/><span class=\"kw4\">static</span> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">char</span> <span class=\"kw4\">const</span> k4<span class=\"br0\">[</span><span class=\"nu0\">16</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"br0\">{</span>\t <span class=\"nu0\">2</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span> <span class=\"br0\">}</span><span class=\"sy0\">;</span><br/><span class=\"kw4\">static</span> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">char</span> <span class=\"kw4\">const</span> k3<span class=\"br0\">[</span><span class=\"nu0\">16</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"br0\">{</span>\t<span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span> <span class=\"br0\">}</span><span class=\"sy0\">;</span><br/><span class=\"kw4\">static</span> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">char</span> <span class=\"kw4\">const</span> k2<span class=\"br0\">[</span><span class=\"nu0\">16</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"br0\">{</span>\t <span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span> <span class=\"br0\">}</span><span class=\"sy0\">;</span><br/><span class=\"kw4\">static</span> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">char</span> <span class=\"kw4\">const</span> k1<span class=\"br0\">[</span><span class=\"nu0\">16</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"br0\">{</span>\t<span class=\"nu0\">13</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span> <span class=\"br0\">}</span><span class=\"sy0\">;</span><br/>\u00a0<br/><span class=\"kw4\">static</span> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">char</span> k87<span class=\"br0\">[</span><span class=\"nu0\">256</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/><span class=\"kw4\">static</span> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">char</span> k65<span class=\"br0\">[</span><span class=\"nu0\">256</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/><span class=\"kw4\">static</span> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">char</span> k43<span class=\"br0\">[</span><span class=\"nu0\">256</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/><span class=\"kw4\">static</span> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">char</span> k21<span class=\"br0\">[</span><span class=\"nu0\">256</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>\u00a0<br/><span class=\"kw4\">void</span><br/>kboxinit<span class=\"br0\">(</span><span class=\"kw4\">void</span><span class=\"br0\">)</span><br/><span class=\"br0\">{</span><br/>\t<span class=\"kw4\">int</span> i<span class=\"sy0\">;</span><br/>\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span>i <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span> i <span class=\"sy0\">&lt;</span> <span class=\"nu0\">256</span><span class=\"sy0\">;</span> i<span class=\"sy0\">++</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>\t\tk87<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> k8<span class=\"br0\">[</span>i <span class=\"sy0\">&gt;&gt;</span> <span class=\"nu0\">4</span><span class=\"br0\">]</span> <span class=\"sy0\">&lt;&lt;</span> <span class=\"nu0\">4</span> <span class=\"sy0\">|</span> k7<span class=\"br0\">[</span>i <span class=\"sy0\">&amp;</span> <span class=\"nu0\">15</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>\t\tk65<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> k6<span class=\"br0\">[</span>i <span class=\"sy0\">&gt;&gt;</span> <span class=\"nu0\">4</span><span class=\"br0\">]</span> <span class=\"sy0\">&lt;&lt;</span> <span class=\"nu0\">4</span> <span class=\"sy0\">|</span> k5<span class=\"br0\">[</span>i <span class=\"sy0\">&amp;</span> <span class=\"nu0\">15</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>\t\tk43<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> k4<span class=\"br0\">[</span>i <span class=\"sy0\">&gt;&gt;</span> <span class=\"nu0\">4</span><span class=\"br0\">]</span> <span class=\"sy0\">&lt;&lt;</span> <span class=\"nu0\">4</span> <span class=\"sy0\">|</span> k3<span class=\"br0\">[</span>i <span class=\"sy0\">&amp;</span> <span class=\"nu0\">15</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>\t\tk21<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> k2<span class=\"br0\">[</span>i <span class=\"sy0\">&gt;&gt;</span> <span class=\"nu0\">4</span><span class=\"br0\">]</span> <span class=\"sy0\">&lt;&lt;</span> <span class=\"nu0\">4</span> <span class=\"sy0\">|</span> k1<span class=\"br0\">[</span>i <span class=\"sy0\">&amp;</span> <span class=\"nu0\">15</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>\t<span class=\"br0\">}</span><br/><span class=\"br0\">}</span><br/>\u00a0<br/><span class=\"kw4\">static</span> word32<br/>f<span class=\"br0\">(</span>word32 x<span class=\"br0\">)</span><br/><span class=\"br0\">{</span><br/>\tx <span class=\"sy0\">=</span> k87<span class=\"br0\">[</span>x<span class=\"sy0\">&gt;&gt;</span><span class=\"nu0\">24</span> <span class=\"sy0\">&amp;</span> <span class=\"nu0\">255</span><span class=\"br0\">]</span> <span class=\"sy0\">&lt;&lt;</span> <span class=\"nu0\">24</span> <span class=\"sy0\">|</span> k65<span class=\"br0\">[</span>x<span class=\"sy0\">&gt;&gt;</span><span class=\"nu0\">16</span> <span class=\"sy0\">&amp;</span> <span class=\"nu0\">255</span><span class=\"br0\">]</span> <span class=\"sy0\">&lt;&lt;</span> <span class=\"nu0\">16</span> <span class=\"sy0\">|</span><br/>\t    k43<span class=\"br0\">[</span>x<span class=\"sy0\">&gt;&gt;</span> <span class=\"nu0\">8</span> <span class=\"sy0\">&amp;</span> <span class=\"nu0\">255</span><span class=\"br0\">]</span> <span class=\"sy0\">&lt;&lt;</span>  <span class=\"nu0\">8</span> <span class=\"sy0\">|</span> k21<span class=\"br0\">[</span>x <span class=\"sy0\">&amp;</span> <span class=\"nu0\">255</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>\t<span class=\"kw1\">return</span> x<span class=\"sy0\">&lt;&lt;</span><span class=\"nu0\">11</span> <span class=\"sy0\">|</span> x<span class=\"sy0\">&gt;&gt;</span><span class=\"br0\">(</span><span class=\"nu0\">32</span><span class=\"sy0\">-</span><span class=\"nu0\">11</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/><span class=\"br0\">}</span></pre>"}, {"lang": "C++", "loc": 34, "block": "<pre class=\"cpp highlighted_source\">UINT_64 TGost<span class=\"sy4\">::</span><span class=\"me2\">SWAP32</span><span class=\"br0\">(</span>UINT_32 N1, UINT_32 N2<span class=\"br0\">)</span><br/><span class=\"br0\">{</span><br/>    UINT_64 N<span class=\"sy4\">;</span><br/>\tN <span class=\"sy1\">=</span> N1<span class=\"sy4\">;</span><br/>\tN <span class=\"sy1\">=</span> <span class=\"br0\">(</span>N<span class=\"sy1\">&lt;&lt;</span><span class=\"nu0\">32</span><span class=\"br0\">)</span><span class=\"sy3\">|</span>N2<span class=\"sy4\">;</span><br/>\t<span class=\"kw1\">return</span> UINT_64<span class=\"br0\">(</span>N<span class=\"br0\">)</span><span class=\"sy4\">;</span><br/><span class=\"br0\">}</span><br/>\u00a0<br/>UINT_32 TGost<span class=\"sy4\">::</span><span class=\"me2\">ReplaceBlock</span><span class=\"br0\">(</span>UINT_32 x<span class=\"br0\">)</span><br/><span class=\"br0\">{</span>   <br/>    <span class=\"kw4\">register</span> i<span class=\"sy4\">;</span><br/>    UINT_32 res <span class=\"sy1\">=</span> 0UL<span class=\"sy4\">;</span><br/>    <span class=\"kw1\">for</span><span class=\"br0\">(</span>i<span class=\"sy1\">=</span><span class=\"nu0\">7</span><span class=\"sy4\">;</span>i<span class=\"sy1\">&gt;=</span><span class=\"nu0\">0</span><span class=\"sy4\">;</span>i<span class=\"sy2\">--</span><span class=\"br0\">)</span><br/>    <span class=\"br0\">{</span><br/>       ui4_0 <span class=\"sy1\">=</span> x<span class=\"sy1\">&gt;&gt;</span><span class=\"br0\">(</span>i<span class=\"sy2\">*</span><span class=\"nu0\">4</span><span class=\"br0\">)</span><span class=\"sy4\">;</span><br/>       ui4_0 <span class=\"sy1\">=</span> BS<span class=\"br0\">[</span>ui4_0<span class=\"br0\">]</span><span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"sy4\">;</span><br/>       res <span class=\"sy1\">=</span> <span class=\"br0\">(</span>res<span class=\"sy1\">&lt;&lt;</span><span class=\"nu0\">4</span><span class=\"br0\">)</span><span class=\"sy3\">|</span>ui4_0<span class=\"sy4\">;</span><br/>    <span class=\"br0\">}</span><br/>    <span class=\"kw1\">return</span> res<span class=\"sy4\">;</span><br/><span class=\"br0\">}</span><br/>\u00a0<br/>UINT_64 TGost<span class=\"sy4\">::</span><span class=\"me2\">MainStep</span><span class=\"br0\">(</span>UINT_64 N,UINT_32 X<span class=\"br0\">)</span><br/><span class=\"br0\">{</span><br/>   UINT_32 N1,N2,S<span class=\"sy1\">=</span>0UL<span class=\"sy4\">;</span><br/>   N1<span class=\"sy1\">=</span>UINT_32<span class=\"br0\">(</span>N<span class=\"br0\">)</span><span class=\"sy4\">;</span><br/>   N2<span class=\"sy1\">=</span>N<span class=\"sy1\">&gt;&gt;</span><span class=\"nu0\">32</span><span class=\"sy4\">;</span><br/>   S <span class=\"sy1\">=</span> N1 <span class=\"sy2\">+</span> X <span class=\"sy2\">%</span> <span class=\"nu12\">0x4000000000000</span><span class=\"sy4\">;</span><br/>   S <span class=\"sy1\">=</span> ReplaceBlock<span class=\"br0\">(</span>S<span class=\"br0\">)</span><span class=\"sy4\">;</span><br/>   S <span class=\"sy1\">=</span> <span class=\"br0\">(</span>S<span class=\"sy1\">&lt;&lt;</span><span class=\"nu0\">11</span><span class=\"br0\">)</span><span class=\"sy3\">|</span><span class=\"br0\">(</span>S<span class=\"sy1\">&gt;&gt;</span><span class=\"nu0\">21</span><span class=\"br0\">)</span><span class=\"sy4\">;</span><br/>   S <span class=\"sy3\">^</span><span class=\"sy1\">=</span> N2<span class=\"sy4\">;</span><br/>   N2 <span class=\"sy1\">=</span> N1<span class=\"sy4\">;</span><br/>   N1 <span class=\"sy1\">=</span> S<span class=\"sy4\">;</span><br/>   <span class=\"kw1\">return</span> SWAP32<span class=\"br0\">(</span>N2,N1<span class=\"br0\">)</span><span class=\"sy4\">;</span><br/><span class=\"br0\">}</span></pre>"}, {"lang": "D", "loc": 71, "block": "<pre class=\"d highlighted_source\"><span class=\"kw2\">import</span> std.<span class=\"me1\">stdio</span><span class=\"sy0\">,</span> std.<span class=\"me1\">range</span><span class=\"sy0\">,</span> std.<span class=\"me1\">algorithm</span><span class=\"sy0\">;</span><br/>\u00a0<br/><span class=\"co2\">/// Rotate uint left.</span><br/><span class=\"kw4\">uint</span> rol<span class=\"br0\">(</span><span class=\"kw2\">in</span> <span class=\"kw4\">uint</span> x<span class=\"sy0\">,</span> <span class=\"kw2\">in</span> <span class=\"kw4\">uint</span> nBits<span class=\"br0\">)</span> @<span class=\"kw4\">safe</span> <span class=\"kw4\">pure</span> <span class=\"kw4\">nothrow</span> @nogc <span class=\"br0\">{</span><br/>    <span class=\"kw1\">return</span> <span class=\"br0\">(</span>x <span class=\"sy0\">&lt;&lt;</span> nBits<span class=\"br0\">)</span> <span class=\"sy0\">|</span> <span class=\"br0\">(</span>x <span class=\"sy0\">&gt;&gt;</span> <span class=\"br0\">(</span><span class=\"nu0\">32</span> <span class=\"sy0\">-</span> nBits<span class=\"br0\">)</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/><span class=\"br0\">}</span><br/>\u00a0<br/><span class=\"kw2\">alias</span> Nibble <span class=\"sy0\">=</span> <span class=\"kw4\">ubyte</span><span class=\"sy0\">;</span> <span class=\"co1\">// 4 bits used.</span><br/><span class=\"kw2\">alias</span> SBox <span class=\"sy0\">=</span> <span class=\"kw4\">immutable</span> Nibble<span class=\"br0\">[</span><span class=\"nu0\">16</span><span class=\"br0\">]</span><span class=\"br0\">[</span><span class=\"nu0\">8</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>\u00a0<br/><span class=\"kw4\">private</span> <span class=\"kw4\">bool</span> _validateSBox<span class=\"br0\">(</span><span class=\"kw2\">in</span> SBox data<span class=\"br0\">)</span> @<span class=\"kw4\">safe</span> <span class=\"kw4\">pure</span> <span class=\"kw4\">nothrow</span> @nogc <span class=\"br0\">{</span><br/>    <span class=\"kw1\">foreach</span> <span class=\"br0\">(</span><span class=\"kw4\">const</span> <span class=\"kw2\">ref</span> row<span class=\"sy0\">;</span> data<span class=\"br0\">)</span><br/>        <span class=\"kw1\">foreach</span> <span class=\"br0\">(</span>ub<span class=\"sy0\">;</span> row<span class=\"br0\">)</span><br/>            <span class=\"kw1\">if</span> <span class=\"br0\">(</span>ub <span class=\"sy0\">&gt;=</span> <span class=\"nu0\">16</span><span class=\"br0\">)</span> <span class=\"co1\">// Verify it's a nibble.</span><br/>                <span class=\"kw1\">return</span> <span class=\"kw2\">false</span><span class=\"sy0\">;</span><br/>    <span class=\"kw1\">return</span> <span class=\"kw2\">true</span><span class=\"sy0\">;</span><br/><span class=\"br0\">}</span><br/>\u00a0<br/><span class=\"kw4\">struct</span> GOST<span class=\"br0\">(</span>s<span class=\"sy0\">...</span><span class=\"br0\">)</span> <span class=\"kw1\">if</span> <span class=\"br0\">(</span>s.<span class=\"me1\">length</span> <span class=\"sy0\">==</span> <span class=\"nu0\">1</span> <span class=\"sy0\">&amp;&amp;</span> s<span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span>._validateSBox<span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>    <span class=\"kw4\">private</span> <span class=\"kw4\">static</span> generate<span class=\"br0\">(</span><span class=\"kw4\">ubyte</span> k<span class=\"br0\">)</span><span class=\"br0\">(</span><span class=\"br0\">)</span> @<span class=\"kw4\">safe</span> <span class=\"kw4\">pure</span> <span class=\"kw4\">nothrow</span> <span class=\"br0\">{</span><br/>        <span class=\"kw1\">return</span> k87.<span class=\"me1\">length</span>.<span class=\"me1\">iota</span><br/>               .<span class=\"me1\">map</span><span class=\"sy0\">!</span><span class=\"br0\">(</span>i<span class=\"sy0\">=&gt;</span> <span class=\"br0\">(</span>s<span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"br0\">]</span><span class=\"br0\">[</span>i <span class=\"sy0\">&gt;&gt;</span> <span class=\"nu0\">4</span><span class=\"br0\">]</span> <span class=\"sy0\">&lt;&lt;</span> <span class=\"nu0\">4</span><span class=\"br0\">)</span> <span class=\"sy0\">|</span> s<span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span><span class=\"br0\">[</span>k <span class=\"sy0\">-</span> <span class=\"nu0\">1</span><span class=\"br0\">]</span><span class=\"br0\">[</span>i <span class=\"sy0\">&amp;</span> <span class=\"nu12\">0xF</span><span class=\"br0\">]</span><span class=\"br0\">)</span><br/>               .<span class=\"me1\">array</span><span class=\"sy0\">;</span><br/>    <span class=\"br0\">}</span><br/>\u00a0<br/>    <span class=\"kw4\">private</span> <span class=\"kw4\">uint</span><span class=\"br0\">[</span><span class=\"nu0\">2</span><span class=\"br0\">]</span> buffer<span class=\"sy0\">;</span><br/>    <span class=\"kw4\">private</span> <span class=\"kw4\">static</span> <span class=\"kw4\">immutable</span> <span class=\"kw4\">ubyte</span><span class=\"br0\">[</span><span class=\"nu0\">256</span><span class=\"br0\">]</span> k87 <span class=\"sy0\">=</span> generate<span class=\"sy0\">!</span><span class=\"nu0\">7</span><span class=\"sy0\">,</span><br/>                                        k65 <span class=\"sy0\">=</span> generate<span class=\"sy0\">!</span><span class=\"nu0\">5</span><span class=\"sy0\">,</span><br/>                                        k43 <span class=\"sy0\">=</span> generate<span class=\"sy0\">!</span><span class=\"nu0\">3</span><span class=\"sy0\">,</span><br/>                                        k21 <span class=\"sy0\">=</span> generate<span class=\"sy0\">!</span><span class=\"nu0\">1</span><span class=\"sy0\">;</span><br/>\u00a0<br/>    <span class=\"co1\">// Endianess problems?</span><br/>    <span class=\"kw4\">private</span> <span class=\"kw4\">static</span> <span class=\"kw4\">uint</span> f<span class=\"br0\">(</span><span class=\"kw2\">in</span> <span class=\"kw4\">uint</span> x<span class=\"br0\">)</span> <span class=\"kw4\">pure</span> <span class=\"kw4\">nothrow</span> @nogc @<span class=\"kw4\">safe</span> <span class=\"br0\">{</span><br/>        <span class=\"kw4\">immutable</span> <span class=\"kw4\">uint</span> y <span class=\"sy0\">=</span> <span class=\"br0\">(</span>k87<span class=\"br0\">[</span><span class=\"br0\">(</span>x <span class=\"sy0\">&gt;&gt;</span> <span class=\"nu0\">24</span><span class=\"br0\">)</span> <span class=\"sy0\">&amp;</span> <span class=\"nu12\">0xFF</span><span class=\"br0\">]</span> <span class=\"sy0\">&lt;&lt;</span> <span class=\"nu0\">24</span><span class=\"br0\">)</span> <span class=\"sy0\">|</span><br/>                           <span class=\"br0\">(</span>k65<span class=\"br0\">[</span><span class=\"br0\">(</span>x <span class=\"sy0\">&gt;&gt;</span> <span class=\"nu0\">16</span><span class=\"br0\">)</span> <span class=\"sy0\">&amp;</span> <span class=\"nu12\">0xFF</span><span class=\"br0\">]</span> <span class=\"sy0\">&lt;&lt;</span> <span class=\"nu0\">16</span><span class=\"br0\">)</span> <span class=\"sy0\">|</span><br/>                           <span class=\"br0\">(</span>k43<span class=\"br0\">[</span><span class=\"br0\">(</span>x <span class=\"sy0\">&gt;&gt;</span>  <span class=\"nu0\">8</span><span class=\"br0\">)</span> <span class=\"sy0\">&amp;</span> <span class=\"nu12\">0xFF</span><span class=\"br0\">]</span> <span class=\"sy0\">&lt;&lt;</span>  <span class=\"nu0\">8</span><span class=\"br0\">)</span> <span class=\"sy0\">|</span><br/>                            k21<span class=\"br0\">[</span> x        <span class=\"sy0\">&amp;</span> <span class=\"nu12\">0xFF</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>        <span class=\"kw1\">return</span> rol<span class=\"br0\">(</span>y<span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>    <span class=\"br0\">}</span><br/>\u00a0<br/>    <span class=\"co1\">// This performs only a step of the encoding.</span><br/>    <span class=\"kw4\">public</span> <span class=\"kw4\">void</span> mainStep<span class=\"br0\">(</span><span class=\"kw2\">in</span> <span class=\"kw4\">uint</span><span class=\"br0\">[</span><span class=\"nu0\">2</span><span class=\"br0\">]</span> input<span class=\"sy0\">,</span> <span class=\"kw2\">in</span> <span class=\"kw4\">uint</span> key<span class=\"br0\">)</span><br/>    <span class=\"kw4\">pure</span> <span class=\"kw4\">nothrow</span> @nogc @<span class=\"kw4\">safe</span> <span class=\"br0\">{</span><br/>        buffer<span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> f<span class=\"br0\">(</span>key <span class=\"sy0\">+</span> input<span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span><span class=\"br0\">)</span> <span class=\"sy0\">^</span> input<span class=\"br0\">[</span><span class=\"nu0\">1</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>        buffer<span class=\"br0\">[</span><span class=\"nu0\">1</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> input<span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>    <span class=\"br0\">}</span><br/><span class=\"br0\">}</span><br/>\u00a0<br/><span class=\"kw4\">void</span> main<span class=\"br0\">(</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>    <span class=\"co1\">// S-boxes used by the Central Bank of Russian Federation:</span><br/>    <span class=\"co1\">// http://en.wikipedia.org/wiki/GOST_28147-89</span><br/>    <span class=\"co1\">// (This is a matrix of nibbles).</span><br/>    <span class=\"kw4\">enum</span> SBox cbrf <span class=\"sy0\">=</span> <span class=\"br0\">[</span><br/>      <span class=\"br0\">[</span> <span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>      <span class=\"br0\">[</span><span class=\"nu0\">14</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>      <span class=\"br0\">[</span> <span class=\"nu0\">5</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>      <span class=\"br0\">[</span> <span class=\"nu0\">7</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>      <span class=\"br0\">[</span> <span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>      <span class=\"br0\">[</span> <span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>      <span class=\"br0\">[</span><span class=\"nu0\">13</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>      <span class=\"br0\">[</span> <span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"br0\">]</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>\u00a0<br/>    GOST<span class=\"sy0\">!</span>cbrf g<span class=\"sy0\">;</span><br/>\u00a0<br/>    <span class=\"co1\">// Example from the talk page (bytes swapped for endianess):</span><br/>    <span class=\"kw4\">immutable</span> <span class=\"kw4\">uint</span><span class=\"br0\">[</span><span class=\"nu0\">2</span><span class=\"br0\">]</span> input <span class=\"sy0\">=</span> <span class=\"br0\">[</span>0x_04_3B_04_21<span class=\"sy0\">,</span> 0x_04_32_04_30<span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>    <span class=\"kw4\">immutable</span> <span class=\"kw4\">uint</span> key <span class=\"sy0\">=</span> 0x_E2_C1_04_F9<span class=\"sy0\">;</span><br/>\u00a0<br/>    g.<span class=\"me1\">mainStep</span><span class=\"br0\">(</span>input<span class=\"sy0\">,</span> key<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>    writefln<span class=\"br0\">(</span><span class=\"st0\">\"%(%08X\u00a0%)\"</span><span class=\"sy0\">,</span> g.<span class=\"me1\">buffer</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/><span class=\"br0\">}</span></pre>"}, {"lang": "JavaScript", "loc": 23, "block": "<pre class=\"javascript highlighted_source\"><span class=\"kw1\">var</span> \u0422\u0430\u0431\u043b\u0438\u0446\u0430_\u0437\u0430\u043c\u0435\u043d <span class=\"sy0\">=</span> <span class=\"br0\">[</span><br/>  <span class=\"br0\">[</span> <span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>  <span class=\"br0\">[</span><span class=\"nu0\">14</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>  <span class=\"br0\">[</span> <span class=\"nu0\">5</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>  <span class=\"br0\">[</span> <span class=\"nu0\">7</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>  <span class=\"br0\">[</span> <span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>  <span class=\"br0\">[</span> <span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>  <span class=\"br0\">[</span><span class=\"nu0\">13</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>  <span class=\"br0\">[</span> <span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"br0\">]</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>\u00a0<br/><span class=\"kw1\">function</span> \u041e\u0441\u043d\u043e\u0432\u043d\u043e\u0439\u0428\u0430\u0433<span class=\"br0\">(</span>\u0431\u043b\u043e\u043a_\u0442\u0435\u043a\u0441\u0442\u0430<span class=\"sy0\">,</span> \u044d\u043b\u0435\u043c\u0435\u043d\u0442_\u043a\u043b\u044e\u0447\u0430<span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>  <span class=\"kw1\">var</span> N <span class=\"sy0\">=</span> \u0431\u043b\u043e\u043a_\u0442\u0435\u043a\u0441\u0442\u0430.<span class=\"me1\">slice</span><span class=\"br0\">(</span><span class=\"nu0\">0</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>  <span class=\"kw1\">var</span> X <span class=\"sy0\">=</span> \u044d\u043b\u0435\u043c\u0435\u043d\u0442_\u043a\u043b\u044e\u0447\u0430<span class=\"sy0\">;</span><br/>  <span class=\"kw1\">var</span> S <span class=\"sy0\">=</span> <span class=\"br0\">(</span>N<span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span> <span class=\"sy0\">+</span> X<span class=\"br0\">)</span> <span class=\"sy0\">&amp;</span> 0xFFFFFFFF<span class=\"sy0\">;</span><br/>  <span class=\"kw1\">var</span> \u044f\u0447\u0435\u0439\u043a\u0430<span class=\"sy0\">;</span> <span class=\"kw1\">var</span> \u043d\u043e\u0432_S <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span><br/>  <span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw1\">var</span> \u0441\u0447 <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span> \u0441\u0447 <span class=\"sy0\">&lt;</span> <span class=\"nu0\">4</span><span class=\"sy0\">;</span> \u0441\u0447<span class=\"sy0\">++</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>    \u044f\u0447\u0435\u0439\u043a\u0430 <span class=\"sy0\">=</span> <span class=\"br0\">(</span>S <span class=\"sy0\">&gt;&gt;&gt;</span> <span class=\"br0\">(</span>\u0441\u0447 <span class=\"sy0\">&lt;&lt;</span> <span class=\"nu0\">3</span><span class=\"br0\">)</span><span class=\"br0\">)</span> <span class=\"sy0\">&amp;</span> 0xFF<span class=\"sy0\">;</span><br/>    \u043d\u043e\u0432_S <span class=\"sy0\">+=</span> <span class=\"br0\">(</span>\u0422\u0430\u0431\u043b\u0438\u0446\u0430_\u0437\u0430\u043c\u0435\u043d<span class=\"br0\">[</span>\u0441\u0447<span class=\"sy0\">*</span><span class=\"nu0\">2</span><span class=\"br0\">]</span><span class=\"br0\">[</span>\u044f\u0447\u0435\u0439\u043a\u0430 <span class=\"sy0\">&amp;</span> 0x0F<span class=\"br0\">]</span> <span class=\"sy0\">+</span> <span class=\"br0\">(</span>\u0422\u0430\u0431\u043b\u0438\u0446\u0430_\u0437\u0430\u043c\u0435\u043d<span class=\"br0\">[</span>\u0441\u0447<span class=\"sy0\">*</span><span class=\"nu0\">2</span><span class=\"sy0\">+</span><span class=\"nu0\">1</span><span class=\"br0\">]</span><span class=\"br0\">[</span>\u044f\u0447\u0435\u0439\u043a\u0430 <span class=\"sy0\">&gt;&gt;&gt;</span> <span class=\"nu0\">4</span><span class=\"br0\">]</span> <span class=\"sy0\">&lt;&lt;</span> <span class=\"nu0\">4</span><span class=\"br0\">)</span><span class=\"br0\">)</span> <span class=\"sy0\">&lt;&lt;</span> <span class=\"br0\">(</span>\u0441\u0447 <span class=\"sy0\">&lt;&lt;</span> <span class=\"nu0\">3</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>  <span class=\"br0\">}</span><br/>  S <span class=\"sy0\">=</span> <span class=\"br0\">(</span><span class=\"br0\">(</span><span class=\"br0\">(</span>\u043d\u043e\u0432_S <span class=\"sy0\">&lt;&lt;</span> <span class=\"nu0\">11</span><span class=\"br0\">)</span> <span class=\"sy0\">+</span> <span class=\"br0\">(</span>\u043d\u043e\u0432_S <span class=\"sy0\">&gt;&gt;&gt;</span> <span class=\"nu0\">21</span><span class=\"br0\">)</span><span class=\"br0\">)</span> <span class=\"sy0\">&amp;</span> 0xFFFFFFFF<span class=\"br0\">)</span> <span class=\"sy0\">^</span> N<span class=\"br0\">[</span><span class=\"nu0\">1</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>  N<span class=\"br0\">[</span><span class=\"nu0\">1</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> N<span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span><span class=\"sy0\">;</span> N<span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> S<span class=\"sy0\">;</span><br/>  <span class=\"kw1\">return</span> N<span class=\"sy0\">;</span><br/><span class=\"br0\">}</span></pre>"}, {"lang": "Glagol", "loc": 1, "block": "<pre> <b>\u041f\u0415\u0420</b> \n   \u041a\u043b\u044e\u0447: <b>\u0420\u042f\u0414</b> 8 <b>\u0418\u0417</b> <b>\u0426\u0415\u041b</b>; \n   \u0422\u0430\u0431\u043b\u0438\u0446\u0430\u0417\u0430\u043c\u0435\u043d: <b>\u0420\u042f\u0414</b> 8, 16 <b>\u0418\u0417</b> <b>\u042f\u0427\u0426\u0415\u041b</b>; \n \n <b>\u0417\u0410\u0414\u0410\u0427\u0410</b> \u0411\u0435\u0437\u0437\u043d\u0421\u043b\u0436\u041f\u043e\u041c\u043e\u043432(\u04471, \u04472: <b>\u0426\u0415\u041b</b>): <b>\u0426\u0415\u041b</b>; \n <b>\u041f\u0415\u0420</b> \n    \u043f\u0430\u043c\u044f\u0442\u044c1, \u043f\u0430\u043c\u044f\u0442\u044c2: <b>\u0428\u0418\u0420\u0426\u0415\u041b</b>; \n    \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442: <b>\u0426\u0415\u041b</b>; \n <b>\u0423\u041a\u0410\u0417</b> \n   \u043f\u0430\u043c\u044f\u0442\u044c1\u00a0:= 0; <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041e\u0431\u0440\u0430\u0437</i>(<i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(\u04471), <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(\u043f\u0430\u043c\u044f\u0442\u044c1), 4); \n   \u043f\u0430\u043c\u044f\u0442\u044c2\u00a0:= 0; <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041e\u0431\u0440\u0430\u0437</i>(<i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(\u04472), <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(\u043f\u0430\u043c\u044f\u0442\u044c2), 4); \n   <b>\u0423\u0412\u0415\u041b\u0418\u0427\u0418\u0422\u042c</b>(\u043f\u0430\u043c\u044f\u0442\u044c1, \u043f\u0430\u043c\u044f\u0442\u044c2); \n   <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041e\u0431\u0440\u0430\u0437</i>(<i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(\u043f\u0430\u043c\u044f\u0442\u044c1), <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(\u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442), 4); \n   <b>\u0412\u041e\u0417\u0412\u0420\u0410\u0422</b> \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \n <b>\u041a\u041e\u041d</b> \u0411\u0435\u0437\u0437\u043d\u0421\u043b\u0436\u041f\u043e\u041c\u043e\u043432; \n  \n <b>\u0417\u0410\u0414\u0410\u0427\u0410</b> \u0418\u0441\u043a\u043b\u0418\u041b\u0418(\u04471, \u04472: <b>\u0426\u0415\u041b</b>): <b>\u0426\u0415\u041b</b>; \n <b>\u0423\u041a\u0410\u0417</b> \n   <b>\u0412\u041e\u0417\u0412\u0420\u0410\u0422</b> <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435</i>(<b>\u0426\u0415\u041b</b>, <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435</i>(<b>\u041c\u041d\u041e\u0416</b>, \u04471) / <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435</i>(<b>\u041c\u041d\u041e\u0416</b>, \u04472)) \n <b>\u041a\u041e\u041d</b> \u0418\u0441\u043a\u043b\u0418\u041b\u0418; \n \n <b>\u0417\u0410\u0414\u0410\u0427\u0410</b> \u0417\u0430\u043c\u0435\u043d\u0430(\u0441\u0442\u0440: <b>\u042f\u0427\u0426\u0415\u041b</b>; \u044f\u0447: <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u042f\u0447\u0435\u0439\u043a\u0430</i>): <b>\u042f\u0427\u0426\u0415\u041b</b>; \n <b>\u041f\u0415\u0420</b> \n   \u043f1, \u043f2, \u043f3: <b>\u0426\u0415\u041b</b>; \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442: <b>\u042f\u0427\u0426\u0415\u041b</b>;\n <b>\u0423\u041a\u0410\u0417</b> \n   \u043f1\u00a0:= 0; \u043f2\u00a0:= 0; <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041e\u0431\u0440\u0430\u0437</i>(<i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(\u044f\u0447), <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(\u043f1), 1); \n   \u043f1\u00a0:= \u0410\u0441\u043c.\u0421\u0434\u0432\u0438\u0433(\u043f1, 4); <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041e\u0431\u0440\u0430\u0437</i>(<i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(\u043f1), <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(\u043f2), 1); \n   \u043f2\u00a0:= \u0410\u0441\u043c.\u0421\u0434\u0432\u0438\u0433(\u043f2, -4); \u043f1\u00a0:= \u0410\u0441\u043c.\u0421\u0434\u0432\u0438\u0433(\u043f1, -8); \n   \u043f3\u00a0:= \u0422\u0430\u0431\u043b\u0438\u0446\u0430\u0417\u0430\u043c\u0435\u043d[\u0441\u0442\u0440*2, \u043f2] + \u0410\u0441\u043c.\u0421\u0434\u0432\u0438\u0433(\u0422\u0430\u0431\u043b\u0438\u0446\u0430\u0417\u0430\u043c\u0435\u043d[\u0441\u0442\u0440*2+1, \u043f1], 4); \n   <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041e\u0431\u0440\u0430\u0437</i>(<i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(\u043f3), <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(\u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442), 1); \n   <b>\u0412\u041e\u0417\u0412\u0420\u0410\u0422</b> \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\n <b>\u041a\u041e\u041d</b> \u0417\u0430\u043c\u0435\u043d\u0430; \n \n <b>\u0417\u0410\u0414\u0410\u0427\u0410</b> \u041e\u0441\u043d\u043e\u0432\u043d\u043e\u0439\u0428\u0430\u0433(N: <b>\u0428\u0418\u0420\u0426\u0415\u041b</b>; X: <b>\u0426\u0415\u041b</b>): <b>\u0428\u0418\u0420\u0426\u0415\u041b</b>; \n <b>\u041f\u0415\u0420</b> \n   N1, N2, S: <b>\u0426\u0415\u041b</b>; \n   \u0441\u0447: <b>\u042f\u0427\u0426\u0415\u041b</b>; \n   \u044f\u0447\u0435\u0439\u043a\u0430: <b>\u042f\u0427\u0426\u0415\u041b</b>; \n   \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442: <b>\u0428\u0418\u0420\u0426\u0415\u041b</b>; \n <b>\u0423\u041a\u0410\u0417</b> \n   <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041e\u0431\u0440\u0430\u0437</i>(<i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(N), <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(N1), 4); \n   <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041e\u0431\u0440\u0430\u0437</i>(<i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(N)+4, <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(N2), 4); \n   S\u00a0:= \u0411\u0435\u0437\u0437\u043d\u0421\u043b\u0436\u041f\u043e\u041c\u043e\u043432(N1, X); \n   <b>\u041e\u0422</b> \u0441\u0447\u00a0:= 0 <b>\u0414\u041e</b> 3 <b>\u0412\u042b\u041f </b>\n     <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041e\u0431\u0440\u0430\u0437</i>(<i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(S)+\u0441\u0447, <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(\u044f\u0447\u0435\u0439\u043a\u0430), 1); \n     \u044f\u0447\u0435\u0439\u043a\u0430\u00a0:= \u0417\u0430\u043c\u0435\u043d\u0430(\u0441\u0447, \u044f\u0447\u0435\u0439\u043a\u0430); \n     <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041e\u0431\u0440\u0430\u0437</i>(<i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(\u044f\u0447\u0435\u0439\u043a\u0430), <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(S)+\u0441\u0447, 1) \n   <b>\u041a\u041e\u041d</b>; \n   S\u00a0:= \u0410\u0441\u043c.\u0412\u0440\u0430\u0449\u0435\u043d\u0438\u0435(S, 11); \n   S\u00a0:= \u0418\u0441\u043a\u043b\u0418\u041b\u0418(S, N2); \n   N2\u00a0:= N1; N1\u00a0:= S; \n   <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041e\u0431\u0440\u0430\u0437</i>(<i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(N1), <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(\u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442), 4); \n   <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041e\u0431\u0440\u0430\u0437</i>(<i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(N2), <i><b>\u041e\u0411\u0425\u041e\u0414</b></i>.<i>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u0410\u0434\u0440\u0435\u0441</i>(\u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442)+4, 4); \n   <b>\u0412\u041e\u0417\u0412\u0420\u0410\u0422</b> \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \n <b>\u041a\u041e\u041d</b> \u041e\u0441\u043d\u043e\u0432\u043d\u043e\u0439\u0428\u0430\u0433;\n</pre>"}, {"lang": "Go", "loc": 75, "block": "<pre class=\"go highlighted_source\"><span class=\"kw1\">package</span> main<br/>\u00a0<br/><span class=\"kw1\">import</span> <span class=\"st0\">\"fmt\"</span><br/>\u00a0<br/><span class=\"kw1\">type</span> sBox <span class=\"sy1\">[</span><span class=\"nu0\">8</span><span class=\"sy1\">][</span><span class=\"nu0\">16</span><span class=\"sy1\">]</span><span class=\"kw4\">byte</span><br/>\u00a0<br/><span class=\"kw1\">type</span> gost <span class=\"kw4\">struct</span> <span class=\"sy1\">{</span><br/>    k87<span class=\"sy1\">,</span> k65<span class=\"sy1\">,</span> k43<span class=\"sy1\">,</span> k21 <span class=\"sy1\">[</span><span class=\"nu0\">256</span><span class=\"sy1\">]</span><span class=\"kw4\">byte</span><br/>    enc                <span class=\"sy1\">[]</span><span class=\"kw4\">byte</span><br/><span class=\"sy1\">}</span><br/>\u00a0<br/><span class=\"kw4\">func</span> newGost<span class=\"sy1\">(</span>s <span class=\"sy3\">*</span>sBox<span class=\"sy1\">)</span> <span class=\"sy3\">*</span>gost <span class=\"sy1\">{</span><br/>    <span class=\"kw1\">var</span> g gost<br/>    <span class=\"kw1\">for</span> <span class=\"nu2\">i</span> <span class=\"sy2\">:=</span> <span class=\"kw1\">range</span> g<span class=\"sy3\">.</span>k87 <span class=\"sy1\">{</span><br/>        g<span class=\"sy3\">.</span>k87<span class=\"sy1\">[</span><span class=\"nu2\">i</span><span class=\"sy1\">]</span> <span class=\"sy2\">=</span> s<span class=\"sy1\">[</span><span class=\"nu0\">7</span><span class=\"sy1\">][</span><span class=\"nu2\">i</span>&gt;&gt;<span class=\"nu0\">4</span><span class=\"sy1\">]</span>&lt;&lt;<span class=\"nu0\">4</span> <span class=\"sy3\">|</span> s<span class=\"sy1\">[</span><span class=\"nu0\">6</span><span class=\"sy1\">][</span><span class=\"nu2\">i</span>&amp;<span class=\"nu0\">15</span><span class=\"sy1\">]</span><br/>        g<span class=\"sy3\">.</span>k65<span class=\"sy1\">[</span><span class=\"nu2\">i</span><span class=\"sy1\">]</span> <span class=\"sy2\">=</span> s<span class=\"sy1\">[</span><span class=\"nu0\">5</span><span class=\"sy1\">][</span><span class=\"nu2\">i</span>&gt;&gt;<span class=\"nu0\">4</span><span class=\"sy1\">]</span>&lt;&lt;<span class=\"nu0\">4</span> <span class=\"sy3\">|</span> s<span class=\"sy1\">[</span><span class=\"nu0\">4</span><span class=\"sy1\">][</span><span class=\"nu2\">i</span>&amp;<span class=\"nu0\">15</span><span class=\"sy1\">]</span><br/>        g<span class=\"sy3\">.</span>k43<span class=\"sy1\">[</span><span class=\"nu2\">i</span><span class=\"sy1\">]</span> <span class=\"sy2\">=</span> s<span class=\"sy1\">[</span><span class=\"nu0\">3</span><span class=\"sy1\">][</span><span class=\"nu2\">i</span>&gt;&gt;<span class=\"nu0\">4</span><span class=\"sy1\">]</span>&lt;&lt;<span class=\"nu0\">4</span> <span class=\"sy3\">|</span> s<span class=\"sy1\">[</span><span class=\"nu0\">2</span><span class=\"sy1\">][</span><span class=\"nu2\">i</span>&amp;<span class=\"nu0\">15</span><span class=\"sy1\">]</span><br/>        g<span class=\"sy3\">.</span>k21<span class=\"sy1\">[</span><span class=\"nu2\">i</span><span class=\"sy1\">]</span> <span class=\"sy2\">=</span> s<span class=\"sy1\">[</span><span class=\"nu0\">1</span><span class=\"sy1\">][</span><span class=\"nu2\">i</span>&gt;&gt;<span class=\"nu0\">4</span><span class=\"sy1\">]</span>&lt;&lt;<span class=\"nu0\">4</span> <span class=\"sy3\">|</span> s<span class=\"sy1\">[</span><span class=\"nu0\">0</span><span class=\"sy1\">][</span><span class=\"nu2\">i</span>&amp;<span class=\"nu0\">15</span><span class=\"sy1\">]</span><br/>    <span class=\"sy1\">}</span><br/>    g<span class=\"sy3\">.</span>enc <span class=\"sy2\">=</span> <span class=\"kw3\">make</span><span class=\"sy1\">([]</span><span class=\"kw4\">byte</span><span class=\"sy1\">,</span> <span class=\"nu0\">8</span><span class=\"sy1\">)</span><br/>    <span class=\"kw1\">return</span> &amp;g<br/><span class=\"sy1\">}</span><br/>\u00a0<br/><span class=\"kw4\">func</span> <span class=\"sy1\">(</span>g <span class=\"sy3\">*</span>gost<span class=\"sy1\">)</span> f<span class=\"sy1\">(</span>x <span class=\"kw4\">uint32</span><span class=\"sy1\">)</span> <span class=\"kw4\">uint32</span> <span class=\"sy1\">{</span><br/>    x <span class=\"sy2\">=</span> <span class=\"kw4\">uint32</span><span class=\"sy1\">(</span>g<span class=\"sy3\">.</span>k87<span class=\"sy1\">[</span>x&gt;&gt;<span class=\"nu0\">24</span>&amp;<span class=\"nu0\">255</span><span class=\"sy1\">])</span>&lt;&lt;<span class=\"nu0\">24</span> <span class=\"sy3\">|</span> <span class=\"kw4\">uint32</span><span class=\"sy1\">(</span>g<span class=\"sy3\">.</span>k65<span class=\"sy1\">[</span>x&gt;&gt;<span class=\"nu0\">16</span>&amp;<span class=\"nu0\">255</span><span class=\"sy1\">])</span>&lt;&lt;<span class=\"nu0\">16</span> <span class=\"sy3\">|</span><br/>        <span class=\"kw4\">uint32</span><span class=\"sy1\">(</span>g<span class=\"sy3\">.</span>k43<span class=\"sy1\">[</span>x&gt;&gt;<span class=\"nu0\">8</span>&amp;<span class=\"nu0\">255</span><span class=\"sy1\">])</span>&lt;&lt;<span class=\"nu0\">8</span> <span class=\"sy3\">|</span> <span class=\"kw4\">uint32</span><span class=\"sy1\">(</span>g<span class=\"sy3\">.</span>k21<span class=\"sy1\">[</span>x&amp;<span class=\"nu0\">255</span><span class=\"sy1\">])</span><br/>    <span class=\"kw1\">return</span> x&lt;&lt;<span class=\"nu0\">11</span> <span class=\"sy3\">|</span> x&gt;&gt;<span class=\"sy1\">(</span><span class=\"nu0\">32</span><span class=\"sy3\">-</span><span class=\"nu0\">11</span><span class=\"sy1\">)</span><br/><span class=\"sy1\">}</span><br/>\u00a0<br/><span class=\"co1\">// code above adapted from posted C code</span><br/>\u00a0<br/><span class=\"co1\">// validation code below follows example on talk page</span><br/>\u00a0<br/><span class=\"co1\">// cbrf from WP</span><br/><span class=\"kw1\">var</span> cbrf <span class=\"sy2\">=</span> sBox<span class=\"sy1\">{</span><br/>    <span class=\"sy1\">{</span><span class=\"nu0\">4</span><span class=\"sy1\">,</span> <span class=\"nu0\">10</span><span class=\"sy1\">,</span> <span class=\"nu0\">9</span><span class=\"sy1\">,</span> <span class=\"nu0\">2</span><span class=\"sy1\">,</span> <span class=\"nu0\">13</span><span class=\"sy1\">,</span> <span class=\"nu0\">8</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy1\">,</span> <span class=\"nu0\">14</span><span class=\"sy1\">,</span> <span class=\"nu0\">6</span><span class=\"sy1\">,</span> <span class=\"nu0\">11</span><span class=\"sy1\">,</span> <span class=\"nu0\">1</span><span class=\"sy1\">,</span> <span class=\"nu0\">12</span><span class=\"sy1\">,</span> <span class=\"nu0\">7</span><span class=\"sy1\">,</span> <span class=\"nu0\">15</span><span class=\"sy1\">,</span> <span class=\"nu0\">5</span><span class=\"sy1\">,</span> <span class=\"nu0\">3</span><span class=\"sy1\">},</span><br/>    <span class=\"sy1\">{</span><span class=\"nu0\">14</span><span class=\"sy1\">,</span> <span class=\"nu0\">11</span><span class=\"sy1\">,</span> <span class=\"nu0\">4</span><span class=\"sy1\">,</span> <span class=\"nu0\">12</span><span class=\"sy1\">,</span> <span class=\"nu0\">6</span><span class=\"sy1\">,</span> <span class=\"nu0\">13</span><span class=\"sy1\">,</span> <span class=\"nu0\">15</span><span class=\"sy1\">,</span> <span class=\"nu0\">10</span><span class=\"sy1\">,</span> <span class=\"nu0\">2</span><span class=\"sy1\">,</span> <span class=\"nu0\">3</span><span class=\"sy1\">,</span> <span class=\"nu0\">8</span><span class=\"sy1\">,</span> <span class=\"nu0\">1</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy1\">,</span> <span class=\"nu0\">7</span><span class=\"sy1\">,</span> <span class=\"nu0\">5</span><span class=\"sy1\">,</span> <span class=\"nu0\">9</span><span class=\"sy1\">},</span><br/>    <span class=\"sy1\">{</span><span class=\"nu0\">5</span><span class=\"sy1\">,</span> <span class=\"nu0\">8</span><span class=\"sy1\">,</span> <span class=\"nu0\">1</span><span class=\"sy1\">,</span> <span class=\"nu0\">13</span><span class=\"sy1\">,</span> <span class=\"nu0\">10</span><span class=\"sy1\">,</span> <span class=\"nu0\">3</span><span class=\"sy1\">,</span> <span class=\"nu0\">4</span><span class=\"sy1\">,</span> <span class=\"nu0\">2</span><span class=\"sy1\">,</span> <span class=\"nu0\">14</span><span class=\"sy1\">,</span> <span class=\"nu0\">15</span><span class=\"sy1\">,</span> <span class=\"nu0\">12</span><span class=\"sy1\">,</span> <span class=\"nu0\">7</span><span class=\"sy1\">,</span> <span class=\"nu0\">6</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy1\">,</span> <span class=\"nu0\">9</span><span class=\"sy1\">,</span> <span class=\"nu0\">11</span><span class=\"sy1\">},</span><br/>    <span class=\"sy1\">{</span><span class=\"nu0\">7</span><span class=\"sy1\">,</span> <span class=\"nu0\">13</span><span class=\"sy1\">,</span> <span class=\"nu0\">10</span><span class=\"sy1\">,</span> <span class=\"nu0\">1</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy1\">,</span> <span class=\"nu0\">8</span><span class=\"sy1\">,</span> <span class=\"nu0\">9</span><span class=\"sy1\">,</span> <span class=\"nu0\">15</span><span class=\"sy1\">,</span> <span class=\"nu0\">14</span><span class=\"sy1\">,</span> <span class=\"nu0\">4</span><span class=\"sy1\">,</span> <span class=\"nu0\">6</span><span class=\"sy1\">,</span> <span class=\"nu0\">12</span><span class=\"sy1\">,</span> <span class=\"nu0\">11</span><span class=\"sy1\">,</span> <span class=\"nu0\">2</span><span class=\"sy1\">,</span> <span class=\"nu0\">5</span><span class=\"sy1\">,</span> <span class=\"nu0\">3</span><span class=\"sy1\">},</span><br/>    <span class=\"sy1\">{</span><span class=\"nu0\">6</span><span class=\"sy1\">,</span> <span class=\"nu0\">12</span><span class=\"sy1\">,</span> <span class=\"nu0\">7</span><span class=\"sy1\">,</span> <span class=\"nu0\">1</span><span class=\"sy1\">,</span> <span class=\"nu0\">5</span><span class=\"sy1\">,</span> <span class=\"nu0\">15</span><span class=\"sy1\">,</span> <span class=\"nu0\">13</span><span class=\"sy1\">,</span> <span class=\"nu0\">8</span><span class=\"sy1\">,</span> <span class=\"nu0\">4</span><span class=\"sy1\">,</span> <span class=\"nu0\">10</span><span class=\"sy1\">,</span> <span class=\"nu0\">9</span><span class=\"sy1\">,</span> <span class=\"nu0\">14</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy1\">,</span> <span class=\"nu0\">3</span><span class=\"sy1\">,</span> <span class=\"nu0\">11</span><span class=\"sy1\">,</span> <span class=\"nu0\">2</span><span class=\"sy1\">},</span><br/>    <span class=\"sy1\">{</span><span class=\"nu0\">4</span><span class=\"sy1\">,</span> <span class=\"nu0\">11</span><span class=\"sy1\">,</span> <span class=\"nu0\">10</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy1\">,</span> <span class=\"nu0\">7</span><span class=\"sy1\">,</span> <span class=\"nu0\">2</span><span class=\"sy1\">,</span> <span class=\"nu0\">1</span><span class=\"sy1\">,</span> <span class=\"nu0\">13</span><span class=\"sy1\">,</span> <span class=\"nu0\">3</span><span class=\"sy1\">,</span> <span class=\"nu0\">6</span><span class=\"sy1\">,</span> <span class=\"nu0\">8</span><span class=\"sy1\">,</span> <span class=\"nu0\">5</span><span class=\"sy1\">,</span> <span class=\"nu0\">9</span><span class=\"sy1\">,</span> <span class=\"nu0\">12</span><span class=\"sy1\">,</span> <span class=\"nu0\">15</span><span class=\"sy1\">,</span> <span class=\"nu0\">14</span><span class=\"sy1\">},</span><br/>    <span class=\"sy1\">{</span><span class=\"nu0\">13</span><span class=\"sy1\">,</span> <span class=\"nu0\">11</span><span class=\"sy1\">,</span> <span class=\"nu0\">4</span><span class=\"sy1\">,</span> <span class=\"nu0\">1</span><span class=\"sy1\">,</span> <span class=\"nu0\">3</span><span class=\"sy1\">,</span> <span class=\"nu0\">15</span><span class=\"sy1\">,</span> <span class=\"nu0\">5</span><span class=\"sy1\">,</span> <span class=\"nu0\">9</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy1\">,</span> <span class=\"nu0\">10</span><span class=\"sy1\">,</span> <span class=\"nu0\">14</span><span class=\"sy1\">,</span> <span class=\"nu0\">7</span><span class=\"sy1\">,</span> <span class=\"nu0\">6</span><span class=\"sy1\">,</span> <span class=\"nu0\">8</span><span class=\"sy1\">,</span> <span class=\"nu0\">2</span><span class=\"sy1\">,</span> <span class=\"nu0\">12</span><span class=\"sy1\">},</span><br/>    <span class=\"sy1\">{</span><span class=\"nu0\">1</span><span class=\"sy1\">,</span> <span class=\"nu0\">15</span><span class=\"sy1\">,</span> <span class=\"nu0\">13</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy1\">,</span> <span class=\"nu0\">5</span><span class=\"sy1\">,</span> <span class=\"nu0\">7</span><span class=\"sy1\">,</span> <span class=\"nu0\">10</span><span class=\"sy1\">,</span> <span class=\"nu0\">4</span><span class=\"sy1\">,</span> <span class=\"nu0\">9</span><span class=\"sy1\">,</span> <span class=\"nu0\">2</span><span class=\"sy1\">,</span> <span class=\"nu0\">3</span><span class=\"sy1\">,</span> <span class=\"nu0\">14</span><span class=\"sy1\">,</span> <span class=\"nu0\">6</span><span class=\"sy1\">,</span> <span class=\"nu0\">11</span><span class=\"sy1\">,</span> <span class=\"nu0\">8</span><span class=\"sy1\">,</span> <span class=\"nu0\">12</span><span class=\"sy1\">},</span><br/><span class=\"sy1\">}</span><br/>\u00a0<br/><span class=\"kw4\">func</span> u32<span class=\"sy1\">(</span>b <span class=\"sy1\">[]</span><span class=\"kw4\">byte</span><span class=\"sy1\">)</span> <span class=\"kw4\">uint32</span> <span class=\"sy1\">{</span><br/>    <span class=\"kw1\">return</span> <span class=\"kw4\">uint32</span><span class=\"sy1\">(</span>b<span class=\"sy1\">[</span><span class=\"nu0\">0</span><span class=\"sy1\">])</span> <span class=\"sy3\">|</span> <span class=\"kw4\">uint32</span><span class=\"sy1\">(</span>b<span class=\"sy1\">[</span><span class=\"nu0\">1</span><span class=\"sy1\">])</span>&lt;&lt;<span class=\"nu0\">8</span> <span class=\"sy3\">|</span> <span class=\"kw4\">uint32</span><span class=\"sy1\">(</span>b<span class=\"sy1\">[</span><span class=\"nu0\">2</span><span class=\"sy1\">])</span>&lt;&lt;<span class=\"nu0\">16</span> <span class=\"sy3\">|</span> <span class=\"kw4\">uint32</span><span class=\"sy1\">(</span>b<span class=\"sy1\">[</span><span class=\"nu0\">3</span><span class=\"sy1\">])</span>&lt;&lt;<span class=\"nu0\">24</span><br/><span class=\"sy1\">}</span><br/>\u00a0<br/><span class=\"kw4\">func</span> b4<span class=\"sy1\">(</span>u <span class=\"kw4\">uint32</span><span class=\"sy1\">,</span> b <span class=\"sy1\">[]</span><span class=\"kw4\">byte</span><span class=\"sy1\">)</span> <span class=\"sy1\">{</span><br/>    b<span class=\"sy1\">[</span><span class=\"nu0\">0</span><span class=\"sy1\">]</span> <span class=\"sy2\">=</span> <span class=\"kw4\">byte</span><span class=\"sy1\">(</span>u<span class=\"sy1\">)</span><br/>    b<span class=\"sy1\">[</span><span class=\"nu0\">1</span><span class=\"sy1\">]</span> <span class=\"sy2\">=</span> <span class=\"kw4\">byte</span><span class=\"sy1\">(</span>u &gt;&gt; <span class=\"nu0\">8</span><span class=\"sy1\">)</span><br/>    b<span class=\"sy1\">[</span><span class=\"nu0\">2</span><span class=\"sy1\">]</span> <span class=\"sy2\">=</span> <span class=\"kw4\">byte</span><span class=\"sy1\">(</span>u &gt;&gt; <span class=\"nu0\">16</span><span class=\"sy1\">)</span><br/>    b<span class=\"sy1\">[</span><span class=\"nu0\">3</span><span class=\"sy1\">]</span> <span class=\"sy2\">=</span> <span class=\"kw4\">byte</span><span class=\"sy1\">(</span>u &gt;&gt; <span class=\"nu0\">24</span><span class=\"sy1\">)</span><br/><span class=\"sy1\">}</span><br/>\u00a0<br/><span class=\"kw4\">func</span> <span class=\"sy1\">(</span>g <span class=\"sy3\">*</span>gost<span class=\"sy1\">)</span> mainStep<span class=\"sy1\">(</span>input <span class=\"sy1\">[]</span><span class=\"kw4\">byte</span><span class=\"sy1\">,</span> key <span class=\"sy1\">[]</span><span class=\"kw4\">byte</span><span class=\"sy1\">)</span> <span class=\"sy1\">{</span><br/>    key32 <span class=\"sy2\">:=</span> u32<span class=\"sy1\">(</span>key<span class=\"sy1\">)</span><br/>    input1 <span class=\"sy2\">:=</span> u32<span class=\"sy1\">(</span>input<span class=\"sy1\">[:</span><span class=\"nu0\">4</span><span class=\"sy1\">])</span><br/>    input2 <span class=\"sy2\">:=</span> u32<span class=\"sy1\">(</span>input<span class=\"sy1\">[</span><span class=\"nu0\">4</span><span class=\"sy1\">:])</span><br/>    b4<span class=\"sy1\">(</span>g<span class=\"sy3\">.</span>f<span class=\"sy1\">(</span>key32<span class=\"sy3\">+</span>input1<span class=\"sy1\">)</span><span class=\"sy3\">^</span>input2<span class=\"sy1\">,</span> g<span class=\"sy3\">.</span>enc<span class=\"sy1\">[:</span><span class=\"nu0\">4</span><span class=\"sy1\">])</span><br/>    <span class=\"kw3\">copy</span><span class=\"sy1\">(</span>g<span class=\"sy3\">.</span>enc<span class=\"sy1\">[</span><span class=\"nu0\">4</span><span class=\"sy1\">:],</span> input<span class=\"sy1\">[:</span><span class=\"nu0\">4</span><span class=\"sy1\">])</span><br/><span class=\"sy1\">}</span><br/>\u00a0<br/><span class=\"kw4\">func</span> main<span class=\"sy1\">()</span> <span class=\"sy1\">{</span><br/>    input <span class=\"sy2\">:=</span> <span class=\"sy1\">[]</span><span class=\"kw4\">byte</span><span class=\"sy1\">{</span><span class=\"nu0\">0x21</span><span class=\"sy1\">,</span> <span class=\"nu0\">0x04</span><span class=\"sy1\">,</span> <span class=\"nu0\">0x3B</span><span class=\"sy1\">,</span> <span class=\"nu0\">0x04</span><span class=\"sy1\">,</span> <span class=\"nu0\">0x30</span><span class=\"sy1\">,</span> <span class=\"nu0\">0x04</span><span class=\"sy1\">,</span> <span class=\"nu0\">0x32</span><span class=\"sy1\">,</span> <span class=\"nu0\">0x04</span><span class=\"sy1\">}</span><br/>    key <span class=\"sy2\">:=</span> <span class=\"sy1\">[]</span><span class=\"kw4\">byte</span><span class=\"sy1\">{</span><span class=\"nu0\">0xF9</span><span class=\"sy1\">,</span> <span class=\"nu0\">0x04</span><span class=\"sy1\">,</span> <span class=\"nu0\">0xC1</span><span class=\"sy1\">,</span> <span class=\"nu0\">0xE2</span><span class=\"sy1\">}</span><br/>\u00a0<br/>    g <span class=\"sy2\">:=</span> newGost<span class=\"sy1\">(</span>&amp;cbrf<span class=\"sy1\">)</span><br/>    g<span class=\"sy3\">.</span>mainStep<span class=\"sy1\">(</span>input<span class=\"sy1\">,</span> key<span class=\"sy1\">)</span><br/>    <span class=\"kw1\">for</span> _<span class=\"sy1\">,</span> b <span class=\"sy2\">:=</span> <span class=\"kw1\">range</span> g<span class=\"sy3\">.</span>enc <span class=\"sy1\">{</span><br/>        fmt<span class=\"sy3\">.</span>Printf<span class=\"sy1\">(</span><span class=\"st0\">\"[%02x]\"</span><span class=\"sy1\">,</span> b<span class=\"sy1\">)</span><br/>    <span class=\"sy1\">}</span><br/>    fmt<span class=\"sy3\">.</span><span class=\"me1\">Println</span><span class=\"sy1\">()</span><br/><span class=\"sy1\">}</span></pre>"}, {"lang": "Julia", "loc": 43, "block": "<pre class=\"text highlighted_source\">\u00a0<br/>const k8 = [ 4, 10,  9,  2, 13,  8,  0, 14,  6, 11,  1, 12,  7, 15,  5,  3]<br/>const k7 = [14, 11,  4, 12,  6, 13, 15, 10,  2,  3,  8,  1,  0,  7,  5,  9]<br/>const k6 = [ 5,  8,  1, 13, 10,  3,  4,  2, 14, 15, 12,  7,  6,  0,  9, 11]<br/>const k5 = [ 7, 13, 10,  1,  0,  8,  9, 15, 14,  4,  6, 12, 11,  2,  5,  3]<br/>const k4 = [ 6, 12,  7,  1,  5, 15, 13,  8,  4, 10,  9, 14,  0,  3, 11,  2]<br/>const k3 = [ 4, 11, 10,  0,  7,  2,  1, 13,  3,  6,  8,  5,  9, 12, 15, 14]<br/>const k2 = [13, 11,  4,  1,  3, 15,  5,  9,  0, 10, 14,  7,  6,  8,  2, 12]<br/>const k1 = [ 1, 15, 13,  0,  5,  7, 10,  4,  9,  2,  3, 14,  6, 11,  8, 12]<br/>const k87 = zeros(UInt32,256)<br/>const k65 = zeros(UInt32,256)<br/>const k43 = zeros(UInt32,256)<br/>const k21 = zeros(UInt32,256)<br/>for i in 1:256<br/>    j = (i-1) &gt;&gt; 4 + 1<br/>    k = (i-1) &amp; 15 + 1<br/>    k87[i] = (k1[j] &lt;&lt; 4) | k2[k]<br/>    k65[i] = (k3[j] &lt;&lt; 4) | k4[k]<br/>    k43[i] = (k5[j] &lt;&lt; 4) | k6[k]<br/>    k21[i] = (k7[j] &lt;&lt; 4) | k8[k]<br/>end<br/>\u00a0<br/>function f(x)<br/>    y = (k87[(x&gt;&gt;24) &amp; 0xff + 1] &lt;&lt; 24) | (k65[(x&gt;&gt;16) &amp; 0xff + 1] &lt;&lt; 16) |<br/>        (k43[(x&gt;&gt; 8) &amp; 0xff + 1] &lt;&lt;  8) | k21[x &amp; 0xff + 1]<br/>    (y &lt;&lt; 11) | (y &gt;&gt; (32-11))<br/>end<br/>\u00a0<br/>bytes2int(arr) = arr[1] + (UInt32(arr[2]) &lt;&lt; 8) + (UInt32(arr[3]) &lt;&lt; 16) + (UInt32(arr[4])) &lt;&lt; 24<br/>int2bytes(x) = [UInt8(x&amp;0xff), UInt8((x&amp;0xff00)&gt;&gt;8), UInt8((x&amp;0xff0000)&gt;&gt;16), UInt8(x&gt;&gt;24)]<br/>\u00a0<br/>function mainstep(inputbytes, keybytes)<br/>    intkey = bytes2int(keybytes)<br/>    lowint = bytes2int(inputbytes[1:4])<br/>    topint = bytes2int(inputbytes[5:8])<br/>    xorbytes = f(UInt32(intkey) + UInt32(lowint)) \u22bb topint<br/>    vcat(int2bytes(xorbytes), inputbytes[1:4])<br/>end<br/>\u00a0<br/>const input = [0x21, 0x04, 0x3B, 0x04, 0x30, 0x04, 0x32, 0x04]<br/>const key = [0xF9, 0x04, 0xC1, 0xE2]   <br/>println(\"The encoded bytes are $(mainstep(input, key))\")<br/>\u00a0</pre>"}, {"lang": "Kotlin", "loc": 77, "block": "<pre class=\"scala highlighted_source\"><span class=\"co1\">// version 1.1.4-3</span><br/>\u00a0<br/>fun Byte.<span class=\"me1\">toUInt</span><span class=\"br0\">(</span><span class=\"br0\">)</span>  <span class=\"sy0\">=</span> java.<span class=\"me1\">lang</span>.<span class=\"me1\">Byte</span>.<span class=\"me1\">toUnsignedInt</span><span class=\"br0\">(</span><a href=\"http://scala-lang.org\"><span class=\"kw1\">this</span></a><span class=\"br0\">)</span><br/>\u00a0<br/>fun Byte.<span class=\"me1\">toULong</span><span class=\"br0\">(</span><span class=\"br0\">)</span> <span class=\"sy0\">=</span> java.<span class=\"me1\">lang</span>.<span class=\"me1\">Byte</span>.<span class=\"me1\">toUnsignedLong</span><span class=\"br0\">(</span><a href=\"http://scala-lang.org\"><span class=\"kw1\">this</span></a><span class=\"br0\">)</span><br/>\u00a0<br/>fun Int.<span class=\"me1\">toULong</span><span class=\"br0\">(</span><span class=\"br0\">)</span>  <span class=\"sy0\">=</span> java.<span class=\"me1\">lang</span>.<span class=\"me1\">Integer</span>.<span class=\"me1\">toUnsignedLong</span><span class=\"br0\">(</span><a href=\"http://scala-lang.org\"><span class=\"kw1\">this</span></a><span class=\"br0\">)</span><br/>\u00a0<br/><a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> s <span class=\"sy0\">=</span> arrayOf<span class=\"br0\">(</span><br/>    byteArrayOf<span class=\"br0\">(</span> <span class=\"nu0\">4</span>, <span class=\"nu0\">10</span>,  <span class=\"nu0\">9</span>,  <span class=\"nu0\">2</span>, <span class=\"nu0\">13</span>,  <span class=\"nu0\">8</span>,  <span class=\"nu0\">0</span>, <span class=\"nu0\">14</span>,  <span class=\"nu0\">6</span>, <span class=\"nu0\">11</span>,  <span class=\"nu0\">1</span>, <span class=\"nu0\">12</span>,  <span class=\"nu0\">7</span>, <span class=\"nu0\">15</span>,  <span class=\"nu0\">5</span>,  <span class=\"nu0\">3</span><span class=\"br0\">)</span>,<br/>    byteArrayOf<span class=\"br0\">(</span><span class=\"nu0\">14</span>, <span class=\"nu0\">11</span>,  <span class=\"nu0\">4</span>, <span class=\"nu0\">12</span>,  <span class=\"nu0\">6</span>, <span class=\"nu0\">13</span>, <span class=\"nu0\">15</span>, <span class=\"nu0\">10</span>,  <span class=\"nu0\">2</span>,  <span class=\"nu0\">3</span>,  <span class=\"nu0\">8</span>,  <span class=\"nu0\">1</span>,  <span class=\"nu0\">0</span>,  <span class=\"nu0\">7</span>,  <span class=\"nu0\">5</span>,  <span class=\"nu0\">9</span><span class=\"br0\">)</span>,<br/>    byteArrayOf<span class=\"br0\">(</span> <span class=\"nu0\">5</span>,  <span class=\"nu0\">8</span>,  <span class=\"nu0\">1</span>, <span class=\"nu0\">13</span>, <span class=\"nu0\">10</span>,  <span class=\"nu0\">3</span>,  <span class=\"nu0\">4</span>,  <span class=\"nu0\">2</span>, <span class=\"nu0\">14</span>, <span class=\"nu0\">15</span>, <span class=\"nu0\">12</span>,  <span class=\"nu0\">7</span>,  <span class=\"nu0\">6</span>,  <span class=\"nu0\">0</span>,  <span class=\"nu0\">9</span>, <span class=\"nu0\">11</span><span class=\"br0\">)</span>,<br/>    byteArrayOf<span class=\"br0\">(</span> <span class=\"nu0\">7</span>, <span class=\"nu0\">13</span>, <span class=\"nu0\">10</span>,  <span class=\"nu0\">1</span>,  <span class=\"nu0\">0</span>,  <span class=\"nu0\">8</span>,  <span class=\"nu0\">9</span>, <span class=\"nu0\">15</span>, <span class=\"nu0\">14</span>,  <span class=\"nu0\">4</span>,  <span class=\"nu0\">6</span>, <span class=\"nu0\">12</span>, <span class=\"nu0\">11</span>,  <span class=\"nu0\">2</span>,  <span class=\"nu0\">5</span>,  <span class=\"nu0\">3</span><span class=\"br0\">)</span>,<br/>    byteArrayOf<span class=\"br0\">(</span> <span class=\"nu0\">6</span>, <span class=\"nu0\">12</span>,  <span class=\"nu0\">7</span>,  <span class=\"nu0\">1</span>,  <span class=\"nu0\">5</span>, <span class=\"nu0\">15</span>, <span class=\"nu0\">13</span>,  <span class=\"nu0\">8</span>,  <span class=\"nu0\">4</span>, <span class=\"nu0\">10</span>,  <span class=\"nu0\">9</span>, <span class=\"nu0\">14</span>,  <span class=\"nu0\">0</span>,  <span class=\"nu0\">3</span>, <span class=\"nu0\">11</span>,  <span class=\"nu0\">2</span><span class=\"br0\">)</span>,<br/>    byteArrayOf<span class=\"br0\">(</span> <span class=\"nu0\">4</span>, <span class=\"nu0\">11</span>, <span class=\"nu0\">10</span>,  <span class=\"nu0\">0</span>,  <span class=\"nu0\">7</span>,  <span class=\"nu0\">2</span>,  <span class=\"nu0\">1</span>, <span class=\"nu0\">13</span>,  <span class=\"nu0\">3</span>,  <span class=\"nu0\">6</span>,  <span class=\"nu0\">8</span>,  <span class=\"nu0\">5</span>,  <span class=\"nu0\">9</span>, <span class=\"nu0\">12</span>, <span class=\"nu0\">15</span>, <span class=\"nu0\">14</span><span class=\"br0\">)</span>,<br/>    byteArrayOf<span class=\"br0\">(</span><span class=\"nu0\">13</span>, <span class=\"nu0\">11</span>,  <span class=\"nu0\">4</span>,  <span class=\"nu0\">1</span>,  <span class=\"nu0\">3</span>, <span class=\"nu0\">15</span>,  <span class=\"nu0\">5</span>,  <span class=\"nu0\">9</span>,  <span class=\"nu0\">0</span>, <span class=\"nu0\">10</span>, <span class=\"nu0\">14</span>,  <span class=\"nu0\">7</span>,  <span class=\"nu0\">6</span>,  <span class=\"nu0\">8</span>,  <span class=\"nu0\">2</span>, <span class=\"nu0\">12</span><span class=\"br0\">)</span>,<br/>    byteArrayOf<span class=\"br0\">(</span> <span class=\"nu0\">1</span>, <span class=\"nu0\">15</span>, <span class=\"nu0\">13</span>,  <span class=\"nu0\">0</span>,  <span class=\"nu0\">5</span>,  <span class=\"nu0\">7</span>, <span class=\"nu0\">10</span>,  <span class=\"nu0\">4</span>,  <span class=\"nu0\">9</span>,  <span class=\"nu0\">2</span>,  <span class=\"nu0\">3</span>, <span class=\"nu0\">14</span>,  <span class=\"nu0\">6</span>, <span class=\"nu0\">11</span>,  <span class=\"nu0\">8</span>, <span class=\"nu0\">12</span><span class=\"br0\">)</span><br/><span class=\"br0\">)</span><br/>\u00a0<br/><a href=\"http://scala-lang.org\"><span class=\"kw1\">class</span></a> Gost<span class=\"br0\">(</span><a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> sBox<span class=\"sy0\">:</span> Array<span class=\"sy0\">&lt;</span>ByteArray<span class=\"sy0\">&gt;</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>\u00a0<br/>    <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> k87 <span class=\"sy0\">=</span> ByteArray<span class=\"br0\">(</span><span class=\"nu0\">256</span><span class=\"br0\">)</span><br/>    <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> k65 <span class=\"sy0\">=</span> ByteArray<span class=\"br0\">(</span><span class=\"nu0\">256</span><span class=\"br0\">)</span><br/>    <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> k43 <span class=\"sy0\">=</span> ByteArray<span class=\"br0\">(</span><span class=\"nu0\">256</span><span class=\"br0\">)</span><br/>    <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> k21 <span class=\"sy0\">=</span> ByteArray<span class=\"br0\">(</span><span class=\"nu0\">256</span><span class=\"br0\">)</span><br/>    <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> enc <span class=\"sy0\">=</span> ByteArray<span class=\"br0\">(</span><span class=\"nu0\">8</span><span class=\"br0\">)</span><br/>\u00a0<br/>    init <span class=\"br0\">{</span><br/>        <a href=\"http://scala-lang.org\"><span class=\"kw1\">for</span></a> <span class=\"br0\">(</span>i in <span class=\"nu0\">0</span> until <span class=\"nu0\">256</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>            <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> j <span class=\"sy0\">=</span> i ushr <span class=\"nu0\">4</span><br/>            <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> k <span class=\"sy0\">=</span> i and <span class=\"nu0\">15</span> <br/>            k87<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"br0\">(</span><span class=\"br0\">(</span>sBox<span class=\"br0\">[</span><span class=\"nu0\">7</span><span class=\"br0\">]</span><span class=\"br0\">[</span>j<span class=\"br0\">]</span>.<span class=\"me1\">toUInt</span><span class=\"br0\">(</span><span class=\"br0\">)</span> shl <span class=\"nu0\">4</span><span class=\"br0\">)</span> or sBox<span class=\"br0\">[</span><span class=\"nu0\">6</span><span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"br0\">]</span>.<span class=\"me1\">toUInt</span><span class=\"br0\">(</span><span class=\"br0\">)</span><span class=\"br0\">)</span>.<span class=\"me1\">toByte</span><span class=\"br0\">(</span><span class=\"br0\">)</span><br/>            k65<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"br0\">(</span><span class=\"br0\">(</span>sBox<span class=\"br0\">[</span><span class=\"nu0\">5</span><span class=\"br0\">]</span><span class=\"br0\">[</span>j<span class=\"br0\">]</span>.<span class=\"me1\">toUInt</span><span class=\"br0\">(</span><span class=\"br0\">)</span> shl <span class=\"nu0\">4</span><span class=\"br0\">)</span> or sBox<span class=\"br0\">[</span><span class=\"nu0\">4</span><span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"br0\">]</span>.<span class=\"me1\">toUInt</span><span class=\"br0\">(</span><span class=\"br0\">)</span><span class=\"br0\">)</span>.<span class=\"me1\">toByte</span><span class=\"br0\">(</span><span class=\"br0\">)</span><br/>            k43<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"br0\">(</span><span class=\"br0\">(</span>sBox<span class=\"br0\">[</span><span class=\"nu0\">3</span><span class=\"br0\">]</span><span class=\"br0\">[</span>j<span class=\"br0\">]</span>.<span class=\"me1\">toUInt</span><span class=\"br0\">(</span><span class=\"br0\">)</span> shl <span class=\"nu0\">4</span><span class=\"br0\">)</span> or sBox<span class=\"br0\">[</span><span class=\"nu0\">2</span><span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"br0\">]</span>.<span class=\"me1\">toUInt</span><span class=\"br0\">(</span><span class=\"br0\">)</span><span class=\"br0\">)</span>.<span class=\"me1\">toByte</span><span class=\"br0\">(</span><span class=\"br0\">)</span><br/>            k21<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"br0\">(</span><span class=\"br0\">(</span>sBox<span class=\"br0\">[</span><span class=\"nu0\">1</span><span class=\"br0\">]</span><span class=\"br0\">[</span>j<span class=\"br0\">]</span>.<span class=\"me1\">toUInt</span><span class=\"br0\">(</span><span class=\"br0\">)</span> shl <span class=\"nu0\">4</span><span class=\"br0\">)</span> or sBox<span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"br0\">]</span>.<span class=\"me1\">toUInt</span><span class=\"br0\">(</span><span class=\"br0\">)</span><span class=\"br0\">)</span>.<span class=\"me1\">toByte</span><span class=\"br0\">(</span><span class=\"br0\">)</span><br/>        <span class=\"br0\">}</span><br/>    <span class=\"br0\">}</span><br/>\u00a0<br/>    fun f<span class=\"br0\">(</span>x<span class=\"sy0\">:</span> Int<span class=\"br0\">)</span><span class=\"sy0\">:</span> Int <span class=\"br0\">{</span><br/>        <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> y <span class=\"sy0\">=</span> <span class=\"br0\">(</span>k87<span class=\"br0\">[</span><span class=\"br0\">(</span>x ushr <span class=\"nu0\">24</span><span class=\"br0\">)</span> and <span class=\"nu0\">255</span><span class=\"br0\">]</span>.<span class=\"me1\">toULong</span><span class=\"br0\">(</span><span class=\"br0\">)</span> shl <span class=\"nu0\">24</span><span class=\"br0\">)</span> or<br/>                <span class=\"br0\">(</span>k65<span class=\"br0\">[</span><span class=\"br0\">(</span>x ushr <span class=\"nu0\">16</span><span class=\"br0\">)</span> and <span class=\"nu0\">255</span><span class=\"br0\">]</span>.<span class=\"me1\">toULong</span><span class=\"br0\">(</span><span class=\"br0\">)</span> shl <span class=\"nu0\">16</span><span class=\"br0\">)</span> or<br/>                <span class=\"br0\">(</span>k43<span class=\"br0\">[</span><span class=\"br0\">(</span>x ushr  <span class=\"nu0\">8</span><span class=\"br0\">)</span> and <span class=\"nu0\">255</span><span class=\"br0\">]</span>.<span class=\"me1\">toULong</span><span class=\"br0\">(</span><span class=\"br0\">)</span> shl  <span class=\"nu0\">8</span><span class=\"br0\">)</span> or<br/>                <span class=\"br0\">(</span>k21<span class=\"br0\">[</span> x and <span class=\"nu0\">255</span><span class=\"br0\">]</span>.<span class=\"me1\">toULong</span><span class=\"br0\">(</span><span class=\"br0\">)</span><span class=\"br0\">)</span>   <br/>        <a href=\"http://scala-lang.org\"><span class=\"kw1\">return</span></a> <span class=\"br0\">(</span><span class=\"br0\">(</span>y shl <span class=\"nu0\">11</span><span class=\"br0\">)</span> or <span class=\"br0\">(</span>y ushr <span class=\"nu0\">21</span><span class=\"br0\">)</span><span class=\"br0\">)</span>.<span class=\"me1\">toInt</span><span class=\"br0\">(</span><span class=\"br0\">)</span><br/>    <span class=\"br0\">}</span><br/>\u00a0<br/>    fun u32<span class=\"br0\">(</span>ba<span class=\"sy0\">:</span> ByteArray<span class=\"br0\">)</span><span class=\"sy0\">:</span> Int <span class=\"sy0\">=</span><br/>        <span class=\"br0\">(</span>ba<span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span>.<span class=\"me1\">toULong</span><span class=\"br0\">(</span><span class=\"br0\">)</span> or <br/>        <span class=\"br0\">(</span>ba<span class=\"br0\">[</span><span class=\"nu0\">1</span><span class=\"br0\">]</span>.<span class=\"me1\">toULong</span><span class=\"br0\">(</span><span class=\"br0\">)</span> shl <span class=\"nu0\">8</span><span class=\"br0\">)</span> or <br/>        <span class=\"br0\">(</span>ba<span class=\"br0\">[</span><span class=\"nu0\">2</span><span class=\"br0\">]</span>.<span class=\"me1\">toULong</span><span class=\"br0\">(</span><span class=\"br0\">)</span> shl <span class=\"nu0\">16</span><span class=\"br0\">)</span> or <br/>        <span class=\"br0\">(</span>ba<span class=\"br0\">[</span><span class=\"nu0\">3</span><span class=\"br0\">]</span>.<span class=\"me1\">toULong</span><span class=\"br0\">(</span><span class=\"br0\">)</span> shl <span class=\"nu0\">24</span><span class=\"br0\">)</span><span class=\"br0\">)</span>.<span class=\"me1\">toInt</span><span class=\"br0\">(</span><span class=\"br0\">)</span><br/>\u00a0<br/>    fun b4<span class=\"br0\">(</span>u<span class=\"sy0\">:</span> Int<span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>        enc<span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> u.<span class=\"me1\">toByte</span><span class=\"br0\">(</span><span class=\"br0\">)</span><br/>        enc<span class=\"br0\">[</span><span class=\"nu0\">1</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"br0\">(</span>u ushr  <span class=\"nu0\">8</span><span class=\"br0\">)</span>.<span class=\"me1\">toByte</span><span class=\"br0\">(</span><span class=\"br0\">)</span><br/>        enc<span class=\"br0\">[</span><span class=\"nu0\">2</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"br0\">(</span>u ushr <span class=\"nu0\">16</span><span class=\"br0\">)</span>.<span class=\"me1\">toByte</span><span class=\"br0\">(</span><span class=\"br0\">)</span><br/>        enc<span class=\"br0\">[</span><span class=\"nu0\">3</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"br0\">(</span>u ushr <span class=\"nu0\">24</span><span class=\"br0\">)</span>.<span class=\"me1\">toByte</span><span class=\"br0\">(</span><span class=\"br0\">)</span><br/>    <span class=\"br0\">}</span><br/>\u00a0<br/>    fun mainStep<span class=\"br0\">(</span>input<span class=\"sy0\">:</span> ByteArray, key<span class=\"sy0\">:</span> ByteArray<span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>        <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> key32  <span class=\"sy0\">=</span> u32<span class=\"br0\">(</span>key<span class=\"br0\">)</span><br/>        <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> input1 <span class=\"sy0\">=</span> u32<span class=\"br0\">(</span>input.<span class=\"me1\">sliceArray</span><span class=\"br0\">(</span><span class=\"nu0\">0</span>..<span class=\"nu0\">3</span><span class=\"br0\">)</span><span class=\"br0\">)</span><br/>        <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> input2 <span class=\"sy0\">=</span> u32<span class=\"br0\">(</span>input.<span class=\"me1\">sliceArray</span><span class=\"br0\">(</span><span class=\"nu0\">4</span>..<span class=\"nu0\">7</span><span class=\"br0\">)</span><span class=\"br0\">)</span><br/>        <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> temp   <span class=\"sy0\">=</span> <span class=\"br0\">(</span>key32.<span class=\"me1\">toULong</span><span class=\"br0\">(</span><span class=\"br0\">)</span> + input1.<span class=\"me1\">toULong</span><span class=\"br0\">(</span><span class=\"br0\">)</span><span class=\"br0\">)</span>.<span class=\"me1\">toInt</span><span class=\"br0\">(</span><span class=\"br0\">)</span><br/>        b4<span class=\"br0\">(</span>f<span class=\"br0\">(</span>temp<span class=\"br0\">)</span> xor input2<span class=\"br0\">)</span><br/>        <a href=\"http://scala-lang.org\"><span class=\"kw1\">for</span></a> <span class=\"br0\">(</span>i in <span class=\"nu0\">0</span>..<span class=\"nu0\">3</span><span class=\"br0\">)</span> enc<span class=\"br0\">[</span><span class=\"nu0\">4</span> + i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> input<span class=\"br0\">[</span>i<span class=\"br0\">]</span><br/>    <span class=\"br0\">}</span><br/><span class=\"br0\">}</span><br/>\u00a0<br/>fun main<span class=\"br0\">(</span>args<span class=\"sy0\">:</span> Array<span class=\"sy0\">&lt;</span>String<span class=\"sy0\">&gt;</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>    <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> input <span class=\"sy0\">=</span> byteArrayOf<span class=\"br0\">(</span>0x21, 0x04, 0x3B, 0x04, 0x30, 0x04, 0x32, 0x04<span class=\"br0\">)</span><br/>    <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> key <span class=\"sy0\">=</span> byteArrayOf<span class=\"br0\">(</span>0xF9.<span class=\"me1\">toByte</span><span class=\"br0\">(</span><span class=\"br0\">)</span>, 0x04, 0xC1.<span class=\"me1\">toByte</span><span class=\"br0\">(</span><span class=\"br0\">)</span>, 0xE2.<span class=\"me1\">toByte</span><span class=\"br0\">(</span><span class=\"br0\">)</span><span class=\"br0\">)</span>   <br/>    <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> g <span class=\"sy0\">=</span> Gost<span class=\"br0\">(</span>s<span class=\"br0\">)</span><br/>    g.<span class=\"me1\">mainStep</span><span class=\"br0\">(</span>input, key<span class=\"br0\">)</span><br/>    <a href=\"http://scala-lang.org\"><span class=\"kw1\">for</span></a> <span class=\"br0\">(</span>b in g.<span class=\"me1\">enc</span><span class=\"br0\">)</span> print<span class=\"br0\">(</span><span class=\"st0\">\"[%02X]\"</span>.<span class=\"me1\">format</span><span class=\"br0\">(</span>b<span class=\"br0\">)</span><span class=\"br0\">)</span><br/>    println<span class=\"br0\">(</span><span class=\"br0\">)</span><br/><span class=\"br0\">}</span></pre>"}, {"lang": "\u041c\u041a-61/52", "loc": 11, "block": "<pre class=\"text highlighted_source\">\u0418\u041f6\t\u0421/\u041f\t+\t\u041f6\t\u0418\u041f7\t\u0421/\u041f\t+\t\u041f7\t\u0418\u041fE\t-<br/>x&gt;=0\t14\t\u041f7\t\u041a\u0418\u041f6\t\u0418\u041f6\t\u0418\u041fE\t-\tx&gt;=0\t20\t\u041f6<br/>8\t\u041f2\t\u041f3\t2\t\u041f1\t4\t\u041f0\t0\t\u041f8\t1<br/>\u041f9\t\u041a\u0418\u041f2\t\u0418\u041fB\t/\t[x]\t\u041fA\t\u0412\u0445\t{x}\t\u0418\u041fB\t*<br/>\u0421/\u041f\t\u0418\u041f9\t*\t\u0418\u041f8\t+\t\u041f8\t\u0418\u041f9\t\u0418\u041fB\t*\t\u041f9<br/>\u0418\u041fA\tL0\t32\t\u0418\u041f8\t\u041a\u041f3\tL1\t25\t8\t\u041f0\t\u0418\u041f7<br/>\u041f\u041f\t93\t\u041f1\t\u0418\u041f6\t\u041f\u041f\t93\t\u0418\u041f5\t+\t\u041f6\t\u0418\u041f1<br/>\u0418\u041f4\t+\t\u041f7\t\u0418\u041f4\t\u0418\u041f6\t\u0421/\u041f\t\u041f4\t\u0418\u041f5\t\u0418\u041f7\t\u0421/\u041f<br/>\u041f5\t\u0418\u041f4\t\u0418\u041f6\t\u041f4\t&lt;-&gt;\t\u041f6\t\u0418\u041f5\t\u0418\u041f7\t\u041f5\t&lt;-&gt;<br/>\u041f7\t\u0411\u041f\t00\t\u0418\u041fC\t/\t[x]\t\u041a\u041f0\t\u0412x\t{x}\t\u0418\u041fC<br/>*\t\u0418\u041fD\t*\t\u0412/\u041e</pre>"}, {"lang": "Nim", "loc": 23, "block": "<pre class=\"text highlighted_source\">var <br/>  k8 = [14,  4, 13,  1,  2, 15, 11,  8,  3, 10,  6, 12,  5,  9,  0,  7]<br/>  k7 = [15,  1,  8, 14,  6, 11,  3,  4,  9,  7,  2, 13, 12,  0,  5, 10]<br/>  k6 = [10,  0,  9, 14,  6,  3, 15,  5,  1, 13, 12,  7, 11,  4,  2,  8]<br/>  k5 = [ 7, 13, 14,  3,  0,  6,  9, 10,  1,  2,  8,  5, 11, 12,  4, 15]<br/>  k4 = [ 2, 12,  4,  1,  7, 10, 11,  6,  8,  5,  3, 15, 13,  0, 14,  9]<br/>  k3 = [12,  1, 10, 15,  9,  2,  6,  8,  0, 13,  3,  4, 14,  7,  5, 11]<br/>  k2 = [ 4, 11,  2, 14, 15,  0,  8, 13,  3, 12,  9,  7,  5, 10,  6,  1]<br/>  k1 = [13,  2,  8,  4,  6, 15, 11,  1, 10,  9,  3, 14,  5,  0, 12,  7]<br/>\u00a0<br/>  k87, k65, k43, k21 = newSeq[int64](256)<br/>\u00a0<br/>proc kboxInit =<br/>  for i in 0 .. 255:<br/>    k87[i] = k8[i shr 4] shl 4 or k7[i and 15]<br/>    k65[i] = k6[i shr 4] shl 4 or k5[i and 15]<br/>    k43[i] = k4[i shr 4] shl 4 or k3[i and 15]<br/>    k21[i] = k2[i shr 4] shl 4 or k1[i and 15]<br/>\u00a0<br/>proc f(x): int64 =<br/>  let x = k87[x shr 24 and 255] shl 24 or k65[x shr 16 and 255] shl 16 or<br/>          k43[x shr 8 and 255] shl 8 or k21[x and 255]<br/>  x shl 11 or x shr (32 - 11)</pre>"}, {"lang": "Perl 6", "loc": 30, "block": "<pre class=\"perl6 highlighted_source\"><span class=\"co1\"># sboxes from http://en.wikipedia.org/wiki/GOST_(block_cipher)</span><br/><span class=\"kw1\">constant</span> sbox <span class=\"sy0\">=</span><br/>    <span class=\"br0\">[</span><span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span> <span class=\"nu0\">9</span><span class=\"sy0\">,</span> <span class=\"nu0\">2</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span> <span class=\"nu0\">8</span><span class=\"sy0\">,</span> <span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span> <span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span> <span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span> <span class=\"nu0\">7</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">5</span><span class=\"sy0\">,</span> <span class=\"nu0\">3</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>    <span class=\"br0\">[</span><span class=\"nu0\">14</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span> <span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span> <span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span> <span class=\"nu0\">2</span><span class=\"sy0\">,</span> <span class=\"nu0\">3</span><span class=\"sy0\">,</span> <span class=\"nu0\">8</span><span class=\"sy0\">,</span> <span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">7</span><span class=\"sy0\">,</span> <span class=\"nu0\">5</span><span class=\"sy0\">,</span> <span class=\"nu0\">9</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>    <span class=\"br0\">[</span><span class=\"nu0\">5</span><span class=\"sy0\">,</span> <span class=\"nu0\">8</span><span class=\"sy0\">,</span> <span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span> <span class=\"nu0\">3</span><span class=\"sy0\">,</span> <span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">2</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span> <span class=\"nu0\">7</span><span class=\"sy0\">,</span> <span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">9</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>    <span class=\"br0\">[</span><span class=\"nu0\">7</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span> <span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">8</span><span class=\"sy0\">,</span> <span class=\"nu0\">9</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span> <span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span> <span class=\"nu0\">2</span><span class=\"sy0\">,</span> <span class=\"nu0\">5</span><span class=\"sy0\">,</span> <span class=\"nu0\">3</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>    <span class=\"br0\">[</span><span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span> <span class=\"nu0\">7</span><span class=\"sy0\">,</span> <span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">5</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span> <span class=\"nu0\">8</span><span class=\"sy0\">,</span> <span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span> <span class=\"nu0\">9</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span> <span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">3</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span> <span class=\"nu0\">2</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>    <span class=\"br0\">[</span><span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span> <span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">7</span><span class=\"sy0\">,</span> <span class=\"nu0\">2</span><span class=\"sy0\">,</span> <span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span> <span class=\"nu0\">3</span><span class=\"sy0\">,</span> <span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">8</span><span class=\"sy0\">,</span> <span class=\"nu0\">5</span><span class=\"sy0\">,</span> <span class=\"nu0\">9</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>    <span class=\"br0\">[</span><span class=\"nu0\">13</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span> <span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">3</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">5</span><span class=\"sy0\">,</span> <span class=\"nu0\">9</span><span class=\"sy0\">,</span> <span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span> <span class=\"nu0\">7</span><span class=\"sy0\">,</span> <span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">8</span><span class=\"sy0\">,</span> <span class=\"nu0\">2</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>    <span class=\"br0\">[</span><span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span> <span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">5</span><span class=\"sy0\">,</span> <span class=\"nu0\">7</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span> <span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">9</span><span class=\"sy0\">,</span> <span class=\"nu0\">2</span><span class=\"sy0\">,</span> <span class=\"nu0\">3</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span> <span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span> <span class=\"nu0\">8</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>\u00a0<br/><span class=\"kw2\">sub</span> infix<span class=\"sy0\">:&lt;</span>rol\u00b3\u00b2<span class=\"sy0\">&gt;</span><span class=\"br0\">(</span>\\y<span class=\"sy0\">,</span> \\n<span class=\"br0\">)</span> <span class=\"br0\">{</span> <span class=\"br0\">(</span>y <span class=\"sy0\">+&lt;</span> n<span class=\"br0\">)</span> <span class=\"sy0\">%</span> <span class=\"nu0\">2</span><span class=\"sy0\">**</span><span class=\"nu0\">32</span> <span class=\"sy0\">+|</span> <span class=\"br0\">(</span>y <span class=\"sy0\">+&gt;</span> <span class=\"br0\">(</span><span class=\"nu0\">32</span> <span class=\"sy0\">-</span> n<span class=\"br0\">)</span><span class=\"br0\">)</span> <span class=\"br0\">}</span><br/>\u00a0<br/><span class=\"kw2\">sub</span> \u0413\u041e\u0421\u0422<span class=\"sy0\">-</span><span class=\"kw3\">round</span><span class=\"br0\">(</span>\\R<span class=\"sy0\">,</span> \\K<span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>    <span class=\"kw1\">my</span> \\a <span class=\"sy0\">=</span> <span class=\"br0\">(</span>R <span class=\"sy0\">+</span> K<span class=\"br0\">)</span> <span class=\"sy0\">%</span> <span class=\"nu0\">2</span><span class=\"sy0\">**</span><span class=\"nu0\">32</span><span class=\"sy0\">;</span><br/>    <span class=\"kw1\">my</span> \\b <span class=\"sy0\">=</span> <span class=\"sy0\">:</span><span class=\"nu0\">16</span><span class=\"br0\">[</span> sbox<span class=\"br0\">[</span><span class=\"re0\">$_</span><span class=\"br0\">]</span><span class=\"br0\">[</span><span class=\"br0\">(</span>a <span class=\"sy0\">+&gt;</span> <span class=\"br0\">(</span><span class=\"nu0\">4</span> <span class=\"sy0\">*</span> <span class=\"re0\">$_</span><span class=\"br0\">)</span><span class=\"br0\">)</span> <span class=\"sy0\">%</span> <span class=\"nu0\">16</span><span class=\"br0\">]</span> <span class=\"kw1\">for</span> <span class=\"nu0\">7</span><span class=\"sy0\">...</span><span class=\"nu0\">0</span> <span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>    b rol\u00b3\u00b2 <span class=\"nu0\">11</span><span class=\"sy0\">;</span><br/><span class=\"br0\">}</span><br/>\u00a0<br/><span class=\"kw2\">sub</span> feistel<span class=\"sy0\">-</span>step<span class=\"br0\">(</span><span class=\"re0\">&amp;F</span><span class=\"sy0\">,</span> \\L<span class=\"sy0\">,</span> \\R<span class=\"sy0\">,</span> \\K<span class=\"br0\">)</span> <span class=\"br0\">{</span> R<span class=\"sy0\">,</span> L <span class=\"sy0\">+^</span> F<span class=\"br0\">(</span>R<span class=\"sy0\">,</span> K<span class=\"br0\">)</span> <span class=\"br0\">}</span><br/>\u00a0<br/><span class=\"kw1\">my</span> <span class=\"re0\">@input</span> <span class=\"sy0\">=</span> 0x21<span class=\"sy0\">,</span> 0x04<span class=\"sy0\">,</span> 0x3B<span class=\"sy0\">,</span> 0x04<span class=\"sy0\">,</span> 0x30<span class=\"sy0\">,</span> 0x04<span class=\"sy0\">,</span> 0x32<span class=\"sy0\">,</span> 0x04<span class=\"sy0\">;</span><br/><span class=\"kw1\">my</span> <span class=\"re0\">@key</span>   <span class=\"sy0\">=</span> 0xF9<span class=\"sy0\">,</span> 0x04<span class=\"sy0\">,</span> 0xC1<span class=\"sy0\">,</span> 0xE2<span class=\"sy0\">;</span><br/>\u00a0<br/><span class=\"kw1\">my</span> <span class=\"br0\">(</span><span class=\"re0\">$L</span><span class=\"sy0\">,</span><span class=\"re0\">$R</span><span class=\"br0\">)</span> <span class=\"sy0\">=</span> <span class=\"re0\">@input</span><span class=\"sy0\">.</span><span class=\"kw3\">reverse</span><span class=\"sy0\">.</span><span class=\"kw3\">map</span><span class=\"sy0\">:</span> <span class=\"br0\">{</span> <span class=\"sy0\">:</span><span class=\"nu0\">256</span><span class=\"br0\">[</span><span class=\"re0\">$^a</span><span class=\"sy0\">,</span><span class=\"re0\">$^b</span><span class=\"sy0\">,</span><span class=\"re0\">$^c</span><span class=\"sy0\">,</span><span class=\"re0\">$^d</span><span class=\"br0\">]</span> <span class=\"br0\">}</span><br/><span class=\"kw1\">my</span> <span class=\"br0\">(</span><span class=\"re0\">$K</span>   <span class=\"br0\">)</span> <span class=\"sy0\">=</span> <span class=\"re0\">@key</span>\\ <span class=\"sy0\">.</span><span class=\"kw3\">reverse</span><span class=\"sy0\">.</span><span class=\"kw3\">map</span><span class=\"sy0\">:</span> <span class=\"br0\">{</span> <span class=\"sy0\">:</span><span class=\"nu0\">256</span><span class=\"br0\">[</span><span class=\"re0\">$^a</span><span class=\"sy0\">,</span><span class=\"re0\">$^b</span><span class=\"sy0\">,</span><span class=\"re0\">$^c</span><span class=\"sy0\">,</span><span class=\"re0\">$^d</span><span class=\"br0\">]</span> <span class=\"br0\">}</span><br/>\u00a0<br/><span class=\"br0\">(</span><span class=\"re0\">$L</span><span class=\"sy0\">,</span><span class=\"re0\">$R</span><span class=\"br0\">)</span> <span class=\"sy0\">=</span> feistel<span class=\"sy0\">-</span>step<span class=\"br0\">(</span><span class=\"sy0\">&amp;</span>\u0413\u041e\u0421\u0422<span class=\"sy0\">-</span><span class=\"kw3\">round</span><span class=\"sy0\">,</span> <span class=\"re0\">$L</span><span class=\"sy0\">,</span> <span class=\"re0\">$R</span><span class=\"sy0\">,</span> <span class=\"re0\">$K</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\u00a0<br/><span class=\"kw3\">say</span> <span class=\"br0\">[</span> <span class=\"br0\">(</span><span class=\"re0\">$L</span> <span class=\"sy0\">+&lt;</span> <span class=\"nu0\">32</span> <span class=\"sy0\">+</span> <span class=\"re0\">$R</span> <span class=\"kw1\">X</span><span class=\"sy0\">+&gt;</span> <span class=\"br0\">(</span><span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">8</span> <span class=\"sy0\">...</span> <span class=\"nu0\">56</span><span class=\"br0\">)</span><span class=\"br0\">)</span> X<span class=\"sy0\">%</span> <span class=\"nu0\">256</span> <span class=\"br0\">]</span><span class=\"sy0\">.</span><span class=\"kw3\">fmt</span><span class=\"br0\">(</span><span class=\"st_h\">'%02X'</span><span class=\"br0\">)</span><span class=\"sy0\">;</span></pre>"}, {"lang": "Phix", "loc": 40, "block": "<pre class=\"text highlighted_source\">constant cbrf = {<br/>      { 4, 10,  9,  2, 13,  8,  0, 14,  6, 11,  1, 12,  7, 15,  5,  3},<br/>      {14, 11,  4, 12,  6, 13, 15, 10,  2,  3,  8,  1,  0,  7,  5,  9},<br/>      { 5,  8,  1, 13, 10,  3,  4,  2, 14, 15, 12,  7,  6,  0,  9, 11},<br/>      { 7, 13, 10,  1,  0,  8,  9, 15, 14,  4,  6, 12, 11,  2,  5,  3},<br/>      { 6, 12,  7,  1,  5, 15, 13,  8,  4, 10,  9, 14,  0,  3, 11,  2},<br/>      { 4, 11, 10,  0,  7,  2,  1, 13,  3,  6,  8,  5,  9, 12, 15, 14},<br/>      {13, 11,  4,  1,  3, 15,  5,  9,  0, 10, 14,  7,  6,  8,  2, 12},<br/>      { 1, 15, 13,  0,  5,  7, 10,  4,  9,  2,  3, 14,  6, 11,  8, 12}}<br/>\u00a0<br/>function generate(integer k)<br/>    sequence res = repeat(0,256)<br/>    for i=1 to length(res) do<br/>        res[i] = or_bits(cbrf[k][floor((i-1)/16)+1]*16,cbrf[k-1][and_bits(i-1,#F)+1])<br/>    end for<br/>    return res<br/>end function<br/>\u00a0<br/>constant k87 = generate(8),<br/>         k65 = generate(6),<br/>         k43 = generate(4),<br/>         k21 = generate(2)<br/>\u00a0<br/>function r32(atom a)<br/>    if a&lt;0 then a+=#100000000 end if<br/>    return remainder(a,#100000000)<br/>end function<br/>\u00a0<br/>function mainstep(sequence input, atom key)<br/>    atom s = r32(input[1]+key)<br/>    s = or_all({k87[and_bits(floor(s/#1000000),#FF)+1]*#1000000,<br/>                k65[and_bits(floor(s/#10000),#FF)+1]*#10000,<br/>                k43[and_bits(floor(s/#100),#FF)+1]*#100,<br/>                k21[and_bits(s,#FF)+1]})<br/>    s = r32(s*power(2,11))+floor(s/power(2,32-11))<br/>    s = xor_bits(s,input[2])<br/>    return {s,input[1]}<br/>end function<br/>\u00a0<br/>printf(1,\"%08x\u00a0%08x\\n\",mainstep({#043B0421, #04320430}, #E2C104F9))</pre>"}, {"lang": "PicoLisp", "loc": 62, "block": "<pre class=\"text highlighted_source\">(setq K1 (13  2  8  4  6 15 11  1 10  9  3 14  5  0 12  7))<br/>(setq K2 ( 4 11  2 14 15  0  8 13  3 12  9  7  5 10  6  1))<br/>(setq K3 (12  1 10 15  9  2  6  8  0 13  3  4 14  7  5 11))<br/>(setq K4 ( 2 12  4  1  7 10 11  6  8  5  3 15 13  0 14  9))<br/>(setq K5 ( 7 13 14  3  0  6  9 10  1  2  8  5 11 12  4 15))<br/>(setq K6 (10  0  9 14  6  3 15  5  1 13 12  7 11  4  2  8))<br/>(setq K7 (15  1  8 14  6 11  3  4  9  7  2 13 12  0  5 10))<br/>(setq K8 (14  4 13  1  2 15 11  8  3 10  6 12  5  9  0  7))<br/>\u00a0<br/>(setq K21<br/>   (mapcar<br/>      '((N)<br/>         (| <br/>            (&gt;&gt; -4 (get K2 (inc (&gt;&gt; 4 N)))) <br/>            (get K1 (inc (&amp; N 15))) ) )<br/>      (range 0 255) ) )<br/>\u00a0<br/>(setq K43<br/>   (mapcar<br/>      '((N)<br/>         (| <br/>            (&gt;&gt; -4 (get K4 (inc (&gt;&gt; 4 N)))) <br/>            (get K3 (inc (&amp; N 15))) ) )<br/>      (range 0 255) ) )<br/>\u00a0<br/>(setq K65<br/>   (mapcar<br/>      '((N)<br/>         (| <br/>            (&gt;&gt; -4 (get K6 (inc (&gt;&gt; 4 N))))<br/>            (get K5 (inc (&amp; N 15))) ) )<br/>      (range 0 255) ) )<br/>\u00a0<br/>(setq K87<br/>   (mapcar<br/>      '((N)<br/>         (| <br/>            (&gt;&gt; -4 (get K8 (inc (&gt;&gt; 4 N))))<br/>            (get K7 (inc (&amp; N 15))) ) )<br/>      (range 0 255) ) )<br/>\u00a0<br/>(de leftRotate (X C)<br/>   (| <br/>      (&amp; `(hex \"FFFFFFFF\") (&gt;&gt; (- C) X))<br/>      (&gt;&gt; (- 32 C) X) ) )<br/>\u00a0<br/>(de f (X)<br/>   (leftRotate<br/>      (apply <br/>         |<br/>         (mapcar<br/>            '((Lst N)<br/>               (&gt;&gt; <br/>                  N<br/>                  (get<br/>                     (val Lst)<br/>                     (inc (&amp; 255 (&gt;&gt; (abs N) X))) ) ) )<br/>            '(K87 K65 K43 K21) <br/>            (-24 -16 -8 0) ) )<br/>      11 ) )<br/>\u00a0<br/>(bye)</pre>"}, {"lang": "Python", "loc": 26, "block": "<pre class=\"python highlighted_source\">\u00a0<br/>k8 <span class=\"sy0\">=</span> <span class=\"br0\">[</span>\t<span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span> <span class=\"br0\">]</span> <br/>k7 <span class=\"sy0\">=</span> <span class=\"br0\">[</span>\t<span class=\"nu0\">15</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span> <span class=\"br0\">]</span><br/>k6 <span class=\"sy0\">=</span> <span class=\"br0\">[</span>\t<span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span> <span class=\"br0\">]</span><br/>k5 <span class=\"sy0\">=</span> <span class=\"br0\">[</span>\t <span class=\"nu0\">7</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span> <span class=\"br0\">]</span><br/>k4 <span class=\"sy0\">=</span> <span class=\"br0\">[</span>\t <span class=\"nu0\">2</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span> <span class=\"br0\">]</span><br/>k3 <span class=\"sy0\">=</span> <span class=\"br0\">[</span>\t<span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span> <span class=\"br0\">]</span><br/>k2 <span class=\"sy0\">=</span> <span class=\"br0\">[</span>\t <span class=\"nu0\">4</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span> <span class=\"nu0\">13</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span> <span class=\"br0\">]</span><br/>k1 <span class=\"sy0\">=</span> <span class=\"br0\">[</span>\t<span class=\"nu0\">13</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2</span><span class=\"sy0\">,</span>  <span class=\"nu0\">8</span><span class=\"sy0\">,</span>  <span class=\"nu0\">4</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">15</span><span class=\"sy0\">,</span> <span class=\"nu0\">11</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">10</span><span class=\"sy0\">,</span>  <span class=\"nu0\">9</span><span class=\"sy0\">,</span>  <span class=\"nu0\">3</span><span class=\"sy0\">,</span> <span class=\"nu0\">14</span><span class=\"sy0\">,</span>  <span class=\"nu0\">5</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">12</span><span class=\"sy0\">,</span>  <span class=\"nu0\">7</span> <span class=\"br0\">]</span><br/>\u00a0<br/>k87 <span class=\"sy0\">=</span> <span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span> * <span class=\"nu0\">256</span><br/>k65 <span class=\"sy0\">=</span> <span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span> * <span class=\"nu0\">256</span><br/>k43 <span class=\"sy0\">=</span> <span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span> * <span class=\"nu0\">256</span><br/>k21 <span class=\"sy0\">=</span> <span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span> * <span class=\"nu0\">256</span><br/>\u00a0<br/><span class=\"kw1\">def</span> kboxinit<span class=\"br0\">(</span><span class=\"br0\">)</span>:<br/>\t<span class=\"kw1\">for</span> i <span class=\"kw1\">in</span> <span class=\"kw2\">range</span><span class=\"br0\">(</span><span class=\"nu0\">256</span><span class=\"br0\">)</span>:<br/>\t\tk87<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> k8<span class=\"br0\">[</span>i <span class=\"sy0\">&gt;&gt;</span> <span class=\"nu0\">4</span><span class=\"br0\">]</span> <span class=\"sy0\">&lt;&lt;</span> <span class=\"nu0\">4</span> | k7<span class=\"br0\">[</span>i &amp; <span class=\"nu0\">15</span><span class=\"br0\">]</span><br/>\t\tk65<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> k6<span class=\"br0\">[</span>i <span class=\"sy0\">&gt;&gt;</span> <span class=\"nu0\">4</span><span class=\"br0\">]</span> <span class=\"sy0\">&lt;&lt;</span> <span class=\"nu0\">4</span> | k5<span class=\"br0\">[</span>i &amp; <span class=\"nu0\">15</span><span class=\"br0\">]</span><br/>\t\tk43<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> k4<span class=\"br0\">[</span>i <span class=\"sy0\">&gt;&gt;</span> <span class=\"nu0\">4</span><span class=\"br0\">]</span> <span class=\"sy0\">&lt;&lt;</span> <span class=\"nu0\">4</span> | k3<span class=\"br0\">[</span>i &amp; <span class=\"nu0\">15</span><span class=\"br0\">]</span><br/>\t\tk21<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> k2<span class=\"br0\">[</span>i <span class=\"sy0\">&gt;&gt;</span> <span class=\"nu0\">4</span><span class=\"br0\">]</span> <span class=\"sy0\">&lt;&lt;</span> <span class=\"nu0\">4</span> | k1<span class=\"br0\">[</span>i &amp; <span class=\"nu0\">15</span><span class=\"br0\">]</span><br/>\u00a0<br/><span class=\"kw1\">def</span> f<span class=\"br0\">(</span>x<span class=\"br0\">)</span>:<br/>\tx <span class=\"sy0\">=</span> <span class=\"br0\">(</span> k87<span class=\"br0\">[</span>x<span class=\"sy0\">&gt;&gt;</span><span class=\"nu0\">24</span> &amp; <span class=\"nu0\">255</span><span class=\"br0\">]</span> <span class=\"sy0\">&lt;&lt;</span> <span class=\"nu0\">24</span> | k65<span class=\"br0\">[</span>x<span class=\"sy0\">&gt;&gt;</span><span class=\"nu0\">16</span> &amp; <span class=\"nu0\">255</span><span class=\"br0\">]</span> <span class=\"sy0\">&lt;&lt;</span> <span class=\"nu0\">16</span> |<br/>\t      k43<span class=\"br0\">[</span>x<span class=\"sy0\">&gt;&gt;</span> <span class=\"nu0\">8</span> &amp; <span class=\"nu0\">255</span><span class=\"br0\">]</span> <span class=\"sy0\">&lt;&lt;</span>  <span class=\"nu0\">8</span> | k21<span class=\"br0\">[</span>x &amp; <span class=\"nu0\">255</span><span class=\"br0\">]</span> <span class=\"br0\">)</span><br/>\t<span class=\"kw1\">return</span> x<span class=\"sy0\">&lt;&lt;</span><span class=\"nu0\">11</span> | x<span class=\"sy0\">&gt;&gt;</span><span class=\"br0\">(</span><span class=\"nu0\">32</span>-<span class=\"nu0\">11</span><span class=\"br0\">)</span></pre>"}, {"lang": "Racket", "loc": 33, "block": "<pre class=\"text highlighted_source\">\u00a0<br/>#lang racket<br/>\u00a0<br/>(define k8 (bytes 14  4 13  1  2 15 11  8  3 10  6 12  5  9  0  7))<br/>(define k7 (bytes 15  1  8 14  6 11  3  4  9  7  2 13 12  0  5 10))<br/>(define k6 (bytes 10  0  9 14  6  3 15  5  1 13 12  7 11  4  2  8))<br/>(define k5 (bytes  7 13 14  3  0  6  9 10  1  2  8  5 11 12  4 15))<br/>(define k4 (bytes  2 12  4  1  7 10 11  6  8  5  3 15 13  0 14  9))<br/>(define k3 (bytes 12  1 10 15  9  2  6  8  0 13  3  4 14  7  5 11))<br/>(define k2 (bytes  4 11  2 14 15  0  8 13  3 12  9  7  5 10  6  1))<br/>(define k1 (bytes 13  2  8  4  6 15 11  1 10  9  3 14  5  0 12  7))<br/>\u00a0<br/>(define (mk-k k2 k1)<br/>  (list-&gt;bytes (for*/list ([i 16] [j 16]) (+ (* (bytes-ref k2 i) 16) (bytes-ref k1 j)))))<br/>\u00a0<br/>(define k87 (mk-k k8 k7))<br/>(define k65 (mk-k k6 k5))<br/>(define k43 (mk-k k4 k3))<br/>(define k21 (mk-k k2 k1))<br/>\u00a0<br/>(define (f x)<br/>  (define bs (integer-&gt;integer-bytes x 4 #f #f))<br/>  (define x*<br/>    (bitwise-and #xFFFFFFFF<br/>                 (integer-bytes-&gt;integer<br/>                  (bytes (bytes-ref k21 (bytes-ref bs 0))<br/>                         (bytes-ref k43 (bytes-ref bs 1))<br/>                         (bytes-ref k65 (bytes-ref bs 2))<br/>                         (bytes-ref k87 (bytes-ref bs 3)))<br/>                  #f #f)))<br/>  (bitwise-ior (bitwise-and #xFFFFFFFF (arithmetic-shift x* 11))<br/>               (arithmetic-shift x* (- 11 32))))<br/>\u00a0</pre>"}, {"lang": "REXX", "loc": 26, "block": "<pre class=\"rexx highlighted_source\"><span class=\"coMULTI\">/*REXX program implements  main step   GOST 28147-89   based on a Feistel network.      */</span><br/><span class=\"kw1\">numeric</span> <span class=\"kw2\">digits</span> <span class=\"nu0\">12</span>                          <span class=\"coMULTI\">/*  \u250c\u2500\u2500 a list of 4\u2500bit S\u2500box values used by */</span><br/>                                           <span class=\"coMULTI\">/*  \u2193 the Central Bank of Russian Federation.*/</span><br/>                @<span class=\"sy0\">.</span>0  =     <span class=\"nu0\">4</span>  <span class=\"nu0\">10</span>   <span class=\"nu0\">9</span>   <span class=\"nu0\">2</span>  <span class=\"nu0\">13</span>   <span class=\"nu0\">8</span>   <span class=\"nu0\">0</span>  <span class=\"nu0\">14</span>   <span class=\"nu0\">6</span>  <span class=\"nu0\">11</span>   <span class=\"nu0\">1</span>  <span class=\"nu0\">12</span>   <span class=\"nu0\">7</span>  <span class=\"nu0\">15</span>   <span class=\"nu0\">5</span>   <span class=\"nu0\">3</span><br/>                @<span class=\"sy0\">.</span>1  =    <span class=\"nu0\">14</span>  <span class=\"nu0\">11</span>   <span class=\"nu0\">4</span>  <span class=\"nu0\">12</span>   <span class=\"nu0\">6</span>  <span class=\"nu0\">13</span>  <span class=\"nu0\">15</span>  <span class=\"nu0\">10</span>   <span class=\"nu0\">2</span>   <span class=\"nu0\">3</span>   <span class=\"nu0\">8</span>   <span class=\"nu0\">1</span>   <span class=\"nu0\">0</span>   <span class=\"nu0\">7</span>   <span class=\"nu0\">5</span>   <span class=\"nu0\">9</span><br/>                @<span class=\"sy0\">.</span>2  =     <span class=\"nu0\">5</span>   <span class=\"nu0\">8</span>   <span class=\"nu0\">1</span>  <span class=\"nu0\">13</span>  <span class=\"nu0\">10</span>   <span class=\"nu0\">3</span>   <span class=\"nu0\">4</span>   <span class=\"nu0\">2</span>  <span class=\"nu0\">14</span>  <span class=\"nu0\">15</span>  <span class=\"nu0\">12</span>   <span class=\"nu0\">7</span>   <span class=\"nu0\">6</span>   <span class=\"nu0\">0</span>   <span class=\"nu0\">9</span>  <span class=\"nu0\">11</span><br/>                @<span class=\"sy0\">.</span>3  =     <span class=\"nu0\">7</span>  <span class=\"nu0\">13</span>  <span class=\"nu0\">10</span>   <span class=\"nu0\">1</span>   <span class=\"nu0\">0</span>   <span class=\"nu0\">8</span>   <span class=\"nu0\">9</span>  <span class=\"nu0\">15</span>  <span class=\"nu0\">14</span>   <span class=\"nu0\">4</span>   <span class=\"nu0\">6</span>  <span class=\"nu0\">12</span>  <span class=\"nu0\">11</span>   <span class=\"nu0\">2</span>   <span class=\"nu0\">5</span>   <span class=\"nu0\">3</span><br/>                @<span class=\"sy0\">.</span>4  =     <span class=\"nu0\">6</span>  <span class=\"nu0\">12</span>   <span class=\"nu0\">7</span>   <span class=\"nu0\">1</span>   <span class=\"nu0\">5</span>  <span class=\"nu0\">15</span>  <span class=\"nu0\">13</span>   <span class=\"nu0\">8</span>   <span class=\"nu0\">4</span>  <span class=\"nu0\">10</span>   <span class=\"nu0\">9</span>  <span class=\"nu0\">14</span>   <span class=\"nu0\">0</span>   <span class=\"nu0\">3</span>  <span class=\"nu0\">11</span>   <span class=\"nu0\">2</span><br/>                @<span class=\"sy0\">.</span>5  =     <span class=\"nu0\">4</span>  <span class=\"nu0\">11</span>  <span class=\"nu0\">10</span>   <span class=\"nu0\">0</span>   <span class=\"nu0\">7</span>   <span class=\"nu0\">2</span>   <span class=\"nu0\">1</span>  <span class=\"nu0\">13</span>   <span class=\"nu0\">3</span>   <span class=\"nu0\">6</span>   <span class=\"nu0\">8</span>   <span class=\"nu0\">5</span>   <span class=\"nu0\">9</span>  <span class=\"nu0\">12</span>  <span class=\"nu0\">15</span>  <span class=\"nu0\">14</span><br/>                @<span class=\"sy0\">.</span>6  =    <span class=\"nu0\">13</span>  <span class=\"nu0\">11</span>   <span class=\"nu0\">4</span>   <span class=\"nu0\">1</span>   <span class=\"nu0\">3</span>  <span class=\"nu0\">15</span>   <span class=\"nu0\">5</span>   <span class=\"nu0\">9</span>   <span class=\"nu0\">0</span>  <span class=\"nu0\">10</span>  <span class=\"nu0\">14</span>   <span class=\"nu0\">7</span>   <span class=\"nu0\">6</span>   <span class=\"nu0\">8</span>   <span class=\"nu0\">2</span>  <span class=\"nu0\">12</span><br/>                @<span class=\"sy0\">.</span>7  =     <span class=\"nu0\">1</span>  <span class=\"nu0\">15</span>  <span class=\"nu0\">13</span>   <span class=\"nu0\">0</span>   <span class=\"nu0\">5</span>   <span class=\"nu0\">7</span>  <span class=\"nu0\">10</span>   <span class=\"nu0\">4</span>   <span class=\"nu0\">9</span>   <span class=\"nu0\">2</span>   <span class=\"nu0\">3</span>  <span class=\"nu0\">14</span>   <span class=\"nu0\">6</span>  <span class=\"nu0\">11</span>   <span class=\"nu0\">8</span>  <span class=\"nu0\">12</span><br/>                                           <span class=\"coMULTI\">/* [\u2193]  build the sub-keys array from above. */</span><br/>         <span class=\"kw1\">do</span> r=<span class=\"nu0\">0</span>  <span class=\"kw2\">for</span> <span class=\"nu0\">8</span>;     <span class=\"kw1\">do</span> c=<span class=\"nu0\">0</span>  <span class=\"kw2\">for</span> <span class=\"nu0\">16</span>;       \u00a0!<span class=\"sy0\">.</span>r<span class=\"sy0\">.</span>c=<span class=\"kw6\">word</span><span class=\"br0\">(</span>@<span class=\"sy0\">.</span>r, c + <span class=\"nu0\">1</span><span class=\"br0\">)</span>;     <span class=\"kw3\">end</span>;    <span class=\"kw3\">end</span><br/>z=<span class=\"nu0\">0</span><br/>#<span class=\"nu0\">1</span>=<span class=\"kw6\">x2d</span><span class=\"br0\">(</span> 43b0421 <span class=\"br0\">)</span>;     #<span class=\"nu0\">2</span>=<span class=\"kw6\">x2d</span><span class=\"br0\">(</span> <span class=\"nu0\">4320430</span> <span class=\"br0\">)</span>;                         k=#<span class=\"nu0\">1</span> + <span class=\"kw6\">x2d</span><span class=\"br0\">(</span> 0e2c104f9 <span class=\"br0\">)</span><br/>                            <span class=\"kw1\">do</span>  <span class=\"kw2\">while</span>  k <span class=\"sy0\">&gt;</span> <span class=\"kw6\">x2d</span><span class=\"br0\">(</span> 7ffFFffF <span class=\"br0\">)</span>;       k=k - <span class=\"nu0\">2</span><span class=\"sy0\">**</span><span class=\"nu0\">32</span>;     <span class=\"kw3\">end</span><br/>                            <span class=\"kw1\">do</span>  <span class=\"kw2\">while</span>  k <span class=\"sy0\">&lt;</span> <span class=\"kw6\">x2d</span><span class=\"br0\">(</span> <span class=\"nu0\">80000000</span> <span class=\"br0\">)</span>;       k=k + <span class=\"nu0\">2</span><span class=\"sy0\">**</span><span class=\"nu0\">32</span>;     <span class=\"kw3\">end</span><br/>\u00a0<br/>  <span class=\"kw1\">do</span> j=<span class=\"nu0\">0</span>  <span class=\"kw2\">for</span> <span class=\"nu0\">4</span>;   jj=j + j;        jjp=jj + <span class=\"nu0\">1</span>   <span class=\"coMULTI\">/*calculate the array'a  \"subscripts\". */</span><br/>  $=<span class=\"kw6\">x2d</span><span class=\"br0\">(</span> <span class=\"kw6\">right</span><span class=\"br0\">(</span> <span class=\"kw6\">d2x</span><span class=\"br0\">(</span> k\u00a0% <span class=\"nu0\">2</span> <span class=\"sy0\">**</span> <span class=\"br0\">(</span>j <span class=\"sy0\">*</span> <span class=\"nu0\">8</span><span class=\"br0\">)</span> <span class=\"br0\">)</span>,  <span class=\"nu0\">2</span><span class=\"br0\">)</span> <span class=\"br0\">)</span><br/>              cm=$ <span class=\"sy0\">//</span> <span class=\"nu0\">16</span>;       cd=$\u00a0% <span class=\"nu0\">16</span>        <span class=\"coMULTI\">/*perform modulus and integer division.*/</span><br/>  z=z + <span class=\"br0\">(</span>!<span class=\"sy0\">.</span>jj<span class=\"sy0\">.</span>cm  +  <span class=\"nu0\">16</span> <span class=\"sy0\">*</span>\u00a0!<span class=\"sy0\">.</span>jjp<span class=\"sy0\">.</span>cd<span class=\"br0\">)</span>  <span class=\"sy0\">*</span>  <span class=\"nu0\">2</span><span class=\"sy0\">**</span><span class=\"br0\">(</span>j<span class=\"sy0\">*</span><span class=\"nu0\">8</span><span class=\"br0\">)</span><br/>  <span class=\"kw3\">end</span>   <span class=\"coMULTI\">/*i*/</span>                                    <span class=\"coMULTI\">/* [\u2191]  encryption algorithm for S-box.*/</span><br/>                                                 <span class=\"coMULTI\">/* [\u2193]  encryption algorithm round.    */</span><br/>k = <span class=\"kw6\">c2d</span><span class=\"br0\">(</span> <span class=\"kw6\">bitxor</span><span class=\"br0\">(</span> <span class=\"kw6\">bitor</span><span class=\"br0\">(</span> <span class=\"kw6\">d2c</span><span class=\"br0\">(</span>z <span class=\"sy0\">*</span> <span class=\"nu0\">2</span><span class=\"sy0\">**</span><span class=\"nu0\">11</span>,  <span class=\"nu0\">4</span><span class=\"br0\">)</span>,    <span class=\"kw6\">d2c</span><span class=\"br0\">(</span>z\u00a0% <span class=\"nu0\">2</span><span class=\"sy0\">**</span><span class=\"nu0\">21</span>,  <span class=\"nu0\">4</span><span class=\"br0\">)</span> <span class=\"br0\">)</span>,     <span class=\"kw6\">d2c</span><span class=\"br0\">(</span>#<span class=\"nu0\">2</span>, <span class=\"nu0\">4</span><span class=\"br0\">)</span> <span class=\"br0\">)</span> <span class=\"br0\">)</span><br/><span class=\"kw1\">say</span>  <span class=\"kw6\">center</span><span class=\"br0\">(</span><span class=\"kw6\">d2x</span><span class=\"br0\">(</span>k<span class=\"br0\">)</span>     <span class=\"st0\">' '</span>    <span class=\"kw6\">d2x</span><span class=\"br0\">(</span>#<span class=\"nu0\">1</span><span class=\"br0\">)</span>, <span class=\"nu0\">79</span><span class=\"br0\">)</span>       <span class=\"coMULTI\">/*stick a fork in it,  we're all done. */</span></pre>"}, {"lang": "Tcl", "loc": 22, "block": "<pre class=\"tcl highlighted_source\"><span class=\"kw1\">namespace</span> <span class=\"kw1\">eval</span>\u00a0::<span class=\"me1\">GOST</span> <span class=\"br0\">{</span><br/>    <span class=\"kw1\">proc</span> tcl::<span class=\"me1\">mathfunc</span>::<span class=\"me1\">k</span> <span class=\"br0\">{</span>a b<span class=\"br0\">}</span> <span class=\"br0\">{</span><br/>\t<span class=\"kw1\">variable</span>\u00a0::<span class=\"me1\">GOST</span>::<span class=\"me1\">replacementTable</span><br/>\t<span class=\"kw2\">lindex</span> <span class=\"re0\">$replacementTable</span> <span class=\"re0\">$a</span> <span class=\"re0\">$b</span><br/>    <span class=\"br0\">}</span><br/>\u00a0<br/>    <span class=\"kw1\">proc</span> mainStep <span class=\"br0\">{</span>textBlock idx key<span class=\"br0\">}</span> <span class=\"br0\">{</span><br/>\t<span class=\"kw1\">variable</span> replacementTable<br/>\tlassign <span class=\"br0\">[</span><span class=\"kw2\">lindex</span> <span class=\"re0\">$textBlock</span> <span class=\"re0\">$idx</span><span class=\"br0\">]</span> N0 N1<br/>\t<span class=\"kw1\">set</span> S <span class=\"br0\">[</span><span class=\"kw1\">expr</span> <span class=\"br0\">{</span><span class=\"br0\">(</span><span class=\"re0\">$N0</span> + <span class=\"re0\">$key</span><span class=\"br0\">)</span> <span class=\"sy0\">&amp;</span> 0xFFFFFFFF<span class=\"br0\">}</span><span class=\"br0\">]</span><br/>\t<span class=\"kw1\">set</span> newS <span class=\"nu0\">0</span><br/>\t<span class=\"kw1\">for</span> <span class=\"br0\">{</span><span class=\"kw1\">set</span> i <span class=\"nu0\">0</span><span class=\"br0\">}</span> <span class=\"br0\">{</span><span class=\"re0\">$i</span> <span class=\"sy0\">&lt;</span> <span class=\"nu0\">4</span><span class=\"br0\">}</span> <span class=\"br0\">{</span><span class=\"kw2\">incr</span> i<span class=\"br0\">}</span> <span class=\"br0\">{</span><br/>\t    <span class=\"kw1\">set</span> cell <span class=\"br0\">[</span><span class=\"kw1\">expr</span> <span class=\"br0\">{</span><span class=\"re0\">$S</span> <span class=\"sy0\">&gt;&gt;</span> <span class=\"br0\">(</span><span class=\"re0\">$i</span> <span class=\"sy0\">*</span> <span class=\"nu0\">8</span><span class=\"br0\">)</span> <span class=\"sy0\">&amp;</span> 0xFF<span class=\"br0\">}</span><span class=\"br0\">]</span><br/>\t    <span class=\"kw2\">incr</span> newS <span class=\"br0\">[</span><span class=\"kw1\">expr</span> <span class=\"br0\">{</span><br/>\t\t<span class=\"br0\">(</span>k<span class=\"br0\">(</span><span class=\"re0\">$i</span><span class=\"sy0\">*</span><span class=\"nu0\">2</span>, <span class=\"re0\">$cell</span><span class=\"sy0\">%</span>15<span class=\"br0\">)</span> + k<span class=\"br0\">(</span><span class=\"re0\">$i</span><span class=\"sy0\">*</span><span class=\"nu0\">2</span>+<span class=\"nu0\">1</span>, <span class=\"re0\">$cell</span>/<span class=\"nu0\">16</span><span class=\"br0\">)</span> <span class=\"sy0\">*</span> <span class=\"nu0\">16</span><span class=\"br0\">)</span> <span class=\"sy0\">&lt;&lt;</span> <span class=\"br0\">(</span><span class=\"re0\">$i</span> <span class=\"sy0\">*</span> <span class=\"nu0\">8</span><span class=\"br0\">)</span><br/>\t    <span class=\"br0\">}</span><span class=\"br0\">]</span><br/>\t<span class=\"br0\">}</span><br/>\t<span class=\"kw1\">set</span> S <span class=\"br0\">[</span><span class=\"kw1\">expr</span> <span class=\"br0\">{</span><span class=\"br0\">(</span><span class=\"br0\">(</span><span class=\"br0\">(</span><span class=\"re0\">$newS</span> <span class=\"sy0\">&lt;&lt;</span> <span class=\"nu0\">11</span><span class=\"br0\">)</span> + <span class=\"br0\">(</span><span class=\"re0\">$newS</span> <span class=\"sy0\">&gt;&gt;</span> <span class=\"nu0\">21</span><span class=\"br0\">)</span><span class=\"br0\">)</span> <span class=\"sy0\">&amp;</span> 0xFFFFFFFF<span class=\"br0\">)</span> ^ <span class=\"re0\">$N1</span><span class=\"br0\">}</span><span class=\"br0\">]</span><br/>\t<span class=\"kw2\">lset</span> textBlock <span class=\"re0\">$idx</span> <span class=\"br0\">[</span><span class=\"kw2\">list</span> <span class=\"re0\">$S</span> <span class=\"re0\">$N0</span><span class=\"br0\">]</span><br/>\t<span class=\"kw1\">return</span> <span class=\"re0\">$textBlock</span><br/>    <span class=\"br0\">}</span><br/><span class=\"br0\">}</span></pre>"}, {"lang": "X86 Assembly", "loc": 29, "block": "<pre class=\"asm highlighted_source\">        <span class=\"nu0\">.386</span><br/>        <span class=\"sy1\">.</span>model  <span class=\"kw5\">flat</span><br/>        <span class=\"sy1\">.</span><span class=\"kw5\">code</span><br/>_gost32 proc    near32<br/>        <span class=\"kw5\">public</span>  _gost32<br/><span class=\"co1\">; The inner loop of a subroutine</span><br/><span class=\"co1\">; 1. Beginning of the cycle, and preservation of the old N1</span><br/>iloop<span class=\"sy1\">:</span>  <span class=\"kw1\">mov</span>     <span class=\"kw4\">EBP</span><span class=\"sy1\">,</span><span class=\"kw4\">EAX</span><br/><span class=\"co1\">; 2. Adding to the S key modulo 2^32</span><br/>        <span class=\"kw1\">add</span>     <span class=\"kw4\">EAX</span><span class=\"sy1\">,</span><span class=\"br0\">[</span><span class=\"kw4\">ESI</span><span class=\"br0\">]</span> <span class=\"co1\">; add the key</span><br/>        <span class=\"kw1\">add</span>     <span class=\"kw4\">ESI</span><span class=\"sy1\">,</span><span class=\"nu0\">4</span>   <span class=\"co1\">; the next element of the key.</span><br/><span class=\"co1\">; 3. Block-replace in the rotation of S by 8 bits to the left</span><br/>REPT    <span class=\"nu0\">3</span><br/>        xlat            <span class=\"co1\">; recoding byte</span><br/>        <span class=\"kw1\">ror</span>     <span class=\"kw4\">EAX</span><span class=\"sy1\">,</span><span class=\"nu0\">8</span>   <span class=\"co1\">; AL &lt;- next byte</span><br/>        <span class=\"kw1\">add</span>     <span class=\"kw4\">EBX</span><span class=\"sy1\">,</span><span class=\"nu0\">100h</span><span class=\"co1\">; next node changes</span><br/>ENDM<br/>        xlat            <span class=\"co1\">; recoding byte</span><br/>        <span class=\"kw1\">sub</span>     <span class=\"kw4\">EBX</span><span class=\"sy1\">,</span><span class=\"nu0\">300h</span><span class=\"co1\">; BX -&gt; 1st node changes</span><br/><span class=\"co1\">; 4. Complete rotation of the S at 3 bits to the left</span><br/>        <span class=\"kw1\">rol</span>     <span class=\"kw4\">EAX</span><span class=\"sy1\">,</span><span class=\"nu0\">3</span><br/><span class=\"co1\">; 5. The calculation of the new values of N1,N2</span><br/>        <span class=\"kw1\">xor</span>     <span class=\"kw4\">EAX</span><span class=\"sy1\">,</span><span class=\"kw4\">EDX</span><br/>        <span class=\"kw1\">mov</span>     <span class=\"kw4\">EDX</span><span class=\"sy1\">,</span><span class=\"kw4\">EBP</span><br/><span class=\"co1\">; The completion of the inner loop</span><br/>        <span class=\"kw1\">loop</span>    iloop<br/>        <span class=\"kw1\">ret</span><br/>_gost32 endp<br/>        end</pre>"}, {"lang": "zkl", "loc": 31, "block": "<pre class=\"text highlighted_source\">class GOST{<br/>var [const] // Central Bank of Russian Federation S-Boxes<br/>  k8=Data(0,Int, 4, 10,  9,  2, 13,  8,  0, 14,  6, 11,  1, 12,  7, 15,  5,  3),<br/>  k7=Data(0,Int,14, 11,  4, 12,  6, 13, 15, 10,  2,  3,  8,  1,  0,  7,  5,  9),<br/>  k6=Data(0,Int, 5,  8,  1, 13, 10,  3,  4,  2, 14, 15, 12,  7,  6,  0,  9, 11),<br/>  k5=Data(0,Int, 7, 13, 10,  1,  0,  8,  9, 15, 14,  4,  6, 12, 11,  2,  5,  3),<br/>  k4=Data(0,Int, 6, 12,  7,  1,  5, 15, 13,  8,  4, 10,  9, 14,  0,  3, 11,  2),<br/>  k3=Data(0,Int, 4, 11, 10,  0,  7,  2,  1, 13,  3,  6,  8,  5,  9, 12, 15, 14),<br/>  k2=Data(0,Int,13, 11,  4,  1,  3, 15,  5,  9,  0, 10, 14,  7,  6,  8,  2, 12),<br/>  k1=Data(0,Int, 1, 15, 13,  0,  5,  7, 10,  4,  9,  2,  3, 14,  6, 11,  8, 12);<br/>\u00a0<br/>fcn generate(ka,kb)<br/>   { (0).pump(256,Data,'wrap(i){ kb[i/0x10]*0x10 + ka[i%0x10] }) }<br/>var [const] k87=generate(k8,k7), k65=generate(k6,k5),<br/>\t    k43=generate(k4,k3), k21=generate(k2,k1);<br/>\u00a0<br/>fcn f(x){ // int --&gt; int<br/>   x3,x2,x1,x0:=x.toLittleEndian(4);<br/>   x=k87[x3] + k65[x2]*0x|100 + k43[x1]*0x1|0000 + k21[x0]*0x100|0000;<br/>   x.shiftLeft(11) + x.shiftRight(21); // roll left 11 bits, leaving bits on top<br/>}<br/>\u00a0<br/>fcn mainStep(input,key){ // input is stream of bytes, little endian 32 bit words<br/>   r:=Data();<br/>   foreach idx in ([0..input.len()-1,8]){<br/>      w0:=input.toLittleEndian(idx,  4);<br/>      w1:=input.toLittleEndian(idx+4,4);<br/>      r.write(f(key+w0).bitXor(w1).toLittleEndian(4),w0.toLittleEndian(4));<br/>   }<br/>   r<br/>}}</pre>"}]}