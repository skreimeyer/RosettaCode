{"task": "Gaussian_elimination", "blocks": [{"lang": "ALGOL 68", "loc": 26, "block": "<pre class=\"algol68 highlighted_source\"><span class=\"coMULTI\"># -*- coding: utf-8 -*- #</span><br/>COMMENT PROVIDES<br/>  <span class=\"kw4\">MODE</span> FIXED<span class=\"sy1\">;</span> <span class=\"kw3\">INT</span> <span class=\"kw22\">fixed</span> exception<span class=\"sy1\">,</span> unfixed exception<span class=\"sy1\">;</span><br/>  <span class=\"kw4\">PROC</span> <span class=\"br0\">(</span><span class=\"kw3\">STRING</span> message<span class=\"br0\">)</span> FIXED raise<span class=\"sy1\">,</span> raise value error<br/><span class=\"kw2\">END</span> COMMENT<br/>\u00a0<br/><span class=\"coMULTI\"># Note: \u2135 indicates attribute is \"private\", and <br/>        should not be used outside of this prelude #</span><br/>\u00a0<br/><span class=\"kw4\">MODE</span> FIXED <span class=\"sy1\">=</span> <span class=\"kw3\">BOOL</span><span class=\"sy1\">;</span> <span class=\"coMULTI\"># if an exception is detected, can it be fixed \"on-site\"? #</span><br/>FIXED <span class=\"kw22\">fixed</span> exception <span class=\"sy1\">=</span> <span class=\"kw7\">TRUE</span><span class=\"sy1\">,</span> unfixed exception <span class=\"sy1\">=</span> <span class=\"kw7\">FALSE</span><span class=\"sy1\">;</span><br/>\u00a0<br/><span class=\"kw4\">MODE</span> <span class=\"coMULTI\">#\u2135#</span>SIMPLEOUTV <span class=\"sy1\">=</span> <span class=\"br0\">[</span>0<span class=\"br0\">]</span><span class=\"kw6\">UNION</span><span class=\"br0\">(</span><span class=\"kw3\">CHAR</span><span class=\"sy1\">,</span> <span class=\"kw3\">STRING</span><span class=\"sy1\">,</span> <span class=\"kw3\">INT</span><span class=\"sy1\">,</span> <span class=\"kw3\">REAL</span><span class=\"sy1\">,</span> <span class=\"kw3\">BOOL</span><span class=\"sy1\">,</span> <span class=\"kw3\">BITS</span><span class=\"br0\">)</span><span class=\"sy1\">;</span><br/><span class=\"kw4\">MODE</span> <span class=\"coMULTI\">#\u2135#</span>SIMPLEOUTM <span class=\"sy1\">=</span> <span class=\"br0\">[</span>0<span class=\"br0\">]</span><span class=\"coMULTI\">#\u2135#</span>SIMPLEOUTV<span class=\"sy1\">;</span><br/><span class=\"kw4\">MODE</span> <span class=\"coMULTI\">#\u2135#</span>SIMPLEOUTT <span class=\"sy1\">=</span> <span class=\"br0\">[</span>0<span class=\"br0\">]</span><span class=\"coMULTI\">#\u2135#</span>SIMPLEOUTM<span class=\"sy1\">;</span><br/><span class=\"kw4\">MODE</span> SIMPLEOUT  <span class=\"sy1\">=</span> <span class=\"br0\">[</span>0<span class=\"br0\">]</span><span class=\"coMULTI\">#\u2135#</span>SIMPLEOUTT<span class=\"sy1\">;</span><br/>\u00a0<br/><span class=\"kw4\">PROC</span> raise <span class=\"sy1\">=</span> <span class=\"br0\">(</span><span class=\"coMULTI\">#\u2135#</span>SIMPLEOUT message<span class=\"br0\">)</span>FIXED<span class=\"sy1\">:</span> <span class=\"br0\">(</span><br/>  <span class=\"kw22\">putf</span><span class=\"br0\">(</span>stand error<span class=\"sy1\">,</span> <span class=\"br0\">(</span>$<span class=\"st0\">\"Exception:\"</span>$<span class=\"sy1\">,</span> $xg$<span class=\"sy1\">,</span> message<span class=\"sy1\">,</span> $l$<span class=\"br0\">)</span><span class=\"br0\">)</span><span class=\"sy1\">;</span><br/>  stop<br/><span class=\"br0\">)</span><span class=\"sy1\">;</span><br/>\u00a0<br/><span class=\"kw4\">PROC</span> raise value error <span class=\"sy1\">=</span> <span class=\"br0\">(</span><span class=\"coMULTI\">#\u2135#</span>SIMPLEOUT message<span class=\"br0\">)</span>FIXED<span class=\"sy1\">:</span><br/>  <span class=\"kw2\">IF</span> raise<span class=\"br0\">(</span>message<span class=\"br0\">)</span> <span class=\"kw15\">NE</span> <span class=\"kw22\">fixed</span> exception <span class=\"kw2\">THEN</span> exception value error<span class=\"sy1\">;</span> <span class=\"kw7\">FALSE</span> <span class=\"kw2\">FI</span><span class=\"sy1\">;</span><br/>\u00a0<br/><span class=\"kw7\">SKIP</span></pre>"}, {"lang": "C", "loc": 73, "block": "<pre class=\"c highlighted_source\"><span class=\"co2\">#include &lt;stdio.h&gt;</span><br/><span class=\"co2\">#include &lt;stdlib.h&gt;</span><br/><span class=\"co2\">#include &lt;math.h&gt;</span><br/>\u00a0<br/><span class=\"co2\">#define mat_elem(a, y, x, n) (a + ((y) * (n) + (x)))</span><br/>\u00a0<br/><span class=\"kw4\">void</span> swap_row<span class=\"br0\">(</span><span class=\"kw4\">double</span> <span class=\"sy0\">*</span>a<span class=\"sy0\">,</span> <span class=\"kw4\">double</span> <span class=\"sy0\">*</span>b<span class=\"sy0\">,</span> <span class=\"kw4\">int</span> r1<span class=\"sy0\">,</span> <span class=\"kw4\">int</span> r2<span class=\"sy0\">,</span> <span class=\"kw4\">int</span> n<span class=\"br0\">)</span><br/><span class=\"br0\">{</span><br/>\t<span class=\"kw4\">double</span> tmp<span class=\"sy0\">,</span> <span class=\"sy0\">*</span>p1<span class=\"sy0\">,</span> <span class=\"sy0\">*</span>p2<span class=\"sy0\">;</span><br/>\t<span class=\"kw4\">int</span> i<span class=\"sy0\">;</span><br/>\u00a0<br/>\t<span class=\"kw1\">if</span> <span class=\"br0\">(</span>r1 <span class=\"sy0\">==</span> r2<span class=\"br0\">)</span> <span class=\"kw1\">return</span><span class=\"sy0\">;</span><br/>\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span>i <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span> i <span class=\"sy0\">&lt;</span> n<span class=\"sy0\">;</span> i<span class=\"sy0\">++</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>\t\tp1 <span class=\"sy0\">=</span> mat_elem<span class=\"br0\">(</span>a<span class=\"sy0\">,</span> r1<span class=\"sy0\">,</span> i<span class=\"sy0\">,</span> n<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\t\tp2 <span class=\"sy0\">=</span> mat_elem<span class=\"br0\">(</span>a<span class=\"sy0\">,</span> r2<span class=\"sy0\">,</span> i<span class=\"sy0\">,</span> n<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\t\ttmp <span class=\"sy0\">=</span> <span class=\"sy0\">*</span>p1<span class=\"sy0\">,</span> <span class=\"sy0\">*</span>p1 <span class=\"sy0\">=</span> <span class=\"sy0\">*</span>p2<span class=\"sy0\">,</span> <span class=\"sy0\">*</span>p2 <span class=\"sy0\">=</span> tmp<span class=\"sy0\">;</span><br/>\t<span class=\"br0\">}</span><br/>\ttmp <span class=\"sy0\">=</span> b<span class=\"br0\">[</span>r1<span class=\"br0\">]</span><span class=\"sy0\">,</span> b<span class=\"br0\">[</span>r1<span class=\"br0\">]</span> <span class=\"sy0\">=</span> b<span class=\"br0\">[</span>r2<span class=\"br0\">]</span><span class=\"sy0\">,</span> b<span class=\"br0\">[</span>r2<span class=\"br0\">]</span> <span class=\"sy0\">=</span> tmp<span class=\"sy0\">;</span><br/><span class=\"br0\">}</span><br/>\u00a0<br/><span class=\"kw4\">void</span> gauss_eliminate<span class=\"br0\">(</span><span class=\"kw4\">double</span> <span class=\"sy0\">*</span>a<span class=\"sy0\">,</span> <span class=\"kw4\">double</span> <span class=\"sy0\">*</span>b<span class=\"sy0\">,</span> <span class=\"kw4\">double</span> <span class=\"sy0\">*</span>x<span class=\"sy0\">,</span> <span class=\"kw4\">int</span> n<span class=\"br0\">)</span><br/><span class=\"br0\">{</span><br/><span class=\"co2\">#define A(y, x) (*mat_elem(a, y, x, n))</span><br/>\t<span class=\"kw4\">int</span> i<span class=\"sy0\">,</span> j<span class=\"sy0\">,</span> col<span class=\"sy0\">,</span> row<span class=\"sy0\">,</span> max_row<span class=\"sy0\">,</span>dia<span class=\"sy0\">;</span><br/>\t<span class=\"kw4\">double</span> max<span class=\"sy0\">,</span> tmp<span class=\"sy0\">;</span><br/>\u00a0<br/>\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span>dia <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span> dia <span class=\"sy0\">&lt;</span> n<span class=\"sy0\">;</span> dia<span class=\"sy0\">++</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>\t\tmax_row <span class=\"sy0\">=</span> dia<span class=\"sy0\">,</span> max <span class=\"sy0\">=</span> A<span class=\"br0\">(</span>dia<span class=\"sy0\">,</span> dia<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\u00a0<br/>\t\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span>row <span class=\"sy0\">=</span> dia <span class=\"sy0\">+</span> <span class=\"nu0\">1</span><span class=\"sy0\">;</span> row <span class=\"sy0\">&lt;</span> n<span class=\"sy0\">;</span> row<span class=\"sy0\">++</span><span class=\"br0\">)</span><br/>\t\t\t<span class=\"kw1\">if</span> <span class=\"br0\">(</span><span class=\"br0\">(</span>tmp <span class=\"sy0\">=</span> <a href=\"http://www.opengroup.org/onlinepubs/009695399/functions/fabs.html\"><span class=\"kw3\">fabs</span></a><span class=\"br0\">(</span>A<span class=\"br0\">(</span>row<span class=\"sy0\">,</span> dia<span class=\"br0\">)</span><span class=\"br0\">)</span><span class=\"br0\">)</span> <span class=\"sy0\">&gt;</span> max<span class=\"br0\">)</span><br/>\t\t\t\tmax_row <span class=\"sy0\">=</span> row<span class=\"sy0\">,</span> max <span class=\"sy0\">=</span> tmp<span class=\"sy0\">;</span><br/>\u00a0<br/>\t\tswap_row<span class=\"br0\">(</span>a<span class=\"sy0\">,</span> b<span class=\"sy0\">,</span> dia<span class=\"sy0\">,</span> max_row<span class=\"sy0\">,</span> n<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\u00a0<br/>\t\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span>row <span class=\"sy0\">=</span> dia <span class=\"sy0\">+</span> <span class=\"nu0\">1</span><span class=\"sy0\">;</span> row <span class=\"sy0\">&lt;</span> n<span class=\"sy0\">;</span> row<span class=\"sy0\">++</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>\t\t\ttmp <span class=\"sy0\">=</span> A<span class=\"br0\">(</span>row<span class=\"sy0\">,</span> dia<span class=\"br0\">)</span> <span class=\"sy0\">/</span> A<span class=\"br0\">(</span>dia<span class=\"sy0\">,</span> dia<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\t\t\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span>col <span class=\"sy0\">=</span> dia<span class=\"sy0\">+</span><span class=\"nu0\">1</span><span class=\"sy0\">;</span> col <span class=\"sy0\">&lt;</span> n<span class=\"sy0\">;</span> col<span class=\"sy0\">++</span><span class=\"br0\">)</span><br/>\t\t\t\tA<span class=\"br0\">(</span>row<span class=\"sy0\">,</span> col<span class=\"br0\">)</span> <span class=\"sy0\">-=</span> tmp <span class=\"sy0\">*</span> A<span class=\"br0\">(</span>dia<span class=\"sy0\">,</span> col<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\t\t\tA<span class=\"br0\">(</span>row<span class=\"sy0\">,</span> dia<span class=\"br0\">)</span> <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span><br/>\t\t\tb<span class=\"br0\">[</span>row<span class=\"br0\">]</span> <span class=\"sy0\">-=</span> tmp <span class=\"sy0\">*</span> b<span class=\"br0\">[</span>dia<span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>\t\t<span class=\"br0\">}</span><br/>\t<span class=\"br0\">}</span><br/>\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span>row <span class=\"sy0\">=</span> n <span class=\"sy0\">-</span> <span class=\"nu0\">1</span><span class=\"sy0\">;</span> row <span class=\"sy0\">&gt;=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span> row<span class=\"sy0\">--</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>\t\ttmp <span class=\"sy0\">=</span> b<span class=\"br0\">[</span>row<span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>\t\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span>j <span class=\"sy0\">=</span> n <span class=\"sy0\">-</span> <span class=\"nu0\">1</span><span class=\"sy0\">;</span> j <span class=\"sy0\">&gt;</span> row<span class=\"sy0\">;</span> j<span class=\"sy0\">--</span><span class=\"br0\">)</span><br/>\t\t\ttmp <span class=\"sy0\">-=</span> x<span class=\"br0\">[</span>j<span class=\"br0\">]</span> <span class=\"sy0\">*</span> A<span class=\"br0\">(</span>row<span class=\"sy0\">,</span> j<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\t\tx<span class=\"br0\">[</span>row<span class=\"br0\">]</span> <span class=\"sy0\">=</span> tmp <span class=\"sy0\">/</span> A<span class=\"br0\">(</span>row<span class=\"sy0\">,</span> row<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\t<span class=\"br0\">}</span><br/><span class=\"co2\">#undef A</span><br/><span class=\"br0\">}</span><br/>\u00a0<br/><span class=\"kw4\">int</span> main<span class=\"br0\">(</span><span class=\"kw4\">void</span><span class=\"br0\">)</span><br/><span class=\"br0\">{</span><br/>\t<span class=\"kw4\">double</span> a<span class=\"br0\">[</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"br0\">{</span><br/>\t\t<span class=\"nu16\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu16\">0.00</span><span class=\"sy0\">,</span> <span class=\"nu16\">0.00</span><span class=\"sy0\">,</span>  <span class=\"nu16\">0.00</span><span class=\"sy0\">,</span>  <span class=\"nu16\">0.00</span><span class=\"sy0\">,</span> <span class=\"nu16\">0.00</span><span class=\"sy0\">,</span><br/>\t\t<span class=\"nu16\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu16\">0.63</span><span class=\"sy0\">,</span> <span class=\"nu16\">0.39</span><span class=\"sy0\">,</span>  <span class=\"nu16\">0.25</span><span class=\"sy0\">,</span>  <span class=\"nu16\">0.16</span><span class=\"sy0\">,</span> <span class=\"nu16\">0.10</span><span class=\"sy0\">,</span><br/>\t\t<span class=\"nu16\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu16\">1.26</span><span class=\"sy0\">,</span> <span class=\"nu16\">1.58</span><span class=\"sy0\">,</span>  <span class=\"nu16\">1.98</span><span class=\"sy0\">,</span>  <span class=\"nu16\">2.49</span><span class=\"sy0\">,</span> <span class=\"nu16\">3.13</span><span class=\"sy0\">,</span><br/>\t\t<span class=\"nu16\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu16\">1.88</span><span class=\"sy0\">,</span> <span class=\"nu16\">3.55</span><span class=\"sy0\">,</span>  <span class=\"nu16\">6.70</span><span class=\"sy0\">,</span> <span class=\"nu16\">12.62</span><span class=\"sy0\">,</span> <span class=\"nu16\">23.80</span><span class=\"sy0\">,</span><br/>\t\t<span class=\"nu16\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu16\">2.51</span><span class=\"sy0\">,</span> <span class=\"nu16\">6.32</span><span class=\"sy0\">,</span> <span class=\"nu16\">15.88</span><span class=\"sy0\">,</span> <span class=\"nu16\">39.90</span><span class=\"sy0\">,</span> <span class=\"nu16\">100.28</span><span class=\"sy0\">,</span><br/>\t\t<span class=\"nu16\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu16\">3.14</span><span class=\"sy0\">,</span> <span class=\"nu16\">9.87</span><span class=\"sy0\">,</span> <span class=\"nu16\">31.01</span><span class=\"sy0\">,</span> <span class=\"nu16\">97.41</span><span class=\"sy0\">,</span> <span class=\"nu16\">306.02</span><br/>\t<span class=\"br0\">}</span><span class=\"sy0\">;</span><br/>\t<span class=\"kw4\">double</span> b<span class=\"br0\">[</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"br0\">{</span> <span class=\"sy0\">-</span><span class=\"nu16\">0.01</span><span class=\"sy0\">,</span> <span class=\"nu16\">0.61</span><span class=\"sy0\">,</span> <span class=\"nu16\">0.91</span><span class=\"sy0\">,</span> <span class=\"nu16\">0.99</span><span class=\"sy0\">,</span> <span class=\"nu16\">0.60</span><span class=\"sy0\">,</span> <span class=\"nu16\">0.02</span> <span class=\"br0\">}</span><span class=\"sy0\">;</span><br/>\t<span class=\"kw4\">double</span> x<span class=\"br0\">[</span><span class=\"nu0\">6</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>\t<span class=\"kw4\">int</span> i<span class=\"sy0\">;</span><br/>\u00a0<br/>\tgauss_eliminate<span class=\"br0\">(</span>a<span class=\"sy0\">,</span> b<span class=\"sy0\">,</span> x<span class=\"sy0\">,</span> <span class=\"nu0\">6</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\u00a0<br/>\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span>i <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span> i <span class=\"sy0\">&lt;</span> <span class=\"nu0\">6</span><span class=\"sy0\">;</span> i<span class=\"sy0\">++</span><span class=\"br0\">)</span><br/>\t\t<a href=\"http://www.opengroup.org/onlinepubs/009695399/functions/printf.html\"><span class=\"kw3\">printf</span></a><span class=\"br0\">(</span><span class=\"st0\">\"%g<span class=\"es1\">\\n</span>\"</span><span class=\"sy0\">,</span> x<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\u00a0<br/>\t<span class=\"kw1\">return</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span><br/><span class=\"br0\">}</span></pre>"}, {"lang": "Common Lisp", "loc": 19, "block": "<pre class=\"text highlighted_source\">\u00a0<br/>(defmacro mapcar-1 (fn n list)<br/> \"Maps a function of two parameters where the first one is fixed, over a list\"<br/>  `(mapcar #'(lambda (l) (funcall ,fn ,n l)) ,list) )<br/>\u00a0<br/>\u00a0<br/>(defun gauss (m)<br/>  (labels <br/>    ((redc (m)\u00a0; Reduce to triangular form<br/>       (if (null (cdr m))<br/>         m<br/>        (cons (car m) (mapcar-1 #'cons 0 (redc (mapcar #'cdr (mapcar #'(lambda (r) (mapcar #'- (mapcar-1 #'* (caar m) r) <br/>                                                                                            (mapcar-1 #'* (car r) (car m)))) (cdr m)))))) ))<br/>     (rev (m)\u00a0; Reverse each row except the last element<br/>       (reverse (mapcar #'(lambda (r) (append (reverse (butlast r)) (last r))) m)) ))<br/>    (catch 'result<br/>      (let ((m1 (redc (rev (redc m)))))<br/>        (reverse (mapcar #'(lambda (r) (let ((pivot (find-if-not #'zerop r))) (if pivot (/ (car (last r)) pivot) (throw 'result 'singular)))) m1)) ))))<br/>\u00a0</pre>"}, {"lang": "C#", "loc": 176, "block": "<pre class=\"csharp highlighted_source\">\u00a0<br/><span class=\"kw1\">using</span> <span class=\"co3\">System</span><span class=\"sy0\">;</span><br/>\u00a0<br/><span class=\"kw1\">namespace</span> Rosetta<br/><span class=\"br0\">{</span><br/>    <span class=\"kw1\">internal</span> <span class=\"kw4\">class</span> Vector<br/>    <span class=\"br0\">{</span><br/>        <span class=\"kw1\">private</span> <span class=\"kw4\">double</span><span class=\"br0\">[</span><span class=\"br0\">]</span> b<span class=\"sy0\">;</span><br/>        <span class=\"kw1\">internal</span> <span class=\"kw1\">readonly</span> <span class=\"kw4\">int</span> rows<span class=\"sy0\">;</span><br/>\u00a0<br/>        <span class=\"kw1\">internal</span> Vector<span class=\"br0\">(</span><span class=\"kw4\">int</span> rows<span class=\"br0\">)</span><br/>        <span class=\"br0\">{</span><br/>            <span class=\"kw1\">this</span><span class=\"sy0\">.</span><span class=\"me1\">rows</span> <span class=\"sy0\">=</span> rows<span class=\"sy0\">;</span><br/>            b <span class=\"sy0\">=</span> <a href=\"http://www.google.com/search?q=new+msdn.microsoft.com\"><span class=\"kw3\">new</span></a> <span class=\"kw4\">double</span><span class=\"br0\">[</span>rows<span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>        <span class=\"br0\">}</span><br/>\u00a0<br/>        <span class=\"kw1\">internal</span> Vector<span class=\"br0\">(</span><span class=\"kw4\">double</span><span class=\"br0\">[</span><span class=\"br0\">]</span> initArray<span class=\"br0\">)</span><br/>        <span class=\"br0\">{</span><br/>            b <span class=\"sy0\">=</span> <span class=\"br0\">(</span><span class=\"kw4\">double</span><span class=\"br0\">[</span><span class=\"br0\">]</span><span class=\"br0\">)</span>initArray<span class=\"sy0\">.</span><span class=\"me1\">Clone</span><span class=\"br0\">(</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>            rows <span class=\"sy0\">=</span> b<span class=\"sy0\">.</span><span class=\"me1\">Length</span><span class=\"sy0\">;</span><br/>        <span class=\"br0\">}</span><br/>\u00a0<br/>        <span class=\"kw1\">internal</span> Vector Clone<span class=\"br0\">(</span><span class=\"br0\">)</span><br/>        <span class=\"br0\">{</span><br/>            Vector v <span class=\"sy0\">=</span> <a href=\"http://www.google.com/search?q=new+msdn.microsoft.com\"><span class=\"kw3\">new</span></a> Vector<span class=\"br0\">(</span>b<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>            <span class=\"kw1\">return</span> v<span class=\"sy0\">;</span><br/>        <span class=\"br0\">}</span><br/>\u00a0<br/>        <span class=\"kw1\">internal</span> <span class=\"kw4\">double</span> <span class=\"kw1\">this</span><span class=\"br0\">[</span><span class=\"kw4\">int</span> row<span class=\"br0\">]</span><br/>        <span class=\"br0\">{</span><br/>            <span class=\"kw1\">get</span> <span class=\"br0\">{</span> <span class=\"kw1\">return</span> b<span class=\"br0\">[</span>row<span class=\"br0\">]</span><span class=\"sy0\">;</span> <span class=\"br0\">}</span><br/>            <span class=\"kw1\">set</span> <span class=\"br0\">{</span> b<span class=\"br0\">[</span>row<span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"kw1\">value</span><span class=\"sy0\">;</span> <span class=\"br0\">}</span><br/>        <span class=\"br0\">}</span><br/>\u00a0<br/>        <span class=\"kw1\">internal</span> <span class=\"kw4\">void</span> SwapRows<span class=\"br0\">(</span><span class=\"kw4\">int</span> r1, <span class=\"kw4\">int</span> r2<span class=\"br0\">)</span><br/>        <span class=\"br0\">{</span><br/>            <span class=\"kw1\">if</span> <span class=\"br0\">(</span>r1 <span class=\"sy0\">==</span> r2<span class=\"br0\">)</span> <span class=\"kw1\">return</span><span class=\"sy0\">;</span><br/>            <span class=\"kw4\">double</span> tmp <span class=\"sy0\">=</span> b<span class=\"br0\">[</span>r1<span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>            b<span class=\"br0\">[</span>r1<span class=\"br0\">]</span> <span class=\"sy0\">=</span> b<span class=\"br0\">[</span>r2<span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>            b<span class=\"br0\">[</span>r2<span class=\"br0\">]</span> <span class=\"sy0\">=</span> tmp<span class=\"sy0\">;</span><br/>        <span class=\"br0\">}</span><br/>\u00a0<br/>        <span class=\"kw1\">internal</span> <span class=\"kw4\">double</span> norm<span class=\"br0\">(</span><span class=\"kw4\">double</span><span class=\"br0\">[</span><span class=\"br0\">]</span> weights<span class=\"br0\">)</span><br/>        <span class=\"br0\">{</span><br/>            <span class=\"kw4\">double</span> sum <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span><br/>            <span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw4\">int</span> i <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span> i <span class=\"sy0\">&lt;</span> rows<span class=\"sy0\">;</span> i<span class=\"sy0\">++</span><span class=\"br0\">)</span><br/>            <span class=\"br0\">{</span><br/>                <span class=\"kw4\">double</span> d <span class=\"sy0\">=</span> b<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">*</span> weights<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>                sum <span class=\"sy0\">+=</span>  d<span class=\"sy0\">*</span>d<span class=\"sy0\">;</span><br/>            <span class=\"br0\">}</span><br/>            <span class=\"kw1\">return</span> Math<span class=\"sy0\">.</span><span class=\"me1\">Sqrt</span><span class=\"br0\">(</span>sum<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>        <span class=\"br0\">}</span><br/>\u00a0<br/>        <span class=\"kw1\">internal</span> <span class=\"kw4\">void</span> print<span class=\"br0\">(</span><span class=\"br0\">)</span><br/>        <span class=\"br0\">{</span><br/>            <span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw4\">int</span> i <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span> i <span class=\"sy0\">&lt;</span> rows<span class=\"sy0\">;</span> i<span class=\"sy0\">++</span><span class=\"br0\">)</span><br/>                Console<span class=\"sy0\">.</span><span class=\"me1\">WriteLine</span><span class=\"br0\">(</span>b<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>            Console<span class=\"sy0\">.</span><span class=\"me1\">WriteLine</span><span class=\"br0\">(</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>        <span class=\"br0\">}</span><br/>\u00a0<br/>        <span class=\"kw1\">public</span> <span class=\"kw1\">static</span> Vector operator<span class=\"sy0\">-</span><span class=\"br0\">(</span>Vector lhs, Vector rhs<span class=\"br0\">)</span><br/>        <span class=\"br0\">{</span><br/>            Vector v <span class=\"sy0\">=</span> <a href=\"http://www.google.com/search?q=new+msdn.microsoft.com\"><span class=\"kw3\">new</span></a> Vector<span class=\"br0\">(</span>lhs<span class=\"sy0\">.</span><span class=\"me1\">rows</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>            <span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw4\">int</span> i <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span> i <span class=\"sy0\">&lt;</span> lhs<span class=\"sy0\">.</span><span class=\"me1\">rows</span><span class=\"sy0\">;</span> i<span class=\"sy0\">++</span><span class=\"br0\">)</span><br/>                v<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> lhs<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">-</span> rhs<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>            <span class=\"kw1\">return</span> v<span class=\"sy0\">;</span><br/>        <span class=\"br0\">}</span><br/>    <span class=\"br0\">}</span><br/>\u00a0<br/>    <span class=\"kw4\">class</span> Matrix<br/>    <span class=\"br0\">{</span><br/>        <span class=\"kw1\">private</span> <span class=\"kw4\">double</span><span class=\"br0\">[</span><span class=\"br0\">]</span> b<span class=\"sy0\">;</span><br/>        <span class=\"kw1\">internal</span> <span class=\"kw1\">readonly</span> <span class=\"kw4\">int</span> rows, cols<span class=\"sy0\">;</span><br/>\u00a0<br/>        <span class=\"kw1\">internal</span> Matrix<span class=\"br0\">(</span><span class=\"kw4\">int</span> rows, <span class=\"kw4\">int</span> cols<span class=\"br0\">)</span><br/>        <span class=\"br0\">{</span><br/>            <span class=\"kw1\">this</span><span class=\"sy0\">.</span><span class=\"me1\">rows</span> <span class=\"sy0\">=</span> rows<span class=\"sy0\">;</span><br/>            <span class=\"kw1\">this</span><span class=\"sy0\">.</span><span class=\"me1\">cols</span> <span class=\"sy0\">=</span> cols<span class=\"sy0\">;</span><br/>            b <span class=\"sy0\">=</span> <a href=\"http://www.google.com/search?q=new+msdn.microsoft.com\"><span class=\"kw3\">new</span></a> <span class=\"kw4\">double</span><span class=\"br0\">[</span>rows <span class=\"sy0\">*</span> cols<span class=\"br0\">]</span><span class=\"sy0\">;</span>            <br/>        <span class=\"br0\">}</span><br/>\u00a0<br/>        <span class=\"kw1\">internal</span> Matrix<span class=\"br0\">(</span><span class=\"kw4\">int</span> size<span class=\"br0\">)</span><br/>        <span class=\"br0\">{</span><br/>            <span class=\"kw1\">this</span><span class=\"sy0\">.</span><span class=\"me1\">rows</span> <span class=\"sy0\">=</span> size<span class=\"sy0\">;</span><br/>            <span class=\"kw1\">this</span><span class=\"sy0\">.</span><span class=\"me1\">cols</span> <span class=\"sy0\">=</span> size<span class=\"sy0\">;</span><br/>            b <span class=\"sy0\">=</span> <a href=\"http://www.google.com/search?q=new+msdn.microsoft.com\"><span class=\"kw3\">new</span></a> <span class=\"kw4\">double</span><span class=\"br0\">[</span>rows <span class=\"sy0\">*</span> cols<span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>            <span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw4\">int</span> i <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span> i <span class=\"sy0\">&lt;</span> size<span class=\"sy0\">;</span> i<span class=\"sy0\">++</span><span class=\"br0\">)</span><br/>                <span class=\"kw1\">this</span><span class=\"br0\">[</span>i, i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"nu0\">1</span><span class=\"sy0\">;</span><br/>        <span class=\"br0\">}</span><br/>\u00a0<br/>        <span class=\"kw1\">internal</span> Matrix<span class=\"br0\">(</span><span class=\"kw4\">int</span> rows, <span class=\"kw4\">int</span> cols, <span class=\"kw4\">double</span><span class=\"br0\">[</span><span class=\"br0\">]</span> initArray<span class=\"br0\">)</span><br/>        <span class=\"br0\">{</span><br/>            <span class=\"kw1\">this</span><span class=\"sy0\">.</span><span class=\"me1\">rows</span> <span class=\"sy0\">=</span> rows<span class=\"sy0\">;</span><br/>            <span class=\"kw1\">this</span><span class=\"sy0\">.</span><span class=\"me1\">cols</span> <span class=\"sy0\">=</span> cols<span class=\"sy0\">;</span><br/>            b <span class=\"sy0\">=</span> <span class=\"br0\">(</span><span class=\"kw4\">double</span><span class=\"br0\">[</span><span class=\"br0\">]</span><span class=\"br0\">)</span>initArray<span class=\"sy0\">.</span><span class=\"me1\">Clone</span><span class=\"br0\">(</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>            <span class=\"kw1\">if</span> <span class=\"br0\">(</span>b<span class=\"sy0\">.</span><span class=\"me1\">Length</span> <span class=\"sy0\">!=</span> rows <span class=\"sy0\">*</span> cols<span class=\"br0\">)</span> <span class=\"kw1\">throw</span> <a href=\"http://www.google.com/search?q=new+msdn.microsoft.com\"><span class=\"kw3\">new</span></a> Exception<span class=\"br0\">(</span><span class=\"st0\">\"bad init array\"</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>        <span class=\"br0\">}</span><br/>\u00a0<br/>        <span class=\"kw1\">internal</span> <span class=\"kw4\">double</span> <span class=\"kw1\">this</span><span class=\"br0\">[</span><span class=\"kw4\">int</span> row, <span class=\"kw4\">int</span> col<span class=\"br0\">]</span><br/>        <span class=\"br0\">{</span><br/>            <span class=\"kw1\">get</span> <span class=\"br0\">{</span> <span class=\"kw1\">return</span> b<span class=\"br0\">[</span>row <span class=\"sy0\">*</span> cols <span class=\"sy0\">+</span> col<span class=\"br0\">]</span><span class=\"sy0\">;</span> <span class=\"br0\">}</span><br/>            <span class=\"kw1\">set</span> <span class=\"br0\">{</span> b<span class=\"br0\">[</span>row <span class=\"sy0\">*</span> cols <span class=\"sy0\">+</span> col<span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"kw1\">value</span><span class=\"sy0\">;</span> <span class=\"br0\">}</span><br/>        <span class=\"br0\">}</span>        <br/>\u00a0<br/>        <span class=\"kw1\">public</span> <span class=\"kw1\">static</span> Vector <span class=\"kw1\">operator</span><span class=\"sy0\">*</span><span class=\"br0\">(</span>Matrix lhs, Vector rhs<span class=\"br0\">)</span><br/>        <span class=\"br0\">{</span><br/>            <span class=\"kw1\">if</span> <span class=\"br0\">(</span>lhs<span class=\"sy0\">.</span><span class=\"me1\">cols</span> <span class=\"sy0\">!=</span> rhs<span class=\"sy0\">.</span><span class=\"me1\">rows</span><span class=\"br0\">)</span> <span class=\"kw1\">throw</span> <a href=\"http://www.google.com/search?q=new+msdn.microsoft.com\"><span class=\"kw3\">new</span></a> Exception<span class=\"br0\">(</span><span class=\"st0\">\"I can't multiply matrix by vector\"</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>            Vector v <span class=\"sy0\">=</span> <a href=\"http://www.google.com/search?q=new+msdn.microsoft.com\"><span class=\"kw3\">new</span></a> Vector<span class=\"br0\">(</span>lhs<span class=\"sy0\">.</span><span class=\"me1\">rows</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>            <span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw4\">int</span> i <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span> i <span class=\"sy0\">&lt;</span> lhs<span class=\"sy0\">.</span><span class=\"me1\">rows</span><span class=\"sy0\">;</span> i<span class=\"sy0\">++</span><span class=\"br0\">)</span><br/>            <span class=\"br0\">{</span><br/>                <span class=\"kw4\">double</span> sum <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span><br/>                <span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw4\">int</span> j <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span> j <span class=\"sy0\">&lt;</span> rhs<span class=\"sy0\">.</span><span class=\"me1\">rows</span><span class=\"sy0\">;</span> j<span class=\"sy0\">++</span><span class=\"br0\">)</span><br/>                    sum <span class=\"sy0\">+=</span> lhs<span class=\"br0\">[</span>i,j<span class=\"br0\">]</span><span class=\"sy0\">*</span>rhs<span class=\"br0\">[</span>j<span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>                v<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> sum<span class=\"sy0\">;</span><br/>            <span class=\"br0\">}</span><br/>            <span class=\"kw1\">return</span> v<span class=\"sy0\">;</span><br/>        <span class=\"br0\">}</span><br/>\u00a0<br/>        <span class=\"kw1\">internal</span> <span class=\"kw4\">void</span> SwapRows<span class=\"br0\">(</span><span class=\"kw4\">int</span> r1, <span class=\"kw4\">int</span> r2<span class=\"br0\">)</span><br/>        <span class=\"br0\">{</span><br/>            <span class=\"kw1\">if</span> <span class=\"br0\">(</span>r1 <span class=\"sy0\">==</span> r2<span class=\"br0\">)</span> <span class=\"kw1\">return</span><span class=\"sy0\">;</span><br/>            <span class=\"kw4\">int</span> firstR1 <span class=\"sy0\">=</span> r1 <span class=\"sy0\">*</span> cols<span class=\"sy0\">;</span><br/>            <span class=\"kw4\">int</span> firstR2 <span class=\"sy0\">=</span> r2 <span class=\"sy0\">*</span> cols<span class=\"sy0\">;</span><br/>            <span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw4\">int</span> i <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span> i <span class=\"sy0\">&lt;</span> cols<span class=\"sy0\">;</span> i<span class=\"sy0\">++</span><span class=\"br0\">)</span><br/>            <span class=\"br0\">{</span><br/>                <span class=\"kw4\">double</span> tmp <span class=\"sy0\">=</span> b<span class=\"br0\">[</span>firstR1 <span class=\"sy0\">+</span> i<span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>                b<span class=\"br0\">[</span>firstR1 <span class=\"sy0\">+</span> i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> b<span class=\"br0\">[</span>firstR2 <span class=\"sy0\">+</span> i<span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>                b<span class=\"br0\">[</span>firstR2 <span class=\"sy0\">+</span> i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> tmp<span class=\"sy0\">;</span><br/>            <span class=\"br0\">}</span><br/>        <span class=\"br0\">}</span><br/>\u00a0<br/>        <span class=\"co1\">//with partial pivot</span><br/>        <span class=\"kw1\">internal</span> <span class=\"kw4\">void</span> ElimPartial<span class=\"br0\">(</span>Vector B<span class=\"br0\">)</span><br/>        <span class=\"br0\">{</span><br/>            <span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw4\">int</span> diag <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span> diag <span class=\"sy0\">&lt;</span> rows<span class=\"sy0\">;</span> diag<span class=\"sy0\">++</span><span class=\"br0\">)</span><br/>            <span class=\"br0\">{</span><br/>                <span class=\"kw4\">int</span> max_row <span class=\"sy0\">=</span> diag<span class=\"sy0\">;</span><br/>                <span class=\"kw4\">double</span> max_val <span class=\"sy0\">=</span> Math<span class=\"sy0\">.</span><span class=\"me1\">Abs</span><span class=\"br0\">(</span><span class=\"kw1\">this</span><span class=\"br0\">[</span>diag, diag<span class=\"br0\">]</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>                <span class=\"kw4\">double</span> d<span class=\"sy0\">;</span><br/>                <span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw4\">int</span> row <span class=\"sy0\">=</span> diag <span class=\"sy0\">+</span> <span class=\"nu0\">1</span><span class=\"sy0\">;</span> row <span class=\"sy0\">&lt;</span> rows<span class=\"sy0\">;</span> row<span class=\"sy0\">++</span><span class=\"br0\">)</span><br/>                    <span class=\"kw1\">if</span> <span class=\"br0\">(</span><span class=\"br0\">(</span>d <span class=\"sy0\">=</span> Math<span class=\"sy0\">.</span><span class=\"me1\">Abs</span><span class=\"br0\">(</span><span class=\"kw1\">this</span><span class=\"br0\">[</span>row, diag<span class=\"br0\">]</span><span class=\"br0\">)</span><span class=\"br0\">)</span> <span class=\"sy0\">&gt;</span> max_val<span class=\"br0\">)</span><br/>                    <span class=\"br0\">{</span><br/>                        max_row <span class=\"sy0\">=</span> row<span class=\"sy0\">;</span><br/>                        max_val <span class=\"sy0\">=</span> d<span class=\"sy0\">;</span><br/>                    <span class=\"br0\">}</span><br/>                SwapRows<span class=\"br0\">(</span>diag, max_row<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>                B<span class=\"sy0\">.</span><span class=\"me1\">SwapRows</span><span class=\"br0\">(</span>diag, max_row<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>                <span class=\"kw4\">double</span> invd <span class=\"sy0\">=</span> <span class=\"nu0\">1</span> <span class=\"sy0\">/</span> <span class=\"kw1\">this</span><span class=\"br0\">[</span>diag, diag<span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>                <span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw4\">int</span> col <span class=\"sy0\">=</span> diag<span class=\"sy0\">;</span> col <span class=\"sy0\">&lt;</span> cols<span class=\"sy0\">;</span> col<span class=\"sy0\">++</span><span class=\"br0\">)</span><br/>                    <span class=\"kw1\">this</span><span class=\"br0\">[</span>diag, col<span class=\"br0\">]</span> <span class=\"sy0\">*=</span> invd<span class=\"sy0\">;</span><br/>                B<span class=\"br0\">[</span>diag<span class=\"br0\">]</span> <span class=\"sy0\">*=</span> invd<span class=\"sy0\">;</span><br/>                <span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw4\">int</span> row <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span> row <span class=\"sy0\">&lt;</span> rows<span class=\"sy0\">;</span> row<span class=\"sy0\">++</span><span class=\"br0\">)</span><br/>                <span class=\"br0\">{</span><br/>                    d <span class=\"sy0\">=</span> <span class=\"kw1\">this</span><span class=\"br0\">[</span>row, diag<span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>                    <span class=\"kw1\">if</span> <span class=\"br0\">(</span>row <span class=\"sy0\">!=</span> diag<span class=\"br0\">)</span><br/>                    <span class=\"br0\">{</span><br/>                        <span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw4\">int</span> col <span class=\"sy0\">=</span> diag<span class=\"sy0\">;</span> col <span class=\"sy0\">&lt;</span> cols<span class=\"sy0\">;</span> col<span class=\"sy0\">++</span><span class=\"br0\">)</span><br/>                            <span class=\"kw1\">this</span><span class=\"br0\">[</span>row, col<span class=\"br0\">]</span> <span class=\"sy0\">-=</span> d <span class=\"sy0\">*</span> <span class=\"kw1\">this</span><span class=\"br0\">[</span>diag, col<span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>                        B<span class=\"br0\">[</span>row<span class=\"br0\">]</span> <span class=\"sy0\">-=</span> d <span class=\"sy0\">*</span> B<span class=\"br0\">[</span>diag<span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>                    <span class=\"br0\">}</span><br/>                <span class=\"br0\">}</span><br/>            <span class=\"br0\">}</span><br/>        <span class=\"br0\">}</span><br/>\u00a0<br/>        <span class=\"kw1\">internal</span> <span class=\"kw4\">void</span> print<span class=\"br0\">(</span><span class=\"br0\">)</span><br/>        <span class=\"br0\">{</span><br/>            <span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw4\">int</span> i <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span> i <span class=\"sy0\">&lt;</span> rows<span class=\"sy0\">;</span> i<span class=\"sy0\">++</span><span class=\"br0\">)</span><br/>            <span class=\"br0\">{</span><br/>                <span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw4\">int</span> j <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span> j <span class=\"sy0\">&lt;</span> cols<span class=\"sy0\">;</span> j<span class=\"sy0\">++</span><span class=\"br0\">)</span><br/>                    Console<span class=\"sy0\">.</span><span class=\"me1\">Write</span><span class=\"br0\">(</span><span class=\"kw1\">this</span><span class=\"br0\">[</span>i,j<span class=\"br0\">]</span><span class=\"sy0\">.</span><span class=\"me1\">ToString</span><span class=\"br0\">(</span><span class=\"br0\">)</span><span class=\"sy0\">+</span><span class=\"st0\">\"  \"</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>                Console<span class=\"sy0\">.</span><span class=\"me1\">WriteLine</span><span class=\"br0\">(</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>            <span class=\"br0\">}</span><br/>        <span class=\"br0\">}</span><br/>    <span class=\"br0\">}</span><br/><span class=\"br0\">}</span><br/>\u00a0</pre>"}, {"lang": "D", "loc": 69, "block": "<pre class=\"d highlighted_source\"><span class=\"kw2\">import</span> std.<span class=\"me1\">stdio</span><span class=\"sy0\">,</span> std.<span class=\"me1\">math</span><span class=\"sy0\">,</span> std.<span class=\"me1\">algorithm</span><span class=\"sy0\">,</span> std.<span class=\"me1\">range</span><span class=\"sy0\">,</span> std.<span class=\"me1\">numeric</span><span class=\"sy0\">,</span><br/>       std.<span class=\"me1\">typecons</span><span class=\"sy0\">;</span><br/>\u00a0<br/>Tuple<span class=\"sy0\">!</span><span class=\"br0\">(</span><span class=\"kw4\">double</span><span class=\"br0\">[</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><span class=\"st0\">\"x\"</span><span class=\"sy0\">,</span> <span class=\"kw4\">string</span><span class=\"sy0\">,</span><span class=\"st0\">\"err\"</span><span class=\"br0\">)</span><br/>gaussPartial<span class=\"br0\">(</span><span class=\"kw2\">in</span> <span class=\"kw4\">double</span><span class=\"br0\">[</span><span class=\"br0\">]</span><span class=\"br0\">[</span><span class=\"br0\">]</span> a0<span class=\"sy0\">,</span> <span class=\"kw2\">in</span> <span class=\"kw4\">double</span><span class=\"br0\">[</span><span class=\"br0\">]</span> b0<span class=\"br0\">)</span> <span class=\"kw4\">pure</span> <span class=\"coMULTI\">/*nothrow*/</span><br/><span class=\"kw2\">in</span> <span class=\"br0\">{</span><br/>    <span class=\"kw2\">assert</span><span class=\"br0\">(</span>a0.<span class=\"me1\">length</span> <span class=\"sy0\">==</span> a0<span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span>.<span class=\"me1\">length</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>    <span class=\"kw2\">assert</span><span class=\"br0\">(</span>a0.<span class=\"me1\">length</span> <span class=\"sy0\">==</span> b0.<span class=\"me1\">length</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>    <span class=\"kw2\">assert</span><span class=\"br0\">(</span>a0.<span class=\"me1\">all</span><span class=\"sy0\">!</span><span class=\"br0\">(</span>row <span class=\"sy0\">=&gt;</span> row.<span class=\"me1\">length</span> <span class=\"sy0\">==</span> a0<span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span>.<span class=\"me1\">length</span><span class=\"br0\">)</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/><span class=\"br0\">}</span> <span class=\"kw2\">body</span> <span class=\"br0\">{</span><br/>    <span class=\"kw4\">enum</span> eps <span class=\"sy0\">=</span> <span class=\"nu19\">1e-6</span><span class=\"sy0\">;</span><br/>    <span class=\"kw4\">immutable</span> m <span class=\"sy0\">=</span> b0.<span class=\"me1\">length</span><span class=\"sy0\">;</span><br/>\u00a0<br/>    <span class=\"co1\">// Make augmented matrix.</span><br/>    <span class=\"co1\">//auto a = a0.zip(b0).map!(c =&gt; c[0] ~ c[1]).array; // Not mutable.</span><br/>    <span class=\"kw4\">auto</span> a <span class=\"sy0\">=</span> a0.<span class=\"me1\">zip</span><span class=\"br0\">(</span>b0<span class=\"br0\">)</span>.<span class=\"me1\">map</span><span class=\"sy0\">!</span><span class=\"br0\">(</span>c <span class=\"sy0\">=&gt;</span> <span class=\"br0\">[</span><span class=\"br0\">]</span> <span class=\"sy0\">~</span> c<span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span> <span class=\"sy0\">~</span> c<span class=\"br0\">[</span><span class=\"nu0\">1</span><span class=\"br0\">]</span><span class=\"br0\">)</span>.<span class=\"me1\">array</span><span class=\"sy0\">;</span><br/>\u00a0<br/>    <span class=\"co1\">// Wikipedia algorithm from Gaussian elimination page,</span><br/>    <span class=\"co1\">// produces row-eschelon form.</span><br/>    <span class=\"kw1\">foreach</span> <span class=\"br0\">(</span><span class=\"kw4\">immutable</span> k<span class=\"sy0\">;</span> <span class=\"nu0\">0</span> <span class=\"sy0\">..</span> <span class=\"me1\">a</span>.<span class=\"me1\">length</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>        <span class=\"co1\">// Find pivot for column k and swap.</span><br/>        a<span class=\"br0\">[</span>k <span class=\"sy0\">..</span> <span class=\"me1\">m</span><span class=\"br0\">]</span>.<span class=\"me1\">minPos</span><span class=\"sy0\">!</span><span class=\"br0\">(</span><span class=\"br0\">(</span>x<span class=\"sy0\">,</span> y<span class=\"br0\">)</span> <span class=\"sy0\">=&gt;</span> x<span class=\"br0\">[</span>k<span class=\"br0\">]</span> <span class=\"sy0\">&gt;</span> y<span class=\"br0\">[</span>k<span class=\"br0\">]</span><span class=\"br0\">)</span>.<span class=\"me1\">front</span>.<span class=\"me1\">swap</span><span class=\"br0\">(</span>a<span class=\"br0\">[</span>k<span class=\"br0\">]</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>        <span class=\"kw1\">if</span> <span class=\"br0\">(</span>a<span class=\"br0\">[</span>k<span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"br0\">]</span>.<span class=\"me1\">abs</span> <span class=\"sy0\">&lt;</span> eps<span class=\"br0\">)</span><br/>            <span class=\"kw1\">return</span> <span class=\"kw2\">typeof</span><span class=\"br0\">(</span><span class=\"kw1\">return</span><span class=\"br0\">)</span><span class=\"br0\">(</span><span class=\"kw2\">null</span><span class=\"sy0\">,</span> <span class=\"st0\">\"singular\"</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\u00a0<br/>        <span class=\"co1\">// Do for all rows below pivot.</span><br/>        <span class=\"kw1\">foreach</span> <span class=\"br0\">(</span><span class=\"kw4\">immutable</span> i<span class=\"sy0\">;</span> k <span class=\"sy0\">+</span> <span class=\"nu0\">1</span> <span class=\"sy0\">..</span> <span class=\"me1\">m</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>            <span class=\"co1\">// Do for all remaining elements in current row.</span><br/>            a<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"sy0\">+</span><span class=\"nu0\">1</span> <span class=\"sy0\">..</span> <span class=\"me1\">m</span><span class=\"sy0\">+</span><span class=\"nu0\">1</span><span class=\"br0\">]</span> <span class=\"sy0\">-=</span> a<span class=\"br0\">[</span>k<span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"sy0\">+</span><span class=\"nu0\">1</span> <span class=\"sy0\">..</span> <span class=\"me1\">m</span><span class=\"sy0\">+</span><span class=\"nu0\">1</span><span class=\"br0\">]</span> <span class=\"sy0\">*</span> <span class=\"br0\">(</span>a<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"br0\">]</span> <span class=\"sy0\">/</span> a<span class=\"br0\">[</span>k<span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"br0\">]</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\u00a0<br/>            a<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span> <span class=\"co1\">// Fill lower triangular matrix with zeros.</span><br/>        <span class=\"br0\">}</span><br/>    <span class=\"br0\">}</span><br/>\u00a0<br/>    <span class=\"co1\">// End of WP algorithm. Now back substitute to get result.</span><br/>    <span class=\"kw4\">auto</span> x <span class=\"sy0\">=</span> <span class=\"kw2\">new</span> <span class=\"kw4\">double</span><span class=\"br0\">[</span>m<span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>    <span class=\"kw1\">foreach_reverse</span> <span class=\"br0\">(</span><span class=\"kw4\">immutable</span> i<span class=\"sy0\">;</span> <span class=\"nu0\">0</span> <span class=\"sy0\">..</span> <span class=\"me1\">m</span><span class=\"br0\">)</span><br/>        x<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"br0\">(</span>a<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>m<span class=\"br0\">]</span> <span class=\"sy0\">-</span> a<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>i<span class=\"sy0\">+</span><span class=\"nu0\">1</span> <span class=\"sy0\">..</span> <span class=\"me1\">m</span><span class=\"br0\">]</span>.<span class=\"me1\">dotProduct</span><span class=\"br0\">(</span>x<span class=\"br0\">[</span>i<span class=\"sy0\">+</span><span class=\"nu0\">1</span> <span class=\"sy0\">..</span> <span class=\"me1\">m</span><span class=\"br0\">]</span><span class=\"br0\">)</span><span class=\"br0\">)</span> <span class=\"sy0\">/</span> a<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>\u00a0<br/>    <span class=\"kw1\">return</span> <span class=\"kw2\">typeof</span><span class=\"br0\">(</span><span class=\"kw1\">return</span><span class=\"br0\">)</span><span class=\"br0\">(</span>x<span class=\"sy0\">,</span> <span class=\"kw2\">null</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/><span class=\"br0\">}</span><br/>\u00a0<br/><span class=\"kw4\">void</span> main<span class=\"br0\">(</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>    <span class=\"co1\">// The test case result is correct to this tolerance.</span><br/>    <span class=\"kw4\">enum</span> eps <span class=\"sy0\">=</span> <span class=\"nu19\">1e-13</span><span class=\"sy0\">;</span><br/>\u00a0<br/>    <span class=\"co1\">// Common RC example. Result computed with rational arithmetic</span><br/>    <span class=\"co1\">// then converted to double, and so should be about as close to</span><br/>    <span class=\"co1\">// correct as double represention allows.</span><br/>    <span class=\"kw4\">immutable</span> a <span class=\"sy0\">=</span> <span class=\"br0\">[</span><span class=\"br0\">[</span><span class=\"nu16\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu16\">0.00</span><span class=\"sy0\">,</span> <span class=\"nu16\">0.00</span><span class=\"sy0\">,</span>  <span class=\"nu16\">0.00</span><span class=\"sy0\">,</span>  <span class=\"nu16\">0.00</span><span class=\"sy0\">,</span>   <span class=\"nu16\">0.00</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>                   <span class=\"br0\">[</span><span class=\"nu16\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu16\">0.63</span><span class=\"sy0\">,</span> <span class=\"nu16\">0.39</span><span class=\"sy0\">,</span>  <span class=\"nu16\">0.25</span><span class=\"sy0\">,</span>  <span class=\"nu16\">0.16</span><span class=\"sy0\">,</span>   <span class=\"nu16\">0.10</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>                   <span class=\"br0\">[</span><span class=\"nu16\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu16\">1.26</span><span class=\"sy0\">,</span> <span class=\"nu16\">1.58</span><span class=\"sy0\">,</span>  <span class=\"nu16\">1.98</span><span class=\"sy0\">,</span>  <span class=\"nu16\">2.49</span><span class=\"sy0\">,</span>   <span class=\"nu16\">3.13</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>                   <span class=\"br0\">[</span><span class=\"nu16\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu16\">1.88</span><span class=\"sy0\">,</span> <span class=\"nu16\">3.55</span><span class=\"sy0\">,</span>  <span class=\"nu16\">6.70</span><span class=\"sy0\">,</span> <span class=\"nu16\">12.62</span><span class=\"sy0\">,</span>  <span class=\"nu16\">23.80</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>                   <span class=\"br0\">[</span><span class=\"nu16\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu16\">2.51</span><span class=\"sy0\">,</span> <span class=\"nu16\">6.32</span><span class=\"sy0\">,</span> <span class=\"nu16\">15.88</span><span class=\"sy0\">,</span> <span class=\"nu16\">39.90</span><span class=\"sy0\">,</span> <span class=\"nu16\">100.28</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>                   <span class=\"br0\">[</span><span class=\"nu16\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu16\">3.14</span><span class=\"sy0\">,</span> <span class=\"nu16\">9.87</span><span class=\"sy0\">,</span> <span class=\"nu16\">31.01</span><span class=\"sy0\">,</span> <span class=\"nu16\">97.41</span><span class=\"sy0\">,</span> <span class=\"nu16\">306.02</span><span class=\"br0\">]</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>    <span class=\"kw4\">immutable</span> b <span class=\"sy0\">=</span> <span class=\"br0\">[</span><span class=\"sy0\">-</span><span class=\"nu16\">0.01</span><span class=\"sy0\">,</span> <span class=\"nu16\">0.61</span><span class=\"sy0\">,</span> <span class=\"nu16\">0.91</span><span class=\"sy0\">,</span>  <span class=\"nu16\">0.99</span><span class=\"sy0\">,</span>  <span class=\"nu16\">0.60</span><span class=\"sy0\">,</span>   <span class=\"nu16\">0.02</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>\u00a0<br/>    <span class=\"kw4\">immutable</span> r <span class=\"sy0\">=</span> gaussPartial<span class=\"br0\">(</span>a<span class=\"sy0\">,</span> b<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>    <span class=\"kw1\">if</span> <span class=\"br0\">(</span><span class=\"sy0\">!</span>r.<span class=\"me1\">err</span>.<span class=\"me1\">empty</span><span class=\"br0\">)</span><br/>        <span class=\"kw1\">return</span> writeln<span class=\"br0\">(</span><span class=\"st0\">\"Error: \"</span><span class=\"sy0\">,</span> r.<span class=\"me1\">err</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>    r.<span class=\"me1\">x</span>.<span class=\"me1\">writeln</span><span class=\"sy0\">;</span><br/>\u00a0<br/>    <span class=\"kw4\">immutable</span> result <span class=\"sy0\">=</span> <span class=\"br0\">[</span><span class=\"sy0\">-</span><span class=\"nu16\">0.01</span><span class=\"sy0\">,</span>               <span class=\"nu16\">1.602790394502114</span><span class=\"sy0\">,</span><br/>                        <span class=\"sy0\">-</span><span class=\"nu16\">1.6132030599055613</span><span class=\"sy0\">,</span> <span class=\"nu16\">1.2454941213714368</span><span class=\"sy0\">,</span><br/>                        <span class=\"sy0\">-</span><span class=\"nu16\">0.4909897195846576</span><span class=\"sy0\">,</span> <span class=\"nu16\">0.065760696175232</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>    <span class=\"kw1\">foreach</span> <span class=\"br0\">(</span><span class=\"kw4\">immutable</span> i<span class=\"sy0\">,</span> <span class=\"kw4\">immutable</span> xi<span class=\"sy0\">;</span> result<span class=\"br0\">)</span><br/>        <span class=\"kw1\">if</span> <span class=\"br0\">(</span>abs<span class=\"br0\">(</span>r.<span class=\"me1\">x</span><span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">-</span> xi<span class=\"br0\">)</span> <span class=\"sy0\">&gt;</span> eps<span class=\"br0\">)</span><br/>            <span class=\"kw1\">return</span> writeln<span class=\"br0\">(</span><span class=\"st0\">\"Out of tolerance: \"</span><span class=\"sy0\">,</span> r.<span class=\"me1\">x</span><span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"sy0\">,</span> <span class=\"st0\">\" \"</span><span class=\"sy0\">,</span> xi<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/><span class=\"br0\">}</span></pre>"}, {"lang": "Delphi", "loc": 146, "block": "<pre class=\"delphi highlighted_source\"><span class=\"kw1\">program</span> GuassianElimination<span class=\"sy1\">;</span><br/>\u00a0<br/><span class=\"co1\">// Modified from: </span><br/><span class=\"co1\">// R. Sureshkumar (10 January 1997)</span><br/><span class=\"co1\">// Gregory J. McRae (22 October 1997)</span><br/><span class=\"co1\">// http://web.mit.edu/10.001/Web/Course_Notes/Gauss_Pivoting.c</span><br/>\u00a0<br/><span class=\"co2\">{$APPTYPE CONSOLE}</span><br/>\u00a0<br/><span class=\"co2\">{$R *.res}</span><br/>\u00a0<br/><span class=\"kw1\">uses</span><br/>  System<span class=\"sy1\">.</span><span class=\"me1\">SysUtils</span><span class=\"sy1\">;</span><br/>\u00a0<br/><span class=\"kw1\">type</span><br/>  TMatrix <span class=\"sy3\">=</span> <span class=\"kw1\">class</span><br/>     <span class=\"kw1\">private</span><br/>      _r<span class=\"sy1\">,</span> _c <span class=\"sy1\">:</span> <span class=\"kw4\">integer</span><span class=\"sy1\">;</span><br/>      data <span class=\"sy1\">:</span> <span class=\"kw1\">array</span> <span class=\"kw1\">of</span> TDoubleArray<span class=\"sy1\">;</span><br/>      <span class=\"kw1\">function</span>    getValue<span class=\"br0\">(</span>rIndex<span class=\"sy1\">,</span> cIndex <span class=\"sy1\">:</span> <span class=\"kw4\">integer</span><span class=\"br0\">)</span><span class=\"sy1\">:</span> <span class=\"kw4\">double</span><span class=\"sy1\">;</span><br/>      <span class=\"kw1\">procedure</span>   setValue<span class=\"br0\">(</span>rIndex<span class=\"sy1\">,</span> cIndex <span class=\"sy1\">:</span> <span class=\"kw4\">integer</span><span class=\"sy1\">;</span> value<span class=\"sy1\">:</span> <span class=\"kw4\">double</span><span class=\"br0\">)</span><span class=\"sy1\">;</span><br/>     <span class=\"kw1\">public</span><br/>      <span class=\"kw1\">constructor</span> Create <span class=\"br0\">(</span>r<span class=\"sy1\">,</span> c <span class=\"sy1\">:</span> <span class=\"kw4\">integer</span><span class=\"br0\">)</span><span class=\"sy1\">;</span><br/>      <span class=\"kw1\">destructor</span>  Destroy<span class=\"sy1\">;</span> <span class=\"kw1\">override</span><span class=\"sy1\">;</span><br/>\u00a0<br/>      <span class=\"kw1\">property</span> r <span class=\"sy1\">:</span> <span class=\"kw4\">integer</span> <span class=\"kw1\">read</span> _r<span class=\"sy1\">;</span><br/>      <span class=\"kw1\">property</span> c <span class=\"sy1\">:</span> <span class=\"kw4\">integer</span> <span class=\"kw1\">read</span> _c<span class=\"sy1\">;</span><br/>      <span class=\"kw1\">property</span> value<span class=\"br0\">[</span>rIndex<span class=\"sy1\">,</span> cIndex<span class=\"sy1\">:</span> <span class=\"kw4\">integer</span><span class=\"br0\">]</span><span class=\"sy1\">:</span> <span class=\"kw4\">double</span> <span class=\"kw1\">read</span> getValue <span class=\"kw1\">write</span> setValue<span class=\"sy1\">;</span> <span class=\"kw1\">default</span><span class=\"sy1\">;</span><br/>  <span class=\"kw1\">end</span><span class=\"sy1\">;</span><br/>\u00a0<br/>\u00a0<br/><span class=\"kw1\">constructor</span> TMatrix<span class=\"sy1\">.</span><span class=\"me1\">Create</span> <span class=\"br0\">(</span>r<span class=\"sy1\">,</span> c <span class=\"sy1\">:</span> <span class=\"kw4\">integer</span><span class=\"br0\">)</span><span class=\"sy1\">;</span><br/><span class=\"kw1\">begin</span><br/>  <span class=\"kw1\">inherited</span> Create<span class=\"sy1\">;</span><br/>  <span class=\"kw2\">self</span><span class=\"sy1\">.</span><span class=\"me1\">r</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> r<span class=\"sy1\">;</span> <span class=\"kw2\">self</span><span class=\"sy1\">.</span><span class=\"me1\">c</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> c<span class=\"sy1\">;</span><br/>  <span class=\"kw3\">setLength</span> <span class=\"br0\">(</span>data<span class=\"sy1\">,</span> r<span class=\"sy1\">,</span> c<span class=\"br0\">)</span><span class=\"sy1\">;</span><br/><span class=\"kw1\">end</span><span class=\"sy1\">;</span><br/>\u00a0<br/><span class=\"kw1\">destructor</span> TMatrix<span class=\"sy1\">.</span><span class=\"me1\">Destroy</span><span class=\"sy1\">;</span><br/><span class=\"kw1\">begin</span><br/>  data <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"kw1\">nil</span><span class=\"sy1\">;</span><br/>  <span class=\"kw1\">inherited</span><span class=\"sy1\">;</span><br/><span class=\"kw1\">end</span><span class=\"sy1\">;</span><br/>\u00a0<br/><span class=\"kw1\">function</span> TMatrix<span class=\"sy1\">.</span><span class=\"me1\">getValue</span><span class=\"br0\">(</span>rIndex<span class=\"sy1\">,</span> cIndex<span class=\"sy1\">:</span> <span class=\"kw4\">Integer</span><span class=\"br0\">)</span><span class=\"sy1\">:</span> <span class=\"kw4\">double</span><span class=\"sy1\">;</span><br/><span class=\"kw1\">begin</span><br/>  Result <span class=\"sy1\">:</span><span class=\"sy3\">=</span> data<span class=\"br0\">[</span>rIndex<span class=\"sy3\">-</span><span class=\"nu0\">1</span><span class=\"sy1\">,</span> cIndex<span class=\"sy3\">-</span><span class=\"nu0\">1</span><span class=\"br0\">]</span><span class=\"sy1\">;</span> <span class=\"co1\">// 1-based array</span><br/><span class=\"kw1\">end</span><span class=\"sy1\">;</span><br/>\u00a0<br/><span class=\"kw1\">procedure</span> TMatrix<span class=\"sy1\">.</span><span class=\"me1\">setValue</span><span class=\"br0\">(</span>rIndex<span class=\"sy1\">,</span> cIndex <span class=\"sy1\">:</span> <span class=\"kw4\">integer</span><span class=\"sy1\">;</span> value<span class=\"sy1\">:</span> <span class=\"kw4\">double</span><span class=\"br0\">)</span><span class=\"sy1\">;</span><br/><span class=\"kw1\">begin</span><br/>  data<span class=\"br0\">[</span>rIndex<span class=\"sy3\">-</span><span class=\"nu0\">1</span><span class=\"sy1\">,</span> cIndex<span class=\"sy3\">-</span><span class=\"nu0\">1</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> value<span class=\"sy1\">;</span> <span class=\"co1\">// 1-based array</span><br/><span class=\"kw1\">end</span><span class=\"sy1\">;</span><br/>\u00a0<br/><span class=\"co1\">// Solve A x = b</span><br/><span class=\"kw1\">procedure</span> gauss <span class=\"br0\">(</span>A<span class=\"sy1\">,</span> b<span class=\"sy1\">,</span> x <span class=\"sy1\">:</span> TMatrix<span class=\"br0\">)</span><span class=\"sy1\">;</span><br/><span class=\"kw1\">var</span> rowx <span class=\"sy1\">:</span> <span class=\"kw4\">integer</span><span class=\"sy1\">;</span><br/>    i<span class=\"sy1\">,</span> j<span class=\"sy1\">,</span> k<span class=\"sy1\">,</span> n<span class=\"sy1\">,</span> m <span class=\"sy1\">:</span> <span class=\"kw4\">integer</span><span class=\"sy1\">;</span><br/>    amax<span class=\"sy1\">,</span> xfac<span class=\"sy1\">,</span> temp<span class=\"sy1\">,</span> temp1 <span class=\"sy1\">:</span> <span class=\"kw4\">double</span><span class=\"sy1\">;</span><br/><span class=\"kw1\">begin</span><br/>  rowx <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"nu0\">0</span><span class=\"sy1\">;</span>  <span class=\"co1\">// Keep count of the row interchanges</span><br/>  n <span class=\"sy1\">:</span><span class=\"sy3\">=</span> A<span class=\"sy1\">.</span><span class=\"me1\">r</span><span class=\"sy1\">;</span><br/>  <span class=\"kw1\">for</span> k <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"nu0\">1</span> <span class=\"kw1\">to</span> n <span class=\"sy3\">-</span> <span class=\"nu0\">1</span> <span class=\"kw1\">do</span><br/>      <span class=\"kw1\">begin</span><br/>      amax <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"kw3\">abs</span> <span class=\"br0\">(</span>A<span class=\"br0\">[</span>k<span class=\"sy1\">,</span>k<span class=\"br0\">]</span><span class=\"br0\">)</span><span class=\"sy1\">;</span><br/>      m <span class=\"sy1\">:</span><span class=\"sy3\">=</span> k<span class=\"sy1\">;</span><br/>      <span class=\"co1\">// Find the row with largest pivot</span><br/>      <span class=\"kw1\">for</span> i <span class=\"sy1\">:</span><span class=\"sy3\">=</span> k <span class=\"sy3\">+</span> <span class=\"nu0\">1</span> <span class=\"kw1\">to</span> n <span class=\"kw1\">do</span><br/>          <span class=\"kw1\">begin</span><br/>          xfac <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"kw3\">abs</span> <span class=\"br0\">(</span>A<span class=\"br0\">[</span>i<span class=\"sy1\">,</span>k<span class=\"br0\">]</span><span class=\"br0\">)</span><span class=\"sy1\">;</span><br/>          <span class=\"kw1\">if</span> xfac &gt; amax <span class=\"kw1\">then</span><br/>             <span class=\"kw1\">begin</span><br/>             amax <span class=\"sy1\">:</span><span class=\"sy3\">=</span> xfac<span class=\"sy1\">;</span><br/>             m <span class=\"sy1\">:</span><span class=\"sy3\">=</span> i<span class=\"sy1\">;</span><br/>             <span class=\"kw1\">end</span><span class=\"sy1\">;</span><br/>          <span class=\"kw1\">end</span><span class=\"sy1\">;</span><br/>\u00a0<br/>      <span class=\"kw1\">if</span> m &lt;&gt; k <span class=\"kw1\">then</span><br/>         <span class=\"kw1\">begin</span>  <span class=\"co1\">// Row interchanges</span><br/>         rowx <span class=\"sy1\">:</span><span class=\"sy3\">=</span> rowx<span class=\"sy3\">+</span><span class=\"nu0\">1</span><span class=\"sy1\">;</span><br/>         temp1 <span class=\"sy1\">:</span><span class=\"sy3\">=</span> b<span class=\"br0\">[</span>k<span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span><span class=\"sy1\">;</span><br/>         b<span class=\"br0\">[</span>k<span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> b<span class=\"br0\">[</span>m<span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span><span class=\"sy1\">;</span><br/>         b<span class=\"br0\">[</span>m<span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span>  <span class=\"sy1\">:</span><span class=\"sy3\">=</span> temp1<span class=\"sy1\">;</span><br/>         <span class=\"kw1\">for</span> j <span class=\"sy1\">:</span><span class=\"sy3\">=</span> k <span class=\"kw1\">to</span> n <span class=\"kw1\">do</span><br/>             <span class=\"kw1\">begin</span><br/>             temp <span class=\"sy1\">:</span><span class=\"sy3\">=</span> a<span class=\"br0\">[</span>k<span class=\"sy1\">,</span>j<span class=\"br0\">]</span><span class=\"sy1\">;</span><br/>             a<span class=\"br0\">[</span>k<span class=\"sy1\">,</span>j<span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> a<span class=\"br0\">[</span>m<span class=\"sy1\">,</span>j<span class=\"br0\">]</span><span class=\"sy1\">;</span><br/>             a<span class=\"br0\">[</span>m<span class=\"sy1\">,</span>j<span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> temp<span class=\"sy1\">;</span><br/>             <span class=\"kw1\">end</span><span class=\"sy1\">;</span><br/>      <span class=\"kw1\">end</span><span class=\"sy1\">;</span><br/>\u00a0<br/>      <span class=\"kw1\">for</span> i <span class=\"sy1\">:</span><span class=\"sy3\">=</span> k<span class=\"sy3\">+</span><span class=\"nu0\">1</span> <span class=\"kw1\">to</span> n <span class=\"kw1\">do</span><br/>          <span class=\"kw1\">begin</span><br/>          xfac <span class=\"sy1\">:</span><span class=\"sy3\">=</span> a<span class=\"br0\">[</span>i<span class=\"sy1\">,</span> k<span class=\"br0\">]</span><span class=\"sy3\">/</span>a<span class=\"br0\">[</span>k<span class=\"sy1\">,</span> k<span class=\"br0\">]</span><span class=\"sy1\">;</span><br/>          <span class=\"kw1\">for</span> j <span class=\"sy1\">:</span><span class=\"sy3\">=</span> k<span class=\"sy3\">+</span><span class=\"nu0\">1</span> <span class=\"kw1\">to</span> n <span class=\"kw1\">do</span><br/>              a<span class=\"br0\">[</span>i<span class=\"sy1\">,</span>j<span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> a<span class=\"br0\">[</span>i<span class=\"sy1\">,</span>j<span class=\"br0\">]</span><span class=\"sy3\">-</span>xfac<span class=\"sy3\">*</span>a<span class=\"br0\">[</span>k<span class=\"sy1\">,</span>j<span class=\"br0\">]</span><span class=\"sy1\">;</span><br/>          b<span class=\"br0\">[</span>i<span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> b<span class=\"br0\">[</span>i<span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span> <span class=\"sy3\">-</span> xfac<span class=\"sy3\">*</span>b<span class=\"br0\">[</span>k<span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span><br/>          <span class=\"kw1\">end</span><span class=\"sy1\">;</span><br/>      <span class=\"kw1\">end</span><span class=\"sy1\">;</span><br/>\u00a0<br/>  <span class=\"co1\">// Back substitution</span><br/>  <span class=\"kw1\">for</span> j <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"nu0\">1</span> <span class=\"kw1\">to</span> n <span class=\"kw1\">do</span><br/>      <span class=\"kw1\">begin</span><br/>      k <span class=\"sy1\">:</span><span class=\"sy3\">=</span> n<span class=\"sy3\">-</span>j <span class=\"sy3\">+</span> <span class=\"nu0\">1</span><span class=\"sy1\">;</span><br/>      x<span class=\"br0\">[</span>k<span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> b<span class=\"br0\">[</span>k<span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span><span class=\"sy1\">;</span><br/>      <span class=\"kw1\">for</span> i <span class=\"sy1\">:</span><span class=\"sy3\">=</span> k<span class=\"sy3\">+</span><span class=\"nu0\">1</span> <span class=\"kw1\">to</span> n <span class=\"kw1\">do</span><br/>          <span class=\"kw1\">begin</span><br/>          x<span class=\"br0\">[</span>k<span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> x<span class=\"br0\">[</span>k<span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span> <span class=\"sy3\">-</span> a<span class=\"br0\">[</span>k<span class=\"sy1\">,</span>i<span class=\"br0\">]</span><span class=\"sy3\">*</span>x<span class=\"br0\">[</span>i<span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span><span class=\"sy1\">;</span><br/>          <span class=\"kw1\">end</span><span class=\"sy1\">;</span><br/>  x<span class=\"br0\">[</span>k<span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> x<span class=\"br0\">[</span>k<span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span><span class=\"sy3\">/</span>a<span class=\"br0\">[</span>k<span class=\"sy1\">,</span>k<span class=\"br0\">]</span><span class=\"sy1\">;</span><br/>  <span class=\"kw1\">end</span><span class=\"sy1\">;</span><br/><span class=\"kw1\">end</span><span class=\"sy1\">;</span><br/>\u00a0<br/>\u00a0<br/><span class=\"kw1\">var</span> A<span class=\"sy1\">,</span> b<span class=\"sy1\">,</span> x <span class=\"sy1\">:</span> TMatrix<span class=\"sy1\">;</span><br/>\u00a0<br/><span class=\"kw1\">begin</span><br/>  <span class=\"kw1\">try</span><br/>    <span class=\"co1\">// Could have been done with simple arrays rather than a specific TMatrix class</span><br/>    A <span class=\"sy1\">:</span><span class=\"sy3\">=</span> TMatrix<span class=\"sy1\">.</span><span class=\"me1\">Create</span> <span class=\"br0\">(</span><span class=\"nu0\">4</span><span class=\"sy1\">,</span><span class=\"nu0\">4</span><span class=\"br0\">)</span><span class=\"sy1\">;</span><br/>    <span class=\"co1\">// Note ideal but use TMatrix to define the vectors as well</span><br/>    b <span class=\"sy1\">:</span><span class=\"sy3\">=</span> TMatrix<span class=\"sy1\">.</span><span class=\"me1\">Create</span> <span class=\"br0\">(</span><span class=\"nu0\">4</span><span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">)</span><span class=\"sy1\">;</span><br/>    x <span class=\"sy1\">:</span><span class=\"sy3\">=</span> TMatrix<span class=\"sy1\">.</span><span class=\"me1\">Create</span> <span class=\"br0\">(</span><span class=\"nu0\">4</span><span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">)</span><span class=\"sy1\">;</span><br/>\u00a0<br/>    A<span class=\"br0\">[</span><span class=\"nu0\">1</span><span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"nu0\">2</span><span class=\"sy1\">;</span> A<span class=\"br0\">[</span><span class=\"nu0\">1</span><span class=\"sy1\">,</span><span class=\"nu0\">2</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"nu0\">1</span><span class=\"sy1\">;</span> A<span class=\"br0\">[</span><span class=\"nu0\">1</span><span class=\"sy1\">,</span><span class=\"nu0\">3</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"nu0\">0</span><span class=\"sy1\">;</span> A<span class=\"br0\">[</span><span class=\"nu0\">1</span><span class=\"sy1\">,</span><span class=\"nu0\">4</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"nu0\">0</span><span class=\"sy1\">;</span><br/>    A<span class=\"br0\">[</span><span class=\"nu0\">2</span><span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"nu0\">1</span><span class=\"sy1\">;</span> A<span class=\"br0\">[</span><span class=\"nu0\">2</span><span class=\"sy1\">,</span><span class=\"nu0\">2</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"nu0\">1</span><span class=\"sy1\">;</span> A<span class=\"br0\">[</span><span class=\"nu0\">2</span><span class=\"sy1\">,</span><span class=\"nu0\">3</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"nu0\">1</span><span class=\"sy1\">;</span> A<span class=\"br0\">[</span><span class=\"nu0\">2</span><span class=\"sy1\">,</span><span class=\"nu0\">4</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"nu0\">0</span><span class=\"sy1\">;</span><br/>    A<span class=\"br0\">[</span><span class=\"nu0\">3</span><span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"nu0\">0</span><span class=\"sy1\">;</span> A<span class=\"br0\">[</span><span class=\"nu0\">3</span><span class=\"sy1\">,</span><span class=\"nu0\">2</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"nu0\">1</span><span class=\"sy1\">;</span> A<span class=\"br0\">[</span><span class=\"nu0\">3</span><span class=\"sy1\">,</span><span class=\"nu0\">3</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"nu0\">2</span><span class=\"sy1\">;</span> A<span class=\"br0\">[</span><span class=\"nu0\">3</span><span class=\"sy1\">,</span><span class=\"nu0\">4</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"nu0\">1</span><span class=\"sy1\">;</span><br/>    A<span class=\"br0\">[</span><span class=\"nu0\">4</span><span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"nu0\">0</span><span class=\"sy1\">;</span> A<span class=\"br0\">[</span><span class=\"nu0\">3</span><span class=\"sy1\">,</span><span class=\"nu0\">2</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"nu0\">0</span><span class=\"sy1\">;</span> A<span class=\"br0\">[</span><span class=\"nu0\">4</span><span class=\"sy1\">,</span><span class=\"nu0\">3</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"nu0\">1</span><span class=\"sy1\">;</span> A<span class=\"br0\">[</span><span class=\"nu0\">4</span><span class=\"sy1\">,</span><span class=\"nu0\">4</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"nu0\">2</span><span class=\"sy1\">;</span><br/>\u00a0<br/>    b<span class=\"br0\">[</span><span class=\"nu0\">1</span><span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"nu0\">2</span><span class=\"sy1\">;</span> b<span class=\"br0\">[</span><span class=\"nu0\">2</span><span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"nu0\">1</span><span class=\"sy1\">;</span> b<span class=\"br0\">[</span><span class=\"nu0\">3</span><span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"nu0\">4</span><span class=\"sy1\">;</span> b<span class=\"br0\">[</span><span class=\"nu0\">4</span><span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span> <span class=\"sy1\">:</span><span class=\"sy3\">=</span> <span class=\"nu0\">8</span><span class=\"sy1\">;</span><br/>\u00a0<br/>    gauss <span class=\"br0\">(</span>A<span class=\"sy1\">,</span> b<span class=\"sy1\">,</span> x<span class=\"br0\">)</span><span class=\"sy1\">;</span><br/>\u00a0<br/>    <span class=\"kw3\">writeln</span> <span class=\"br0\">(</span>x<span class=\"br0\">[</span><span class=\"nu0\">1</span><span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span><span class=\"sy1\">:</span><span class=\"nu0\">5</span><span class=\"sy1\">:</span><span class=\"nu0\">2</span><span class=\"br0\">)</span><span class=\"sy1\">;</span><br/>    <span class=\"kw3\">writeln</span> <span class=\"br0\">(</span>x<span class=\"br0\">[</span><span class=\"nu0\">2</span><span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span><span class=\"sy1\">:</span><span class=\"nu0\">5</span><span class=\"sy1\">:</span><span class=\"nu0\">2</span><span class=\"br0\">)</span><span class=\"sy1\">;</span><br/>    <span class=\"kw3\">writeln</span> <span class=\"br0\">(</span>x<span class=\"br0\">[</span><span class=\"nu0\">3</span><span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span><span class=\"sy1\">:</span><span class=\"nu0\">5</span><span class=\"sy1\">:</span><span class=\"nu0\">2</span><span class=\"br0\">)</span><span class=\"sy1\">;</span><br/>    <span class=\"kw3\">writeln</span> <span class=\"br0\">(</span>x<span class=\"br0\">[</span><span class=\"nu0\">4</span><span class=\"sy1\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span><span class=\"sy1\">:</span><span class=\"nu0\">5</span><span class=\"sy1\">:</span><span class=\"nu0\">2</span><span class=\"br0\">)</span><span class=\"sy1\">;</span><br/>\u00a0<br/>    readln<span class=\"sy1\">;</span><br/>  <span class=\"kw1\">except</span><br/>    <span class=\"kw1\">on</span> E<span class=\"sy1\">:</span> Exception <span class=\"kw1\">do</span><br/>      <span class=\"kw3\">Writeln</span><span class=\"br0\">(</span>E<span class=\"sy1\">.</span><span class=\"me1\">ClassName</span><span class=\"sy1\">,</span> <span class=\"st0\">': '</span><span class=\"sy1\">,</span> E<span class=\"sy1\">.</span><span class=\"kw1\">Message</span><span class=\"br0\">)</span><span class=\"sy1\">;</span><br/>  <span class=\"kw1\">end</span><span class=\"sy1\">;</span><br/><span class=\"kw1\">end</span><span class=\"sy1\">.</span><br/>\u00a0<br/>\u00a0</pre>"}, {"lang": "Fortran", "loc": 45, "block": "<pre class=\"fortran highlighted_source\">\u00a0<br/>        <span class=\"kw1\">program</span> ge<br/>\u00a0<br/>          <span class=\"kw3\">real</span>, <span class=\"kw3\">allocatable</span> <span class=\"sy0\">::</span> <span class=\"me2\">a</span><span class=\"br0\">(</span><span class=\"sy0\">:</span>,<span class=\"sy0\">:</span><span class=\"br0\">)</span>,b<span class=\"br0\">(</span><span class=\"sy0\">:</span><span class=\"br0\">)</span><br/>          a <span class=\"sy0\">=</span> <span class=\"kw4\">reshape</span><span class=\"br0\">(</span>                             <span class=\"sy0\">&amp;</span><br/>          <span class=\"br0\">[</span><span class=\"nu0\">1.0</span>, <span class=\"nu0\">1.00</span>, <span class=\"nu0\">1.00</span>,  <span class=\"nu0\">1.00</span>,   <span class=\"nu0\">1.00</span>,   <span class=\"nu0\">1.00</span>, <span class=\"sy0\">&amp;</span><br/>           <span class=\"nu0\">0.0</span>, <span class=\"nu0\">0.63</span>, <span class=\"nu0\">1.26</span>,  <span class=\"nu0\">1.88</span>,   <span class=\"nu0\">2.51</span>,   <span class=\"nu0\">3.14</span>, <span class=\"sy0\">&amp;</span><br/>           <span class=\"nu0\">0.0</span>, <span class=\"nu0\">0.39</span>, <span class=\"nu0\">1.58</span>,  <span class=\"nu0\">3.55</span>,   <span class=\"nu0\">6.32</span>,   <span class=\"nu0\">9.87</span>, <span class=\"sy0\">&amp;</span><br/>           <span class=\"nu0\">0.0</span>, <span class=\"nu0\">0.25</span>, <span class=\"nu0\">1.98</span>,  <span class=\"nu0\">6.70</span>,  <span class=\"nu0\">15.88</span>,  <span class=\"nu0\">31.01</span>, <span class=\"sy0\">&amp;</span><br/>           <span class=\"nu0\">0.0</span>, <span class=\"nu0\">0.16</span>, <span class=\"nu0\">2.49</span>, <span class=\"nu0\">12.62</span>,  <span class=\"nu0\">39.90</span>,  <span class=\"nu0\">97.41</span>, <span class=\"sy0\">&amp;</span><br/>           <span class=\"nu0\">0.0</span>, <span class=\"nu0\">0.10</span>, <span class=\"nu0\">3.13</span>, <span class=\"nu0\">23.80</span>, <span class=\"nu0\">100.28</span>, <span class=\"nu0\">306.02</span><span class=\"br0\">]</span>, <span class=\"br0\">[</span><span class=\"nu0\">6</span>,<span class=\"nu0\">6</span><span class=\"br0\">]</span> <span class=\"br0\">)</span><br/>          b <span class=\"sy0\">=</span> <span class=\"br0\">[</span><span class=\"sy0\">-</span><span class=\"nu0\">0.01</span>, <span class=\"nu0\">0.61</span>, <span class=\"nu0\">0.91</span>, <span class=\"nu0\">0.99</span>, <span class=\"nu0\">0.60</span>, <span class=\"nu0\">0.02</span><span class=\"br0\">]</span><br/>          print<span class=\"st0\">'(f15.7)'</span>,solve_wbs<span class=\"br0\">(</span>ge_wpp<span class=\"br0\">(</span>a,b<span class=\"br0\">)</span><span class=\"br0\">)</span><br/>\u00a0<br/>        <span class=\"kw1\">contains</span><br/>\u00a0<br/>          <span class=\"kw1\">function</span> solve_wbs<span class=\"br0\">(</span>u<span class=\"br0\">)</span> <span class=\"kw3\">result</span><span class=\"br0\">(</span>x<span class=\"br0\">)</span> <span class=\"co1\">! solve with backward substitution</span><br/>            <span class=\"kw3\">real</span>                 <span class=\"sy0\">::</span> <span class=\"me2\">u</span><span class=\"br0\">(</span><span class=\"sy0\">:</span>,<span class=\"sy0\">:</span><span class=\"br0\">)</span><br/>            <span class=\"kw3\">integer</span>              <span class=\"sy0\">::</span> <span class=\"me2\">i</span>,n<br/>            <span class=\"kw3\">real</span>   , <span class=\"kw3\">allocatable</span> <span class=\"sy0\">::</span> <span class=\"me2\">x</span><span class=\"br0\">(</span><span class=\"sy0\">:</span><span class=\"br0\">)</span><br/>            n <span class=\"sy0\">=</span> <span class=\"kw4\">size</span><span class=\"br0\">(</span>u,<span class=\"nu0\">1</span><span class=\"br0\">)</span><br/>            <span class=\"kw1\">allocate</span><span class=\"br0\">(</span>x<span class=\"br0\">(</span>n<span class=\"br0\">)</span><span class=\"br0\">)</span><br/>            forall <span class=\"br0\">(</span>i<span class=\"sy0\">=</span>n<span class=\"sy0\">:</span><span class=\"nu0\">1</span><span class=\"sy0\">:-</span><span class=\"nu0\">1</span><span class=\"br0\">)</span> x<span class=\"br0\">(</span>i<span class=\"br0\">)</span> <span class=\"sy0\">=</span> <span class=\"br0\">(</span> u<span class=\"br0\">(</span>i,n<span class=\"sy0\">+</span><span class=\"nu0\">1</span><span class=\"br0\">)</span> <span class=\"sy0\">-</span> sum<span class=\"br0\">(</span>u<span class=\"br0\">(</span>i,i<span class=\"sy0\">+</span><span class=\"nu0\">1</span><span class=\"sy0\">:</span>n<span class=\"br0\">)</span><span class=\"sy0\">*</span>x<span class=\"br0\">(</span>i<span class=\"sy0\">+</span><span class=\"nu0\">1</span><span class=\"sy0\">:</span>n<span class=\"br0\">)</span><span class=\"br0\">)</span> <span class=\"br0\">)</span> <span class=\"sy0\">/</span> u<span class=\"br0\">(</span>i,i<span class=\"br0\">)</span><br/>          <span class=\"kw1\">end</span> <span class=\"kw1\">function</span><br/>\u00a0<br/>          <span class=\"kw1\">function</span>  ge_wpp<span class=\"br0\">(</span>a,b<span class=\"br0\">)</span> <span class=\"kw3\">result</span><span class=\"br0\">(</span>u<span class=\"br0\">)</span> <span class=\"co1\">! gaussian eliminate with partial pivoting</span><br/>            <span class=\"kw3\">real</span>                 <span class=\"sy0\">::</span> <span class=\"me2\">a</span><span class=\"br0\">(</span><span class=\"sy0\">:</span>,<span class=\"sy0\">:</span><span class=\"br0\">)</span>,b<span class=\"br0\">(</span><span class=\"sy0\">:</span><span class=\"br0\">)</span>,upi<br/>            <span class=\"kw3\">integer</span>              <span class=\"sy0\">::</span> <span class=\"me2\">i</span>,j,n,p<br/>            <span class=\"kw3\">real</span>   , <span class=\"kw3\">allocatable</span> <span class=\"sy0\">::</span> <span class=\"me2\">u</span><span class=\"br0\">(</span><span class=\"sy0\">:</span>,<span class=\"sy0\">:</span><span class=\"br0\">)</span><br/>            n <span class=\"sy0\">=</span> <span class=\"kw4\">size</span><span class=\"br0\">(</span>a,<span class=\"nu0\">1</span><span class=\"br0\">)</span><br/>            u <span class=\"sy0\">=</span> <span class=\"kw4\">reshape</span><span class=\"br0\">(</span> <span class=\"br0\">[</span>a,b<span class=\"br0\">]</span>, <span class=\"br0\">[</span>n,n<span class=\"sy0\">+</span><span class=\"nu0\">1</span><span class=\"br0\">]</span> <span class=\"br0\">)</span><br/>            <span class=\"kw1\">do</span> j<span class=\"sy0\">=</span><span class=\"nu0\">1</span>,n<br/>              p <span class=\"sy0\">=</span> <span class=\"kw4\">maxloc</span><span class=\"br0\">(</span><span class=\"kw4\">abs</span><span class=\"br0\">(</span>u<span class=\"br0\">(</span>j<span class=\"sy0\">:</span>n,j<span class=\"br0\">)</span><span class=\"br0\">)</span>,<span class=\"nu0\">1</span><span class=\"br0\">)</span> <span class=\"sy0\">+</span> j<span class=\"sy0\">-</span><span class=\"nu0\">1</span> <span class=\"co1\">! maxloc returns indices between (1,n-j+1)</span><br/>              <span class=\"kw1\">if</span> <span class=\"br0\">(</span>p <span class=\"sy0\">/=</span> j<span class=\"br0\">)</span> u<span class=\"br0\">(</span><span class=\"br0\">[</span>p,j<span class=\"br0\">]</span>,j<span class=\"br0\">)</span> <span class=\"sy0\">=</span> u<span class=\"br0\">(</span><span class=\"br0\">[</span>j,p<span class=\"br0\">]</span>,j<span class=\"br0\">)</span><br/>              u<span class=\"br0\">(</span>j<span class=\"sy0\">+</span><span class=\"nu0\">1</span><span class=\"sy0\">:</span>,j<span class=\"br0\">)</span> <span class=\"sy0\">=</span> u<span class=\"br0\">(</span>j<span class=\"sy0\">+</span><span class=\"nu0\">1</span><span class=\"sy0\">:</span>,j<span class=\"br0\">)</span><span class=\"sy0\">/</span>u<span class=\"br0\">(</span>j,j<span class=\"br0\">)</span><br/>              <span class=\"kw1\">do</span> i<span class=\"sy0\">=</span>j<span class=\"sy0\">+</span><span class=\"nu0\">1</span>,n<span class=\"sy0\">+</span><span class=\"nu0\">1</span><br/>                upi <span class=\"sy0\">=</span> u<span class=\"br0\">(</span>p,i<span class=\"br0\">)</span><br/>                <span class=\"kw1\">if</span> <span class=\"br0\">(</span>p <span class=\"sy0\">/=</span> j<span class=\"br0\">)</span> u<span class=\"br0\">(</span><span class=\"br0\">[</span>p,j<span class=\"br0\">]</span>,i<span class=\"br0\">)</span> <span class=\"sy0\">=</span> u<span class=\"br0\">(</span><span class=\"br0\">[</span>j,p<span class=\"br0\">]</span>,i<span class=\"br0\">)</span><br/>                u<span class=\"br0\">(</span>j<span class=\"sy0\">+</span><span class=\"nu0\">1</span><span class=\"sy0\">:</span>n,i<span class=\"br0\">)</span> <span class=\"sy0\">=</span> u<span class=\"br0\">(</span>j<span class=\"sy0\">+</span><span class=\"nu0\">1</span><span class=\"sy0\">:</span>n,i<span class=\"br0\">)</span> <span class=\"sy0\">-</span> upi<span class=\"sy0\">*</span>u<span class=\"br0\">(</span>j<span class=\"sy0\">+</span><span class=\"nu0\">1</span><span class=\"sy0\">:</span>n,j<span class=\"br0\">)</span><br/>              <span class=\"kw1\">end</span> <span class=\"kw1\">do</span><br/>            <span class=\"kw1\">end</span> <span class=\"kw1\">do</span><br/>          <span class=\"kw1\">end</span> <span class=\"kw1\">function</span><br/>\u00a0<br/>        <span class=\"kw1\">end</span> <span class=\"kw1\">program</span><br/>\u00a0</pre>"}, {"lang": "FreeBASIC", "loc": 64, "block": "<pre class=\"freebasic highlighted_source\">\u00a0<br/>\u00a0<br/><span class=\"kw1\">Sub</span> GaussJordan<span class=\"br0\">(</span>matrix<span class=\"br0\">(</span><span class=\"br0\">)</span> <span class=\"kw1\">As</span> <span class=\"kw1\">Double</span>,rhs<span class=\"br0\">(</span><span class=\"br0\">)</span> <span class=\"kw1\">As</span> <span class=\"kw1\">Double</span>,ans<span class=\"br0\">(</span><span class=\"br0\">)</span> <span class=\"kw1\">As</span> <span class=\"kw1\">Double</span><span class=\"br0\">)</span><br/>    <span class=\"kw1\">Dim</span> <span class=\"kw1\">As</span> <span class=\"kw1\">Long</span> n=<span class=\"kw1\">Ubound</span><span class=\"br0\">(</span>matrix,<span class=\"nu0\">1</span><span class=\"br0\">)</span><br/>    <span class=\"kw1\">Redim</span> ans<span class=\"br0\">(</span><span class=\"nu0\">0</span><span class=\"br0\">)</span>:<span class=\"kw1\">Redim</span> ans<span class=\"br0\">(</span><span class=\"nu0\">1</span> <span class=\"kw1\">To</span> n<span class=\"br0\">)</span><br/>    <span class=\"kw1\">Dim</span> <span class=\"kw1\">As</span> <span class=\"kw1\">Double</span> b<span class=\"br0\">(</span><span class=\"nu0\">1</span> <span class=\"kw1\">To</span> n,<span class=\"nu0\">1</span> <span class=\"kw1\">To</span> n<span class=\"br0\">)</span>,r<span class=\"br0\">(</span><span class=\"nu0\">1</span> <span class=\"kw1\">To</span> n<span class=\"br0\">)</span><br/>    <span class=\"kw1\">For</span> c <span class=\"kw1\">As</span> <span class=\"kw1\">Long</span>=<span class=\"nu0\">1</span> <span class=\"kw1\">To</span> n <span class=\"co1\">'take copies</span><br/>        r<span class=\"br0\">(</span>c<span class=\"br0\">)</span>=rhs<span class=\"br0\">(</span>c<span class=\"br0\">)</span><br/>        <span class=\"kw1\">For</span> d <span class=\"kw1\">As</span> <span class=\"kw1\">Long</span>=<span class=\"nu0\">1</span> <span class=\"kw1\">To</span> n<br/>            b<span class=\"br0\">(</span>c,d<span class=\"br0\">)</span>=matrix<span class=\"br0\">(</span>c,d<span class=\"br0\">)</span><br/>        <span class=\"kw1\">Next</span> d<br/>    <span class=\"kw1\">Next</span> c<br/>    <span class=\"co2\">#macro pivot(num)</span><br/>    <span class=\"kw1\">For</span> p1 <span class=\"kw1\">As</span> <span class=\"kw1\">Long</span>  = num <span class=\"kw1\">To</span> n - <span class=\"nu0\">1</span><br/>        <span class=\"kw1\">For</span> p2 <span class=\"kw1\">As</span> <span class=\"kw1\">Long</span>  = p1 + <span class=\"nu0\">1</span> <span class=\"kw1\">To</span> n  <br/>            <span class=\"kw1\">If</span> Abs<span class=\"br0\">(</span>b<span class=\"br0\">(</span>p1,num<span class=\"br0\">)</span><span class=\"br0\">)</span>&lt;Abs<span class=\"br0\">(</span>b<span class=\"br0\">(</span>p2,num<span class=\"br0\">)</span><span class=\"br0\">)</span> <span class=\"kw1\">Then</span><br/>                <span class=\"kw1\">Swap</span> r<span class=\"br0\">(</span>p1<span class=\"br0\">)</span>,r<span class=\"br0\">(</span>p2<span class=\"br0\">)</span><br/>                <span class=\"kw1\">For</span> g <span class=\"kw1\">As</span> <span class=\"kw1\">Long</span>=<span class=\"nu0\">1</span> <span class=\"kw1\">To</span> n<br/>                    <span class=\"kw1\">Swap</span> b<span class=\"br0\">(</span>p1,g<span class=\"br0\">)</span>,b<span class=\"br0\">(</span>p2,g<span class=\"br0\">)</span><br/>                <span class=\"kw1\">Next</span> g<br/>            <span class=\"kw1\">End</span> <span class=\"kw1\">If</span><br/>        <span class=\"kw1\">Next</span> p2<br/>    <span class=\"kw1\">Next</span> p1<br/>    <span class=\"co2\">#endmacro</span><br/>\u00a0<br/>    <span class=\"kw1\">For</span> k <span class=\"kw1\">As</span> <span class=\"kw1\">Long</span>=<span class=\"nu0\">1</span> <span class=\"kw1\">To</span> n-<span class=\"nu0\">1</span><br/>        pivot<span class=\"br0\">(</span>k<span class=\"br0\">)</span>              <span class=\"co1\">'full pivoting </span><br/>        <span class=\"kw1\">For</span> row <span class=\"kw1\">As</span> <span class=\"kw1\">Long</span> =k <span class=\"kw1\">To</span> n-<span class=\"nu0\">1</span><br/>            <span class=\"kw1\">If</span> b<span class=\"br0\">(</span>row+<span class=\"nu0\">1</span>,k<span class=\"br0\">)</span>=<span class=\"nu0\">0</span> <span class=\"kw1\">Then</span> <span class=\"kw1\">Exit</span> <span class=\"kw1\">For</span><br/>            Var f=b<span class=\"br0\">(</span>k,k<span class=\"br0\">)</span>/b<span class=\"br0\">(</span>row+<span class=\"nu0\">1</span>,k<span class=\"br0\">)</span><br/>            r<span class=\"br0\">(</span>row+<span class=\"nu0\">1</span><span class=\"br0\">)</span>=r<span class=\"br0\">(</span>row+<span class=\"nu0\">1</span><span class=\"br0\">)</span>*f-r<span class=\"br0\">(</span>k<span class=\"br0\">)</span><br/>            <span class=\"kw1\">For</span> g <span class=\"kw1\">As</span> <span class=\"kw1\">Long</span>=<span class=\"nu0\">1</span> <span class=\"kw1\">To</span> n<br/>                b<span class=\"br0\">(</span><span class=\"br0\">(</span>row+<span class=\"nu0\">1</span><span class=\"br0\">)</span>,g<span class=\"br0\">)</span>=b<span class=\"br0\">(</span><span class=\"br0\">(</span>row+<span class=\"nu0\">1</span><span class=\"br0\">)</span>,g<span class=\"br0\">)</span>*f-b<span class=\"br0\">(</span>k,g<span class=\"br0\">)</span><br/>            <span class=\"kw1\">Next</span> g<br/>        <span class=\"kw1\">Next</span> row<br/>    <span class=\"kw1\">Next</span> k<br/>    <span class=\"co1\">'back substitute </span><br/>    <span class=\"kw1\">For</span> z <span class=\"kw1\">As</span> <span class=\"kw1\">Long</span>=n <span class=\"kw1\">To</span> <span class=\"nu0\">1</span> <span class=\"kw1\">Step</span> -<span class=\"nu0\">1</span><br/>        ans<span class=\"br0\">(</span>z<span class=\"br0\">)</span>=r<span class=\"br0\">(</span>z<span class=\"br0\">)</span>/b<span class=\"br0\">(</span>z,z<span class=\"br0\">)</span><br/>        <span class=\"kw1\">For</span> j <span class=\"kw1\">As</span> <span class=\"kw1\">Long</span> = n <span class=\"kw1\">To</span> z+<span class=\"nu0\">1</span> <span class=\"kw1\">Step</span> -<span class=\"nu0\">1</span><br/>            ans<span class=\"br0\">(</span>z<span class=\"br0\">)</span>=ans<span class=\"br0\">(</span>z<span class=\"br0\">)</span>-<span class=\"br0\">(</span>b<span class=\"br0\">(</span>z,j<span class=\"br0\">)</span>*ans<span class=\"br0\">(</span>j<span class=\"br0\">)</span>/b<span class=\"br0\">(</span>z,z<span class=\"br0\">)</span><span class=\"br0\">)</span><br/>        <span class=\"kw1\">Next</span> j<br/>    <span class=\"kw1\">Next</span>    z<br/><span class=\"kw1\">End</span> <span class=\"kw1\">Sub</span><br/>\u00a0<br/><span class=\"kw1\">dim</span> <span class=\"kw1\">as</span> <span class=\"kw1\">double</span> a<span class=\"br0\">(</span><span class=\"nu0\">1</span> <span class=\"kw1\">to</span> <span class=\"nu0\">6</span>,<span class=\"nu0\">1</span> <span class=\"kw1\">to</span> <span class=\"nu0\">6</span><span class=\"br0\">)</span> = <span class=\"br0\">{</span> _<br/>\t\t                  <span class=\"br0\">{</span><span class=\"nu0\">1.00</span>, <span class=\"nu0\">0.00</span>, <span class=\"nu0\">0.00</span>,  <span class=\"nu0\">0.00</span>,  <span class=\"nu0\">0.00</span>, <span class=\"nu0\">0.00</span><span class=\"br0\">}</span>, _<br/>\t\t                  <span class=\"br0\">{</span><span class=\"nu0\">1.00</span>, <span class=\"nu0\">0.63</span>, <span class=\"nu0\">0.39</span>,  <span class=\"nu0\">0.25</span>,  <span class=\"nu0\">0.16</span>, <span class=\"nu0\">0.10</span><span class=\"br0\">}</span>, _<br/>\t\t                  <span class=\"br0\">{</span><span class=\"nu0\">1.00</span>, <span class=\"nu0\">1.26</span>, <span class=\"nu0\">1.58</span>,  <span class=\"nu0\">1.98</span>,  <span class=\"nu0\">2.49</span>, <span class=\"nu0\">3.13</span><span class=\"br0\">}</span>, _<br/>\t\t                  <span class=\"br0\">{</span><span class=\"nu0\">1.00</span>, <span class=\"nu0\">1.88</span>, <span class=\"nu0\">3.55</span>,  <span class=\"nu0\">6.70</span>, <span class=\"nu0\">12.62</span>, <span class=\"nu0\">23.80</span><span class=\"br0\">}</span>, _<br/>\t\t                  <span class=\"br0\">{</span><span class=\"nu0\">1.00</span>, <span class=\"nu0\">2.51</span>, <span class=\"nu0\">6.32</span>, <span class=\"nu0\">15.88</span>, <span class=\"nu0\">39.90</span>, <span class=\"nu0\">100.28</span><span class=\"br0\">}</span>, _<br/>\t\t                  <span class=\"br0\">{</span><span class=\"nu0\">1.00</span>, <span class=\"nu0\">3.14</span>, <span class=\"nu0\">9.87</span>, <span class=\"nu0\">31.01</span>, <span class=\"nu0\">97.41</span>, <span class=\"nu0\">306.02</span><span class=\"br0\">}</span> _<br/>\t                      <span class=\"br0\">}</span><br/>\u00a0<br/><span class=\"kw1\">dim</span> <span class=\"kw1\">as</span> <span class=\"kw1\">double</span> b<span class=\"br0\">(</span><span class=\"nu0\">1</span> <span class=\"kw1\">to</span> <span class=\"nu0\">6</span><span class=\"br0\">)</span> = <span class=\"br0\">{</span> -<span class=\"nu0\">0.01</span>, <span class=\"nu0\">0.61</span>, <span class=\"nu0\">0.91</span>, <span class=\"nu0\">0.99</span>, <span class=\"nu0\">0.60</span>, <span class=\"nu0\">0.02</span> <span class=\"br0\">}</span><br/>\u00a0<br/><span class=\"kw1\">redim</span> <span class=\"kw1\">as</span> <span class=\"kw1\">double</span> result<span class=\"br0\">(</span><span class=\"br0\">)</span> <br/>GaussJordan<span class=\"br0\">(</span>a<span class=\"br0\">(</span><span class=\"br0\">)</span>,b<span class=\"br0\">(</span><span class=\"br0\">)</span>,result<span class=\"br0\">(</span><span class=\"br0\">)</span><span class=\"br0\">)</span><br/>\u00a0<br/><span class=\"kw1\">for</span> n <span class=\"kw1\">as</span> <span class=\"kw1\">long</span>=<span class=\"kw1\">lbound</span><span class=\"br0\">(</span>result<span class=\"br0\">)</span> <span class=\"kw1\">to</span> <span class=\"kw1\">ubound</span><span class=\"br0\">(</span>result<span class=\"br0\">)</span><br/>    <span class=\"kw1\">print</span> result<span class=\"br0\">(</span>n<span class=\"br0\">)</span><br/><span class=\"kw1\">next</span> n<br/><span class=\"kw1\">sleep</span><br/>\u00a0</pre>"}, {"lang": "Go", "loc": 97, "block": "<pre class=\"go highlighted_source\"><span class=\"kw1\">package</span> main<br/>\u00a0<br/><span class=\"kw1\">import</span> <span class=\"sy1\">(</span><br/>    <span class=\"st0\">\"errors\"</span><br/>    <span class=\"st0\">\"fmt\"</span><br/>    <span class=\"st0\">\"log\"</span><br/>    <span class=\"st0\">\"math\"</span><br/><span class=\"sy1\">)</span><br/>\u00a0<br/><span class=\"kw1\">type</span> testCase <span class=\"kw4\">struct</span> <span class=\"sy1\">{</span><br/>    a <span class=\"sy1\">[][]</span><span class=\"kw4\">float64</span><br/>    b <span class=\"sy1\">[]</span><span class=\"kw4\">float64</span><br/>    x <span class=\"sy1\">[]</span><span class=\"kw4\">float64</span><br/><span class=\"sy1\">}</span><br/>\u00a0<br/><span class=\"kw1\">var</span> tc <span class=\"sy2\">=</span> testCase<span class=\"sy1\">{</span><br/>    <span class=\"co1\">// common RC example.  Result x computed with rational arithmetic then</span><br/>    <span class=\"co1\">// converted to float64, and so should be about as close to correct as</span><br/>    <span class=\"co1\">// float64 represention allows.</span><br/>    a<span class=\"sy1\">:</span> <span class=\"sy1\">[][]</span><span class=\"kw4\">float64</span><span class=\"sy1\">{</span><br/>        <span class=\"sy1\">{</span><span class=\"nu0\">1</span><span class=\"sy3\">.</span><span class=\"nu0\">00</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy3\">.</span><span class=\"nu0\">00</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy3\">.</span><span class=\"nu0\">00</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy3\">.</span><span class=\"nu0\">00</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy3\">.</span><span class=\"nu0\">00</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy3\">.</span><span class=\"nu0\">00</span><span class=\"sy1\">},</span><br/>        <span class=\"sy1\">{</span><span class=\"nu0\">1</span><span class=\"sy3\">.</span><span class=\"nu0\">00</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy3\">.</span><span class=\"nu0\">63</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy3\">.</span><span class=\"nu0\">39</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy3\">.</span><span class=\"nu0\">25</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy3\">.</span><span class=\"nu0\">16</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy3\">.</span><span class=\"nu0\">10</span><span class=\"sy1\">},</span><br/>        <span class=\"sy1\">{</span><span class=\"nu0\">1</span><span class=\"sy3\">.</span><span class=\"nu0\">00</span><span class=\"sy1\">,</span> <span class=\"nu0\">1</span><span class=\"sy3\">.</span><span class=\"nu0\">26</span><span class=\"sy1\">,</span> <span class=\"nu0\">1</span><span class=\"sy3\">.</span><span class=\"nu0\">58</span><span class=\"sy1\">,</span> <span class=\"nu0\">1</span><span class=\"sy3\">.</span><span class=\"nu0\">98</span><span class=\"sy1\">,</span> <span class=\"nu0\">2</span><span class=\"sy3\">.</span><span class=\"nu0\">49</span><span class=\"sy1\">,</span> <span class=\"nu0\">3</span><span class=\"sy3\">.</span><span class=\"nu0\">13</span><span class=\"sy1\">},</span><br/>        <span class=\"sy1\">{</span><span class=\"nu0\">1</span><span class=\"sy3\">.</span><span class=\"nu0\">00</span><span class=\"sy1\">,</span> <span class=\"nu0\">1</span><span class=\"sy3\">.</span><span class=\"nu0\">88</span><span class=\"sy1\">,</span> <span class=\"nu0\">3</span><span class=\"sy3\">.</span><span class=\"nu0\">55</span><span class=\"sy1\">,</span> <span class=\"nu0\">6</span><span class=\"sy3\">.</span><span class=\"nu0\">70</span><span class=\"sy1\">,</span> <span class=\"nu0\">12</span><span class=\"sy3\">.</span><span class=\"nu0\">62</span><span class=\"sy1\">,</span> <span class=\"nu0\">23</span><span class=\"sy3\">.</span><span class=\"nu0\">80</span><span class=\"sy1\">},</span><br/>        <span class=\"sy1\">{</span><span class=\"nu0\">1</span><span class=\"sy3\">.</span><span class=\"nu0\">00</span><span class=\"sy1\">,</span> <span class=\"nu0\">2</span><span class=\"sy3\">.</span><span class=\"nu0\">51</span><span class=\"sy1\">,</span> <span class=\"nu0\">6</span><span class=\"sy3\">.</span><span class=\"nu0\">32</span><span class=\"sy1\">,</span> <span class=\"nu0\">15</span><span class=\"sy3\">.</span><span class=\"nu0\">88</span><span class=\"sy1\">,</span> <span class=\"nu0\">39</span><span class=\"sy3\">.</span><span class=\"nu0\">90</span><span class=\"sy1\">,</span> <span class=\"nu0\">100</span><span class=\"sy3\">.</span><span class=\"nu0\">28</span><span class=\"sy1\">},</span><br/>        <span class=\"sy1\">{</span><span class=\"nu0\">1</span><span class=\"sy3\">.</span><span class=\"nu0\">00</span><span class=\"sy1\">,</span> <span class=\"nu0\">3</span><span class=\"sy3\">.</span><span class=\"nu0\">14</span><span class=\"sy1\">,</span> <span class=\"nu0\">9</span><span class=\"sy3\">.</span><span class=\"nu0\">87</span><span class=\"sy1\">,</span> <span class=\"nu0\">31</span><span class=\"sy3\">.</span><span class=\"nu0\">01</span><span class=\"sy1\">,</span> <span class=\"nu0\">97</span><span class=\"sy3\">.</span><span class=\"nu0\">41</span><span class=\"sy1\">,</span> <span class=\"nu0\">306</span><span class=\"sy3\">.</span><span class=\"nu0\">02</span><span class=\"sy1\">}},</span><br/>    b<span class=\"sy1\">:</span> <span class=\"sy1\">[]</span><span class=\"kw4\">float64</span><span class=\"sy1\">{</span><span class=\"sy3\">-</span><span class=\"nu0\">0</span><span class=\"sy3\">.</span><span class=\"nu0\">01</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy3\">.</span><span class=\"nu0\">61</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy3\">.</span><span class=\"nu0\">91</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy3\">.</span><span class=\"nu0\">99</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy3\">.</span><span class=\"nu0\">60</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy3\">.</span><span class=\"nu0\">02</span><span class=\"sy1\">},</span><br/>    x<span class=\"sy1\">:</span> <span class=\"sy1\">[]</span><span class=\"kw4\">float64</span><span class=\"sy1\">{</span><span class=\"sy3\">-</span><span class=\"nu0\">0</span><span class=\"sy3\">.</span><span class=\"nu0\">01</span><span class=\"sy1\">,</span> <span class=\"nu0\">1</span><span class=\"sy3\">.</span><span class=\"nu0\">602790394502114</span><span class=\"sy1\">,</span> <span class=\"sy3\">-</span><span class=\"nu0\">1</span><span class=\"sy3\">.</span><span class=\"nu0\">6132030599055613</span><span class=\"sy1\">,</span><br/>        <span class=\"nu0\">1</span><span class=\"sy3\">.</span><span class=\"nu0\">2454941213714368</span><span class=\"sy1\">,</span> <span class=\"sy3\">-</span><span class=\"nu0\">0</span><span class=\"sy3\">.</span><span class=\"nu0\">4909897195846576</span><span class=\"sy1\">,</span> <span class=\"nu0\">0</span><span class=\"sy3\">.</span>065760696175232<span class=\"sy1\">},</span><br/><span class=\"sy1\">}</span><br/>\u00a0<br/><span class=\"co1\">// result from above test case turns out to be correct to this tolerance.</span><br/><span class=\"kw1\">const</span> \u03b5 <span class=\"sy2\">=</span> 1e<span class=\"sy3\">-</span><span class=\"nu0\">13</span><br/>\u00a0<br/><span class=\"kw4\">func</span> main<span class=\"sy1\">()</span> <span class=\"sy1\">{</span><br/>    x<span class=\"sy1\">,</span> err <span class=\"sy2\">:=</span> GaussPartial<span class=\"sy1\">(</span>tc<span class=\"sy3\">.</span>a<span class=\"sy1\">,</span> tc<span class=\"sy3\">.</span>b<span class=\"sy1\">)</span><br/>    <span class=\"kw1\">if</span> err <span class=\"sy2\">!=</span> <span class=\"kw2\">nil</span> <span class=\"sy1\">{</span><br/>        log<span class=\"sy3\">.</span>Fatal<span class=\"sy1\">(</span>err<span class=\"sy1\">)</span><br/>    <span class=\"sy1\">}</span><br/>    fmt<span class=\"sy3\">.</span>Println<span class=\"sy1\">(</span>x<span class=\"sy1\">)</span><br/>    <span class=\"kw1\">for</span> <span class=\"nu2\">i</span><span class=\"sy1\">,</span> xi <span class=\"sy2\">:=</span> <span class=\"kw1\">range</span> x <span class=\"sy1\">{</span><br/>        <span class=\"kw1\">if</span> math<span class=\"sy3\">.</span>Abs<span class=\"sy1\">(</span>tc<span class=\"sy3\">.</span>x<span class=\"sy1\">[</span><span class=\"nu2\">i</span><span class=\"sy1\">]</span><span class=\"sy3\">-</span>xi<span class=\"sy1\">)</span> &gt; \u03b5 <span class=\"sy1\">{</span><br/>            log<span class=\"sy3\">.</span>Println<span class=\"sy1\">(</span><span class=\"st0\">\"out of tolerance\"</span><span class=\"sy1\">)</span><br/>            log<span class=\"sy3\">.</span><span class=\"me1\">Fatal</span><span class=\"sy1\">(</span><span class=\"st0\">\"expected\"</span><span class=\"sy1\">,</span> tc<span class=\"sy3\">.</span>x<span class=\"sy1\">)</span><br/>        <span class=\"sy1\">}</span><br/>    <span class=\"sy1\">}</span><br/><span class=\"sy1\">}</span><br/>\u00a0<br/><span class=\"kw4\">func</span> GaussPartial<span class=\"sy1\">(</span>a0 <span class=\"sy1\">[][]</span><span class=\"kw4\">float64</span><span class=\"sy1\">,</span> b0 <span class=\"sy1\">[]</span><span class=\"kw4\">float64</span><span class=\"sy1\">)</span> <span class=\"sy1\">([]</span><span class=\"kw4\">float64</span><span class=\"sy1\">,</span> error<span class=\"sy1\">)</span> <span class=\"sy1\">{</span><br/>    <span class=\"co1\">// make augmented matrix</span><br/>    m <span class=\"sy2\">:=</span> <span class=\"kw3\">len</span><span class=\"sy1\">(</span>b0<span class=\"sy1\">)</span><br/>    a <span class=\"sy2\">:=</span> <span class=\"kw3\">make</span><span class=\"sy1\">([][]</span><span class=\"kw4\">float64</span><span class=\"sy1\">,</span> m<span class=\"sy1\">)</span><br/>    <span class=\"kw1\">for</span> <span class=\"nu2\">i</span><span class=\"sy1\">,</span> ai <span class=\"sy2\">:=</span> <span class=\"kw1\">range</span> a0 <span class=\"sy1\">{</span><br/>        row <span class=\"sy2\">:=</span> <span class=\"kw3\">make</span><span class=\"sy1\">([]</span><span class=\"kw4\">float64</span><span class=\"sy1\">,</span> m<span class=\"sy3\">+</span><span class=\"nu0\">1</span><span class=\"sy1\">)</span><br/>        <span class=\"kw3\">copy</span><span class=\"sy1\">(</span>row<span class=\"sy1\">,</span> ai<span class=\"sy1\">)</span><br/>        row<span class=\"sy1\">[</span>m<span class=\"sy1\">]</span> <span class=\"sy2\">=</span> b0<span class=\"sy1\">[</span><span class=\"nu2\">i</span><span class=\"sy1\">]</span><br/>        a<span class=\"sy1\">[</span><span class=\"nu2\">i</span><span class=\"sy1\">]</span> <span class=\"sy2\">=</span> row<br/>    <span class=\"sy1\">}</span><br/>    <span class=\"co1\">// WP algorithm from Gaussian elimination page</span><br/>    <span class=\"co1\">// produces row-eschelon form</span><br/>    <span class=\"kw1\">for</span> k <span class=\"sy2\">:=</span> <span class=\"kw1\">range</span> a <span class=\"sy1\">{</span><br/>        <span class=\"co1\">// Find pivot for column k:</span><br/>        iMax <span class=\"sy2\">:=</span> k<br/>        max <span class=\"sy2\">:=</span> math<span class=\"sy3\">.</span>Abs<span class=\"sy1\">(</span>a<span class=\"sy1\">[</span>k<span class=\"sy1\">][</span>k<span class=\"sy1\">])</span><br/>        <span class=\"kw1\">for</span> <span class=\"nu2\">i</span> <span class=\"sy2\">:=</span> k <span class=\"sy3\">+</span> <span class=\"nu0\">1</span><span class=\"sy1\">;</span> <span class=\"nu2\">i</span> &lt; m<span class=\"sy1\">;</span> <span class=\"nu2\">i</span><span class=\"sy2\">++</span> <span class=\"sy1\">{</span><br/>            <span class=\"kw1\">if</span> abs <span class=\"sy2\">:=</span> math<span class=\"sy3\">.</span>Abs<span class=\"sy1\">(</span>a<span class=\"sy1\">[</span><span class=\"nu2\">i</span><span class=\"sy1\">][</span>k<span class=\"sy1\">]);</span> abs &gt; max <span class=\"sy1\">{</span><br/>                iMax <span class=\"sy2\">=</span> <span class=\"nu2\">i</span><br/>                max <span class=\"sy2\">=</span> abs<br/>            <span class=\"sy1\">}</span><br/>        <span class=\"sy1\">}</span><br/>        <span class=\"kw1\">if</span> a<span class=\"sy1\">[</span>iMax<span class=\"sy1\">][</span>k<span class=\"sy1\">]</span> <span class=\"sy3\">==</span> <span class=\"nu0\">0</span> <span class=\"sy1\">{</span><br/>            <span class=\"kw1\">return</span> <span class=\"kw2\">nil</span><span class=\"sy1\">,</span> errors<span class=\"sy3\">.</span>New<span class=\"sy1\">(</span><span class=\"st0\">\"singular\"</span><span class=\"sy1\">)</span><br/>        <span class=\"sy1\">}</span><br/>        <span class=\"co1\">// swap rows(k, i_max)</span><br/>        a<span class=\"sy1\">[</span>k<span class=\"sy1\">],</span> a<span class=\"sy1\">[</span>iMax<span class=\"sy1\">]</span> <span class=\"sy2\">=</span> a<span class=\"sy1\">[</span>iMax<span class=\"sy1\">],</span> a<span class=\"sy1\">[</span>k<span class=\"sy1\">]</span><br/>        <span class=\"co1\">// Do for all rows below pivot:</span><br/>        <span class=\"kw1\">for</span> <span class=\"nu2\">i</span> <span class=\"sy2\">:=</span> k <span class=\"sy3\">+</span> <span class=\"nu0\">1</span><span class=\"sy1\">;</span> <span class=\"nu2\">i</span> &lt; m<span class=\"sy1\">;</span> <span class=\"nu2\">i</span><span class=\"sy2\">++</span> <span class=\"sy1\">{</span><br/>            <span class=\"co1\">// Do for all remaining elements in current row:</span><br/>            <span class=\"kw1\">for</span> j <span class=\"sy2\">:=</span> k <span class=\"sy3\">+</span> <span class=\"nu0\">1</span><span class=\"sy1\">;</span> j &lt;<span class=\"sy2\">=</span> m<span class=\"sy1\">;</span> j<span class=\"sy2\">++</span> <span class=\"sy1\">{</span><br/>                a<span class=\"sy1\">[</span><span class=\"nu2\">i</span><span class=\"sy1\">][</span>j<span class=\"sy1\">]</span> <span class=\"sy2\">-=</span> a<span class=\"sy1\">[</span>k<span class=\"sy1\">][</span>j<span class=\"sy1\">]</span> <span class=\"sy3\">*</span> <span class=\"sy1\">(</span>a<span class=\"sy1\">[</span><span class=\"nu2\">i</span><span class=\"sy1\">][</span>k<span class=\"sy1\">]</span> <span class=\"sy3\">/</span> a<span class=\"sy1\">[</span>k<span class=\"sy1\">][</span>k<span class=\"sy1\">])</span><br/>            <span class=\"sy1\">}</span><br/>            <span class=\"co1\">// Fill lower triangular matrix with zeros:</span><br/>            a<span class=\"sy1\">[</span><span class=\"nu2\">i</span><span class=\"sy1\">][</span>k<span class=\"sy1\">]</span> <span class=\"sy2\">=</span> <span class=\"nu0\">0</span><br/>        <span class=\"sy1\">}</span><br/>    <span class=\"sy1\">}</span><br/>    <span class=\"co1\">// end of WP algorithm.</span><br/>    <span class=\"co1\">// now back substitute to get result.</span><br/>    x <span class=\"sy2\">:=</span> <span class=\"kw3\">make</span><span class=\"sy1\">([]</span><span class=\"kw4\">float64</span><span class=\"sy1\">,</span> m<span class=\"sy1\">)</span><br/>    <span class=\"kw1\">for</span> <span class=\"nu2\">i</span> <span class=\"sy2\">:=</span> m <span class=\"sy3\">-</span> <span class=\"nu0\">1</span><span class=\"sy1\">;</span> <span class=\"nu2\">i</span> &gt;<span class=\"sy2\">=</span> <span class=\"nu0\">0</span><span class=\"sy1\">;</span> <span class=\"nu2\">i</span><span class=\"sy2\">--</span> <span class=\"sy1\">{</span><br/>        x<span class=\"sy1\">[</span><span class=\"nu2\">i</span><span class=\"sy1\">]</span> <span class=\"sy2\">=</span> a<span class=\"sy1\">[</span><span class=\"nu2\">i</span><span class=\"sy1\">][</span>m<span class=\"sy1\">]</span><br/>        <span class=\"kw1\">for</span> j <span class=\"sy2\">:=</span> <span class=\"nu2\">i</span> <span class=\"sy3\">+</span> <span class=\"nu0\">1</span><span class=\"sy1\">;</span> j &lt; m<span class=\"sy1\">;</span> j<span class=\"sy2\">++</span> <span class=\"sy1\">{</span><br/>            x<span class=\"sy1\">[</span><span class=\"nu2\">i</span><span class=\"sy1\">]</span> <span class=\"sy2\">-=</span> a<span class=\"sy1\">[</span><span class=\"nu2\">i</span><span class=\"sy1\">][</span>j<span class=\"sy1\">]</span> <span class=\"sy3\">*</span> x<span class=\"sy1\">[</span>j<span class=\"sy1\">]</span><br/>        <span class=\"sy1\">}</span><br/>        x<span class=\"sy1\">[</span><span class=\"nu2\">i</span><span class=\"sy1\">]</span> <span class=\"sy2\">/=</span> a<span class=\"sy1\">[</span><span class=\"nu2\">i</span><span class=\"sy1\">][</span><span class=\"nu2\">i</span><span class=\"sy1\">]</span><br/>    <span class=\"sy1\">}</span><br/>    <span class=\"kw1\">return</span> x<span class=\"sy1\">,</span> <span class=\"kw2\">nil</span><br/><span class=\"sy1\">}</span></pre>"}, {"lang": "Haskell", "loc": 112, "block": "<pre class=\"haskell highlighted_source\">\u00a0<br/>foldlZipWith<span class=\"sy0\">::</span><span class=\"br0\">(</span>a <span class=\"sy0\">-&gt;</span> b <span class=\"sy0\">-&gt;</span> c<span class=\"br0\">)</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">(</span>d <span class=\"sy0\">-&gt;</span> c <span class=\"sy0\">-&gt;</span> d<span class=\"br0\">)</span> <span class=\"sy0\">-&gt;</span> d <span class=\"sy0\">-&gt;</span> <span class=\"br0\">[</span>a<span class=\"br0\">]</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">[</span>b<span class=\"br0\">]</span>  <span class=\"sy0\">-&gt;</span> d<br/>foldlZipWith <span class=\"sy0\">_</span> <span class=\"sy0\">_</span> u <span class=\"br0\">[</span><span class=\"br0\">]</span> <span class=\"sy0\">_</span>          <span class=\"sy0\">=</span> u<br/>foldlZipWith <span class=\"sy0\">_</span> <span class=\"sy0\">_</span> u <span class=\"sy0\">_</span> <span class=\"br0\">[</span><span class=\"br0\">]</span>          <span class=\"sy0\">=</span> u<br/>foldlZipWith f g u <span class=\"br0\">(</span>x:xs<span class=\"br0\">)</span> <span class=\"br0\">(</span>y:ys<span class=\"br0\">)</span> <span class=\"sy0\">=</span> foldlZipWith f g <span class=\"br0\">(</span>g u <span class=\"br0\">(</span>f x y<span class=\"br0\">)</span><span class=\"br0\">)</span> xs ys<br/>\u00a0<br/>foldl1ZipWith<span class=\"sy0\">::</span><span class=\"br0\">(</span>a <span class=\"sy0\">-&gt;</span> b <span class=\"sy0\">-&gt;</span> c<span class=\"br0\">)</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">(</span>c <span class=\"sy0\">-&gt;</span> c <span class=\"sy0\">-&gt;</span> c<span class=\"br0\">)</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">[</span>a<span class=\"br0\">]</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">[</span>b<span class=\"br0\">]</span> <span class=\"sy0\">-&gt;</span> c<br/>foldl1ZipWith <span class=\"sy0\">_</span> <span class=\"sy0\">_</span> <span class=\"br0\">[</span><span class=\"br0\">]</span> <span class=\"sy0\">_</span>          <span class=\"sy0\">=</span> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:error\"><span class=\"kw3\">error</span></a> <span class=\"st0\">\"First list is empty\"</span><br/>foldl1ZipWith <span class=\"sy0\">_</span> <span class=\"sy0\">_</span> <span class=\"sy0\">_</span> <span class=\"br0\">[</span><span class=\"br0\">]</span>          <span class=\"sy0\">=</span> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:error\"><span class=\"kw3\">error</span></a> <span class=\"st0\">\"Second list is empty\"</span><br/>foldl1ZipWith f g <span class=\"br0\">(</span>x:xs<span class=\"br0\">)</span> <span class=\"br0\">(</span>y:ys<span class=\"br0\">)</span> <span class=\"sy0\">=</span> foldlZipWith f g <span class=\"br0\">(</span>f x y<span class=\"br0\">)</span> xs ys<br/>\u00a0<br/>multAdd<span class=\"sy0\">::</span><span class=\"br0\">(</span>a <span class=\"sy0\">-&gt;</span> b <span class=\"sy0\">-&gt;</span> c<span class=\"br0\">)</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">(</span>c <span class=\"sy0\">-&gt;</span> c <span class=\"sy0\">-&gt;</span> c<span class=\"br0\">)</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">[</span><span class=\"br0\">[</span>a<span class=\"br0\">]</span><span class=\"br0\">]</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">[</span><span class=\"br0\">[</span>b<span class=\"br0\">]</span><span class=\"br0\">]</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">[</span><span class=\"br0\">[</span>c<span class=\"br0\">]</span><span class=\"br0\">]</span><br/>multAdd f g xs ys <span class=\"sy0\">=</span> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:map\"><span class=\"kw3\">map</span></a> <span class=\"br0\">(</span>\\us <span class=\"sy0\">-&gt;</span> foldl1ZipWith <span class=\"br0\">(</span>\\u vs <span class=\"sy0\">-&gt;</span> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:map\"><span class=\"kw3\">map</span></a> <span class=\"br0\">(</span>f u<span class=\"br0\">)</span> vs<span class=\"br0\">)</span> <span class=\"br0\">(</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:zipWith\"><span class=\"kw3\">zipWith</span></a> g<span class=\"br0\">)</span> us ys<span class=\"br0\">)</span> xs<br/>\u00a0<br/>mult<span class=\"sy0\">::</span> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Num\"><span class=\"kw4\">Num</span></a> a <span class=\"sy0\">=&gt;</span> <span class=\"br0\">[</span><span class=\"br0\">[</span>a<span class=\"br0\">]</span><span class=\"br0\">]</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">[</span><span class=\"br0\">[</span>a<span class=\"br0\">]</span><span class=\"br0\">]</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">[</span><span class=\"br0\">[</span>a<span class=\"br0\">]</span><span class=\"br0\">]</span><br/>mult xs ys <span class=\"sy0\">=</span> multAdd <span class=\"br0\">(</span><span class=\"sy0\">*</span><span class=\"br0\">)</span> <span class=\"br0\">(</span><span class=\"sy0\">+</span><span class=\"br0\">)</span> xs ys<br/>\u00a0<br/>bubble<span class=\"sy0\">::</span><span class=\"br0\">(</span><span class=\"br0\">[</span>a<span class=\"br0\">]</span> <span class=\"sy0\">-&gt;</span> c<span class=\"br0\">)</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">(</span>c <span class=\"sy0\">-&gt;</span> c <span class=\"sy0\">-&gt;</span> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Bool\"><span class=\"kw4\">Bool</span></a><span class=\"br0\">)</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">[</span><span class=\"br0\">[</span>a<span class=\"br0\">]</span><span class=\"br0\">]</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">[</span><span class=\"br0\">[</span>b<span class=\"br0\">]</span><span class=\"br0\">]</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">(</span><span class=\"br0\">[</span><span class=\"br0\">[</span>a<span class=\"br0\">]</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><span class=\"br0\">[</span><span class=\"br0\">[</span>b<span class=\"br0\">]</span><span class=\"br0\">]</span><span class=\"br0\">)</span><br/>bubble <span class=\"sy0\">_</span> <span class=\"sy0\">_</span> <span class=\"br0\">[</span><span class=\"br0\">]</span> ts         <span class=\"sy0\">=</span> <span class=\"br0\">(</span><span class=\"br0\">[</span><span class=\"br0\">]</span><span class=\"sy0\">,</span>ts<span class=\"br0\">)</span><br/>bubble <span class=\"sy0\">_</span> <span class=\"sy0\">_</span> rs <span class=\"br0\">[</span><span class=\"br0\">]</span>         <span class=\"sy0\">=</span> <span class=\"br0\">(</span>rs<span class=\"sy0\">,</span><span class=\"br0\">[</span><span class=\"br0\">]</span><span class=\"br0\">)</span><br/>bubble f g <span class=\"br0\">(</span>r:rs<span class=\"br0\">)</span> <span class=\"br0\">(</span>t:ts<span class=\"br0\">)</span> <span class=\"sy0\">=</span> bub r t <span class=\"br0\">(</span>f r<span class=\"br0\">)</span> rs ts <span class=\"br0\">[</span><span class=\"br0\">]</span> <span class=\"br0\">[</span><span class=\"br0\">]</span><br/>  <span class=\"kw1\">where</span><br/>  bub l k <span class=\"sy0\">_</span> <span class=\"br0\">[</span><span class=\"br0\">]</span> <span class=\"sy0\">_</span> xs ys          <span class=\"sy0\">=</span> <span class=\"br0\">(</span>l:xs<span class=\"sy0\">,</span>k:ys<span class=\"br0\">)</span><br/>  bub l k <span class=\"sy0\">_</span> <span class=\"sy0\">_</span> <span class=\"br0\">[</span><span class=\"br0\">]</span> xs ys          <span class=\"sy0\">=</span> <span class=\"br0\">(</span>l:xs<span class=\"sy0\">,</span>k:ys<span class=\"br0\">)</span><br/>  bub l k m <span class=\"br0\">(</span>u:us<span class=\"br0\">)</span> <span class=\"br0\">(</span>v:vs<span class=\"br0\">)</span> xs ys <span class=\"sy0\">=</span> ans<br/>    <span class=\"kw1\">where</span> <br/>    mu <span class=\"sy0\">=</span> f u<br/>    ans <span class=\"sy0\">|</span> g m mu    <span class=\"sy0\">=</span> bub l k m us vs <span class=\"br0\">(</span>u:xs<span class=\"br0\">)</span> <span class=\"br0\">(</span>v:ys<span class=\"br0\">)</span><br/>        <span class=\"sy0\">|</span> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:otherwise\"><span class=\"kw3\">otherwise</span></a> <span class=\"sy0\">=</span> bub u v mu us vs <span class=\"br0\">(</span>l:xs<span class=\"br0\">)</span> <span class=\"br0\">(</span>k:ys<span class=\"br0\">)</span><br/>\u00a0<br/>pivot<span class=\"sy0\">::</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Num\"><span class=\"kw4\">Num</span></a> a <span class=\"sy0\">=&gt;</span> <span class=\"br0\">[</span>a<span class=\"br0\">]</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">[</span>a<span class=\"br0\">]</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">[</span><span class=\"br0\">[</span>a<span class=\"br0\">]</span><span class=\"br0\">]</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">[</span><span class=\"br0\">[</span>a<span class=\"br0\">]</span><span class=\"br0\">]</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">(</span><span class=\"br0\">[</span><span class=\"br0\">[</span>a<span class=\"br0\">]</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><span class=\"br0\">[</span><span class=\"br0\">[</span>a<span class=\"br0\">]</span><span class=\"br0\">]</span><span class=\"br0\">)</span><br/>pivot xs ks ys ls <span class=\"sy0\">=</span> go ys ls <span class=\"br0\">[</span><span class=\"br0\">]</span> <span class=\"br0\">[</span><span class=\"br0\">]</span><br/>  <span class=\"kw1\">where</span><br/>  x              <span class=\"sy0\">=</span> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:head\"><span class=\"kw3\">head</span></a> xs<br/>  fun r          <span class=\"sy0\">=</span> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:zipWith\"><span class=\"kw3\">zipWith</span></a> <span class=\"br0\">(</span>\\u v <span class=\"sy0\">-&gt;</span>  u<span class=\"sy0\">*</span>r <span class=\"sy0\">-</span> v<span class=\"sy0\">*</span>x<span class=\"br0\">)</span><br/>  val rs ts      <span class=\"sy0\">=</span> <span class=\"kw1\">let</span> f <span class=\"sy0\">=</span> fun <span class=\"br0\">(</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:head\"><span class=\"kw3\">head</span></a> rs<span class=\"br0\">)</span> <span class=\"kw1\">in</span> <span class=\"br0\">(</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:tail\"><span class=\"kw3\">tail</span></a> <span class=\"sy0\">$</span> f xs rs<span class=\"sy0\">,</span>f ks ts<span class=\"br0\">)</span><br/>  go <span class=\"br0\">[</span><span class=\"br0\">]</span> <span class=\"sy0\">_</span> us vs  <span class=\"sy0\">=</span> <span class=\"br0\">(</span>us<span class=\"sy0\">,</span>vs<span class=\"br0\">)</span><br/>  go <span class=\"sy0\">_</span> <span class=\"br0\">[</span><span class=\"br0\">]</span> us vs  <span class=\"sy0\">=</span> <span class=\"br0\">(</span>us<span class=\"sy0\">,</span>vs<span class=\"br0\">)</span><br/>  go rs ts us vs <span class=\"sy0\">=</span> go <span class=\"br0\">(</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:tail\"><span class=\"kw3\">tail</span></a> rs<span class=\"br0\">)</span> <span class=\"br0\">(</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:tail\"><span class=\"kw3\">tail</span></a> ts<span class=\"br0\">)</span> <span class=\"br0\">(</span>es:us<span class=\"br0\">)</span> <span class=\"br0\">(</span>fs:vs<span class=\"br0\">)</span><br/>    <span class=\"kw1\">where</span> <span class=\"br0\">(</span>es<span class=\"sy0\">,</span>fs<span class=\"br0\">)</span> <span class=\"sy0\">=</span> val <span class=\"br0\">(</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:head\"><span class=\"kw3\">head</span></a> rs<span class=\"br0\">)</span> <span class=\"br0\">(</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:head\"><span class=\"kw3\">head</span></a> ts<span class=\"br0\">)</span><br/>\u00a0<br/>triangle<span class=\"sy0\">::</span><span class=\"br0\">(</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Num\"><span class=\"kw4\">Num</span></a> a<span class=\"sy0\">,</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Ord\"><span class=\"kw4\">Ord</span></a> a<span class=\"br0\">)</span> <span class=\"sy0\">=&gt;</span> <span class=\"br0\">[</span><span class=\"br0\">[</span>a<span class=\"br0\">]</span><span class=\"br0\">]</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">[</span><span class=\"br0\">[</span>a<span class=\"br0\">]</span><span class=\"br0\">]</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">(</span><span class=\"br0\">[</span><span class=\"br0\">[</span>a<span class=\"br0\">]</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><span class=\"br0\">[</span><span class=\"br0\">[</span>a<span class=\"br0\">]</span><span class=\"br0\">]</span><span class=\"br0\">)</span><br/>triangle <span class=\"kw1\">as</span> bs <span class=\"sy0\">=</span> go <span class=\"br0\">(</span><span class=\"kw1\">as</span><span class=\"sy0\">,</span>bs<span class=\"br0\">)</span> <span class=\"br0\">[</span><span class=\"br0\">]</span> <span class=\"br0\">[</span><span class=\"br0\">]</span><br/>  <span class=\"kw1\">where</span><br/>  go <span class=\"br0\">(</span><span class=\"br0\">[</span><span class=\"br0\">]</span><span class=\"sy0\">,_</span><span class=\"br0\">)</span> us vs  <span class=\"sy0\">=</span> <span class=\"br0\">(</span>us<span class=\"sy0\">,</span>vs<span class=\"br0\">)</span><br/>  go <span class=\"br0\">(</span><span class=\"sy0\">_,</span><span class=\"br0\">[</span><span class=\"br0\">]</span><span class=\"br0\">)</span> us vs  <span class=\"sy0\">=</span> <span class=\"br0\">(</span>us<span class=\"sy0\">,</span>vs<span class=\"br0\">)</span><br/>  go <span class=\"br0\">(</span>rs<span class=\"sy0\">,</span>ts<span class=\"br0\">)</span> us vs <span class=\"sy0\">=</span> ans<br/>    <span class=\"kw1\">where</span><br/>    <span class=\"br0\">(</span>xs:ys<span class=\"sy0\">,</span>ks:ls<span class=\"br0\">)</span> <span class=\"sy0\">=</span> bubble <span class=\"br0\">(</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:abs\"><span class=\"kw3\">abs</span></a><span class=\"sy0\">.</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:head\"><span class=\"kw3\">head</span></a><span class=\"br0\">)</span> <span class=\"br0\">(</span><span class=\"sy0\">&gt;=</span><span class=\"br0\">)</span> rs ts<br/>    ans <span class=\"sy0\">=</span> go <span class=\"br0\">(</span>pivot xs ks ys ls<span class=\"br0\">)</span> <span class=\"br0\">(</span>xs:us<span class=\"br0\">)</span> <span class=\"br0\">(</span>ks:vs<span class=\"br0\">)</span><br/>\u00a0<br/>solveTriangle<span class=\"sy0\">::</span><span class=\"br0\">(</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Fractional\"><span class=\"kw4\">Fractional</span></a> a<span class=\"sy0\">,</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Eq\"><span class=\"kw4\">Eq</span></a> a<span class=\"br0\">)</span> <span class=\"sy0\">=&gt;</span> <span class=\"br0\">[</span><span class=\"br0\">[</span>a<span class=\"br0\">]</span><span class=\"br0\">]</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">[</span><span class=\"br0\">[</span>a<span class=\"br0\">]</span><span class=\"br0\">]</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">[</span><span class=\"br0\">[</span>a<span class=\"br0\">]</span><span class=\"br0\">]</span><br/>solveTriangle <span class=\"br0\">[</span><span class=\"br0\">]</span> <span class=\"sy0\">_</span> <span class=\"sy0\">=</span> <span class=\"br0\">[</span><span class=\"br0\">]</span><br/>solveTriangle <span class=\"sy0\">_</span> <span class=\"br0\">[</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"br0\">[</span><span class=\"br0\">]</span><br/>solveTriangle <span class=\"kw1\">as</span> <span class=\"sy0\">_</span> <span class=\"sy0\">|</span> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:not\"><span class=\"kw3\">not</span></a><span class=\"sy0\">.</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:null\"><span class=\"kw3\">null</span></a><span class=\"sy0\">.</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:dropWhile\"><span class=\"kw3\">dropWhile</span></a> <span class=\"br0\">(</span><span class=\"br0\">(</span><span class=\"sy0\">/=</span> <span class=\"nu0\">0</span><span class=\"br0\">)</span><span class=\"sy0\">.</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:head\"><span class=\"kw3\">head</span></a><span class=\"br0\">)</span> <span class=\"sy0\">$</span> <span class=\"kw1\">as</span> <span class=\"sy0\">=</span> <span class=\"br0\">[</span><span class=\"br0\">]</span><br/>solveTriangle <span class=\"br0\">(</span><span class=\"br0\">[</span>c<span class=\"br0\">]</span>:<span class=\"kw1\">as</span><span class=\"br0\">)</span> <span class=\"br0\">(</span>b:bs<span class=\"br0\">)</span> <span class=\"sy0\">=</span> go <span class=\"kw1\">as</span> bs <span class=\"br0\">[</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:map\"><span class=\"kw3\">map</span></a> <span class=\"br0\">(</span><span class=\"sy0\">/</span>c<span class=\"br0\">)</span> b<span class=\"br0\">]</span><br/>  <span class=\"kw1\">where</span><br/>  val us vs ws <span class=\"sy0\">=</span> <span class=\"kw1\">let</span> u <span class=\"sy0\">=</span> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:head\"><span class=\"kw3\">head</span></a> us <span class=\"kw1\">in</span> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:map\"><span class=\"kw3\">map</span></a> <span class=\"br0\">(</span><span class=\"sy0\">/</span>u<span class=\"br0\">)</span> <span class=\"sy0\">$</span> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:zipWith\"><span class=\"kw3\">zipWith</span></a> <span class=\"br0\">(</span><span class=\"sy0\">-</span><span class=\"br0\">)</span> vs <span class=\"br0\">(</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:head\"><span class=\"kw3\">head</span></a> <span class=\"sy0\">$</span> mult <span class=\"br0\">[</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:tail\"><span class=\"kw3\">tail</span></a> us<span class=\"br0\">]</span> ws<span class=\"br0\">)</span><br/>  go <span class=\"br0\">[</span><span class=\"br0\">]</span> <span class=\"sy0\">_</span> zs          <span class=\"sy0\">=</span> zs<br/>  go <span class=\"sy0\">_</span> <span class=\"br0\">[</span><span class=\"br0\">]</span> zs          <span class=\"sy0\">=</span> zs<br/>  go <span class=\"br0\">(</span>x:xs<span class=\"br0\">)</span> <span class=\"br0\">(</span>y:ys<span class=\"br0\">)</span> zs <span class=\"sy0\">=</span> go xs ys <span class=\"sy0\">$</span> <span class=\"br0\">(</span>val x y zs<span class=\"br0\">)</span>:zs<br/>\u00a0<br/>solveGauss<span class=\"sy0\">::</span> <span class=\"br0\">(</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Fractional\"><span class=\"kw4\">Fractional</span></a> a<span class=\"sy0\">,</span> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Ord\"><span class=\"kw4\">Ord</span></a> a<span class=\"br0\">)</span> <span class=\"sy0\">=&gt;</span> <span class=\"br0\">[</span><span class=\"br0\">[</span>a<span class=\"br0\">]</span><span class=\"br0\">]</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">[</span><span class=\"br0\">[</span>a<span class=\"br0\">]</span><span class=\"br0\">]</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">[</span><span class=\"br0\">[</span>a<span class=\"br0\">]</span><span class=\"br0\">]</span><br/>solveGauss <span class=\"kw1\">as</span> bs <span class=\"sy0\">=</span> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:uncurry\"><span class=\"kw3\">uncurry</span></a> solveTriangle <span class=\"sy0\">$</span> triangle <span class=\"kw1\">as</span> bs<br/>\u00a0<br/>matI<span class=\"sy0\">::</span><span class=\"br0\">(</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Num\"><span class=\"kw4\">Num</span></a> a<span class=\"br0\">)</span> <span class=\"sy0\">=&gt;</span> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Int\"><span class=\"kw4\">Int</span></a> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">[</span><span class=\"br0\">[</span>a<span class=\"br0\">]</span><span class=\"br0\">]</span><br/>matI n <span class=\"sy0\">=</span> <span class=\"br0\">[</span> <span class=\"br0\">[</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:fromIntegral\"><span class=\"kw3\">fromIntegral</span></a><span class=\"sy0\">.</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:fromEnum\"><span class=\"kw3\">fromEnum</span></a> <span class=\"sy0\">$</span> i <span class=\"sy0\">==</span> j <span class=\"sy0\">|</span> j <span class=\"sy0\">&lt;-</span> <span class=\"br0\">[</span><span class=\"nu0\">1</span><span class=\"sy0\">..</span>n<span class=\"br0\">]</span><span class=\"br0\">]</span> <span class=\"sy0\">|</span> i <span class=\"sy0\">&lt;-</span> <span class=\"br0\">[</span><span class=\"nu0\">1</span><span class=\"sy0\">..</span>n<span class=\"br0\">]</span><span class=\"br0\">]</span><br/>\u00a0<br/>task<span class=\"sy0\">::</span><span class=\"br0\">[</span><span class=\"br0\">[</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Rational\"><span class=\"kw4\">Rational</span></a><span class=\"br0\">]</span><span class=\"br0\">]</span> <span class=\"sy0\">-&gt;</span> <span class=\"br0\">[</span><span class=\"br0\">[</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Rational\"><span class=\"kw4\">Rational</span></a><span class=\"br0\">]</span><span class=\"br0\">]</span> <span class=\"sy0\">-&gt;</span> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:IO\"><span class=\"kw4\">IO</span></a><span class=\"br0\">(</span><span class=\"br0\">)</span><br/>task a b <span class=\"sy0\">=</span> <span class=\"kw1\">do</span><br/>  <span class=\"kw1\">let</span> x         <span class=\"sy0\">=</span> solveGauss a b<br/>  <span class=\"kw1\">let</span> u         <span class=\"sy0\">=</span> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:map\"><span class=\"kw3\">map</span></a> <span class=\"br0\">(</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:map\"><span class=\"kw3\">map</span></a> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:fromRational\"><span class=\"kw3\">fromRational</span></a><span class=\"br0\">)</span> x<br/>  <span class=\"kw1\">let</span> y         <span class=\"sy0\">=</span> mult a x<br/>  <span class=\"kw1\">let</span> identity  <span class=\"sy0\">=</span> matI <span class=\"br0\">(</span><a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:length\"><span class=\"kw3\">length</span></a> x<span class=\"br0\">)</span><br/>  <span class=\"kw1\">let</span> a1        <span class=\"sy0\">=</span> solveGauss a identity<br/>  <span class=\"kw1\">let</span> h         <span class=\"sy0\">=</span> mult a a1<br/>  <span class=\"kw1\">let</span> z         <span class=\"sy0\">=</span> mult a1 b<br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:putStrLn\"><span class=\"kw3\">putStrLn</span></a> <span class=\"st0\">\"a =\"</span><br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:mapM_\"><span class=\"kw3\">mapM_</span></a> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:print\"><span class=\"kw3\">print</span></a> a<br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:putStrLn\"><span class=\"kw3\">putStrLn</span></a> <span class=\"st0\">\"b =\"</span><br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:mapM_\"><span class=\"kw3\">mapM_</span></a> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:print\"><span class=\"kw3\">print</span></a> b<br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:putStrLn\"><span class=\"kw3\">putStrLn</span></a> <span class=\"st0\">\"solve: a * x = b =&gt; x = solveGauss a b =\"</span><br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:mapM_\"><span class=\"kw3\">mapM_</span></a> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:print\"><span class=\"kw3\">print</span></a> x<br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:putStrLn\"><span class=\"kw3\">putStrLn</span></a> <span class=\"st0\">\"u = fromRationaltoDouble x =\"</span><br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:mapM_\"><span class=\"kw3\">mapM_</span></a> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:print\"><span class=\"kw3\">print</span></a> u<br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:putStrLn\"><span class=\"kw3\">putStrLn</span></a> <span class=\"st0\">\"verification: y = a * x = mult a x =\"</span><br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:mapM_\"><span class=\"kw3\">mapM_</span></a> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:print\"><span class=\"kw3\">print</span></a> y<br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:putStrLn\"><span class=\"kw3\">putStrLn</span></a> <span class=\"sy0\">$</span> <span class=\"st0\">\"test: y == b = \"</span><br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:print\"><span class=\"kw3\">print</span></a> <span class=\"sy0\">$</span> y <span class=\"sy0\">==</span> b<br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:putStrLn\"><span class=\"kw3\">putStrLn</span></a> <span class=\"st0\">\"identity matrix: identity =\"</span><br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:mapM_\"><span class=\"kw3\">mapM_</span></a> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:print\"><span class=\"kw3\">print</span></a> identity<br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:putStrLn\"><span class=\"kw3\">putStrLn</span></a> <span class=\"st0\">\"find: a1 = inv(a) =&gt; solve: a * a1 = identity =&gt; a1 = solveGauss a identity =\"</span><br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:mapM_\"><span class=\"kw3\">mapM_</span></a> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:print\"><span class=\"kw3\">print</span></a> a1<br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:putStrLn\"><span class=\"kw3\">putStrLn</span></a> <span class=\"st0\">\"verification: h = a * a1 = mult a a1 =\"</span><br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:mapM_\"><span class=\"kw3\">mapM_</span></a> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:print\"><span class=\"kw3\">print</span></a> h<br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:putStrLn\"><span class=\"kw3\">putStrLn</span></a> <span class=\"sy0\">$</span> <span class=\"st0\">\"test: h == identity = \"</span><br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:print\"><span class=\"kw3\">print</span></a> <span class=\"sy0\">$</span> h <span class=\"sy0\">==</span> identity<br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:putStrLn\"><span class=\"kw3\">putStrLn</span></a> <span class=\"st0\">\"z = a1 * b = mult a1 b =\"</span><br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:mapM_\"><span class=\"kw3\">mapM_</span></a> <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:print\"><span class=\"kw3\">print</span></a> z<br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:putStrLn\"><span class=\"kw3\">putStrLn</span></a> <span class=\"st0\">\"test: z == x =\"</span><br/>  <a href=\"http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:print\"><span class=\"kw3\">print</span></a> <span class=\"sy0\">$</span> z <span class=\"sy0\">==</span> x<br/>\u00a0<br/>main <span class=\"sy0\">=</span> <span class=\"kw1\">do</span><br/>  <span class=\"kw1\">let</span> a  <span class=\"sy0\">=</span> <span class=\"br0\">[</span><span class=\"br0\">[</span><span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.00</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0.00</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0.00</span><span class=\"sy0\">,</span>   <span class=\"nu0\">0.00</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>            <span class=\"br0\">[</span><span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.63</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.39</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0.25</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0.16</span><span class=\"sy0\">,</span>   <span class=\"nu0\">0.10</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>            <span class=\"br0\">[</span><span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">1.26</span><span class=\"sy0\">,</span> <span class=\"nu0\">1.58</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1.98</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2.49</span><span class=\"sy0\">,</span>   <span class=\"nu0\">3.13</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>            <span class=\"br0\">[</span><span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">1.88</span><span class=\"sy0\">,</span> <span class=\"nu0\">3.55</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6.70</span><span class=\"sy0\">,</span> <span class=\"nu0\">12.62</span><span class=\"sy0\">,</span>  <span class=\"nu0\">23.80</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>            <span class=\"br0\">[</span><span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">2.51</span><span class=\"sy0\">,</span> <span class=\"nu0\">6.32</span><span class=\"sy0\">,</span> <span class=\"nu0\">15.88</span><span class=\"sy0\">,</span> <span class=\"nu0\">39.90</span><span class=\"sy0\">,</span> <span class=\"nu0\">100.28</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>            <span class=\"br0\">[</span><span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">3.14</span><span class=\"sy0\">,</span> <span class=\"nu0\">9.87</span><span class=\"sy0\">,</span> <span class=\"nu0\">31.01</span><span class=\"sy0\">,</span> <span class=\"nu0\">97.41</span><span class=\"sy0\">,</span> <span class=\"nu0\">306.02</span><span class=\"br0\">]</span><span class=\"br0\">]</span><br/>  <span class=\"kw1\">let</span> b <span class=\"sy0\">=</span> <span class=\"br0\">[</span><span class=\"br0\">[</span><span class=\"sy0\">-</span><span class=\"nu0\">0.01</span><span class=\"br0\">]</span><span class=\"sy0\">,</span> <span class=\"br0\">[</span><span class=\"nu0\">0.61</span><span class=\"br0\">]</span><span class=\"sy0\">,</span> <span class=\"br0\">[</span><span class=\"nu0\">0.91</span><span class=\"br0\">]</span><span class=\"sy0\">,</span> <span class=\"br0\">[</span><span class=\"nu0\">0.99</span><span class=\"br0\">]</span><span class=\"sy0\">,</span> <span class=\"br0\">[</span><span class=\"nu0\">0.60</span><span class=\"br0\">]</span><span class=\"sy0\">,</span> <span class=\"br0\">[</span><span class=\"nu0\">0.02</span><span class=\"br0\">]</span><span class=\"br0\">]</span><br/>  task a b<br/>\u00a0</pre>"}, {"lang": "J", "loc": 59, "block": "<pre class=\"j highlighted_source\">\u00a0<br/>   f=: <span class=\"nu0\">6j2</span>&amp;\":   <span class=\"co1\">NB. formatting verb</span><br/>\u00a0<br/>   sin=: <span class=\"nu0\">1</span>&amp;o.   <span class=\"co1\">NB. verb to evaluate circle function 1, the sine</span><br/>\u00a0<br/>   add_noise=: ] + <span class=\"sy0\">(</span>* <span class=\"sy0\">(</span><span class=\"nu0\">_0.5</span> + <span class=\"nu0\">0</span>\u00a0<a class=\"__cf_email__\" data-cfemail=\"a699e6\" href=\"/cdn-cgi/l/email-protection\">[email\u00a0protected]</a>:#~ #<span class=\"sy0\">))</span>   <span class=\"co1\">NB. AMPLITUDE add_noise SIGNAL</span><br/>\u00a0<br/>   f RADIANS=: <a class=\"__cf_email__\" data-cfemail=\"244b0a64\" href=\"/cdn-cgi/l/email-protection\">[email\u00a0protected]</a>:<span class=\"sy0\">(</span>%~ <a class=\"__cf_email__\" data-cfemail=\"432a6d03\" href=\"/cdn-cgi/l/email-protection\">[email\u00a0protected]</a>:&gt;:<span class=\"sy0\">)</span><span class=\"nu0\">5</span>  <span class=\"co1\">NB. monadic circle function is  pi times</span><br/>  <span class=\"nu0\">0.00</span>  <span class=\"nu0\">0.63</span>  <span class=\"nu0\">1.26</span>  <span class=\"nu0\">1.88</span>  <span class=\"nu0\">2.51</span>  <span class=\"nu0\">3.14</span><br/>\u00a0<br/>   f SINES=: sin RADIANS<br/>  <span class=\"nu0\">0.00</span>  <span class=\"nu0\">0.59</span>  <span class=\"nu0\">0.95</span>  <span class=\"nu0\">0.95</span>  <span class=\"nu0\">0.59</span>  <span class=\"nu0\">0.00</span><br/>\u00a0<br/>   f NOISY_SINES=: <span class=\"nu0\">0.1</span> add_noise SINES<br/> <span class=\"nu0\">_0.01</span>  <span class=\"nu0\">0.61</span>  <span class=\"nu0\">0.91</span>  <span class=\"nu0\">0.99</span>  <span class=\"nu0\">0.60</span>  <span class=\"nu0\">0.02</span><br/>\u00a0<br/>   A=: <span class=\"sy0\">(</span>^/ <a class=\"__cf_email__\" data-cfemail=\"761f5836\" href=\"/cdn-cgi/l/email-protection\">[email\u00a0protected]</a>:#<span class=\"sy0\">)</span> RADIANS  <span class=\"co1\">NB. A is the quintic coefficient matrix</span><br/>\u00a0<br/>   <span class=\"co1\">NB. display the equation to solve</span><br/>   <span class=\"sy0\">(</span>f A<span class=\"sy0\">)</span>\u00a0; <span class=\"st_h\">'x'</span>\u00a0; <span class=\"st_h\">'='</span>\u00a0; <a class=\"__cf_email__\" data-cfemail=\"5e381e\" href=\"/cdn-cgi/l/email-protection\">[email\u00a0protected]</a>:,. NOISY_SINES<br/>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u252c\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2510<br/>\u2502  <span class=\"nu0\">1.00</span>  <span class=\"nu0\">0.00</span>  <span class=\"nu0\">0.00</span>  <span class=\"nu0\">0.00</span>  <span class=\"nu0\">0.00</span>  <span class=\"nu0\">0.00</span>\u2502<span class=\"kw2\">x</span>\u2502=\u2502 <span class=\"nu0\">_0.01</span>\u2502<br/>\u2502  <span class=\"nu0\">1.00</span>  <span class=\"nu0\">0.63</span>  <span class=\"nu0\">0.39</span>  <span class=\"nu0\">0.25</span>  <span class=\"nu0\">0.16</span>  <span class=\"nu0\">0.10</span>\u2502 \u2502 \u2502  <span class=\"nu0\">0.61</span>\u2502<br/>\u2502  <span class=\"nu0\">1.00</span>  <span class=\"nu0\">1.26</span>  <span class=\"nu0\">1.58</span>  <span class=\"nu0\">1.98</span>  <span class=\"nu0\">2.49</span>  <span class=\"nu0\">3.13</span>\u2502 \u2502 \u2502  <span class=\"nu0\">0.91</span>\u2502<br/>\u2502  <span class=\"nu0\">1.00</span>  <span class=\"nu0\">1.88</span>  <span class=\"nu0\">3.55</span>  <span class=\"nu0\">6.70</span> <span class=\"nu0\">12.62</span> <span class=\"nu0\">23.80</span>\u2502 \u2502 \u2502  <span class=\"nu0\">0.99</span>\u2502<br/>\u2502  <span class=\"nu0\">1.00</span>  <span class=\"nu0\">2.51</span>  <span class=\"nu0\">6.32</span> <span class=\"nu0\">15.88</span> 39.<span class=\"nu0\">90100.28</span>\u2502 \u2502 \u2502  <span class=\"nu0\">0.60</span>\u2502<br/>\u2502  <span class=\"nu0\">1.00</span>  <span class=\"nu0\">3.14</span>  <span class=\"nu0\">9.87</span> <span class=\"nu0\">31.01</span> 97.<span class=\"nu0\">41306.02</span>\u2502 \u2502 \u2502  <span class=\"nu0\">0.02</span>\u2502<br/>\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2534\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2518<br/>\u00a0<br/>   f QUINTIC_COEFFICIENTS=: NOISY_SINES\u00a0%. A   <span class=\"co1\">NB.\u00a0%. solves the linear system</span><br/> <span class=\"nu0\">_0.01</span>  <span class=\"nu0\">1.71</span> <span class=\"nu0\">_1.88</span>  <span class=\"nu0\">1.48</span> <span class=\"nu0\">_0.58</span>  <span class=\"nu0\">0.08</span><br/>\u00a0<br/>   quintic=: QUINTIC_COEFFICIENTS&amp;p.  <span class=\"co1\">NB. verb to evaluate the polynomial</span><br/>\u00a0<br/>   <span class=\"co1\">NB.\u00a0%. also solves the least squares fit for overdetermined system</span><br/>   quadratic=: <span class=\"sy0\">(</span>NOISY_SINES\u00a0%. <span class=\"sy0\">(</span>^/ <a class=\"__cf_email__\" data-cfemail=\"61084f21\" href=\"/cdn-cgi/l/email-protection\">[email\u00a0protected]</a>:3:<span class=\"sy0\">)</span> RADIANS<span class=\"sy0\">)</span>&amp;p.  <span class=\"co1\">NB. verb to evaluate quadratic.</span><br/>   quadratic<br/><span class=\"nu0\">_0.0200630695393961729</span> <span class=\"nu0\">1.26066877804926536</span> <span class=\"nu0\">_0.398275112136019516</span>&amp;p.<br/>\u00a0<br/>   <span class=\"co1\">NB. The quintic is agrees with the noisy data, as it should</span><br/>   <a class=\"__cf_email__\" data-cfemail=\"bed8fe\" href=\"/cdn-cgi/l/email-protection\">[email\u00a0protected]</a>:<span class=\"sy0\">(</span>NOISY_SINES ,. sin ,. quadratic ,. quintic<span class=\"sy0\">)</span> RADIANS<br/> <span class=\"nu0\">_0.01</span>  <span class=\"nu0\">0.00</span> <span class=\"nu0\">_0.02</span> <span class=\"nu0\">_0.01</span><br/>  <span class=\"nu0\">0.61</span>  <span class=\"nu0\">0.59</span>  <span class=\"nu0\">0.61</span>  <span class=\"nu0\">0.61</span><br/>  <span class=\"nu0\">0.91</span>  <span class=\"nu0\">0.95</span>  <span class=\"nu0\">0.94</span>  <span class=\"nu0\">0.91</span><br/>  <span class=\"nu0\">0.99</span>  <span class=\"nu0\">0.95</span>  <span class=\"nu0\">0.94</span>  <span class=\"nu0\">0.99</span><br/>  <span class=\"nu0\">0.60</span>  <span class=\"nu0\">0.59</span>  <span class=\"nu0\">0.63</span>  <span class=\"nu0\">0.60</span><br/>  <span class=\"nu0\">0.02</span>  <span class=\"nu0\">0.00</span>  <span class=\"nu0\">0.01</span>  <span class=\"nu0\">0.02</span><br/>\u00a0<br/>   f MID_POINTS=: <span class=\"sy0\">(</span>+ -:@:<span class=\"sy0\">(</span>-/@:<span class=\"sy0\">(</span><span class=\"nu0\">2</span>&amp;{.<span class=\"sy0\">)))</span>RADIANS<br/> <span class=\"nu0\">_0.31</span>  <span class=\"nu0\">0.31</span>  <span class=\"nu0\">0.94</span>  <span class=\"nu0\">1.57</span>  <span class=\"nu0\">2.20</span>  <span class=\"nu0\">2.83</span><br/>\u00a0<br/>   <a class=\"__cf_email__\" data-cfemail=\"6c0a2c\" href=\"/cdn-cgi/l/email-protection\">[email\u00a0protected]</a>:<span class=\"sy0\">(</span>sin ,. quadratic ,. quintic<span class=\"sy0\">)</span> MID_POINTS<br/> <span class=\"nu0\">_0.31</span> <span class=\"nu0\">_0.46</span> <span class=\"nu0\">_0.79</span><br/>  <span class=\"nu0\">0.31</span>  <span class=\"nu0\">0.34</span>  <span class=\"nu0\">0.38</span><br/>  <span class=\"nu0\">0.81</span>  <span class=\"nu0\">0.81</span>  <span class=\"nu0\">0.77</span><br/>  <span class=\"nu0\">1.00</span>  <span class=\"nu0\">0.98</span>  <span class=\"nu0\">1.00</span><br/>  <span class=\"nu0\">0.81</span>  <span class=\"nu0\">0.83</span>  <span class=\"nu0\">0.86</span><br/>  <span class=\"nu0\">0.31</span>  <span class=\"nu0\">0.36</span>  <span class=\"nu0\">0.27</span><br/>\u00a0</pre>"}, {"lang": "JavaScript", "loc": 119, "block": "<pre class=\"javascript highlighted_source\"><span class=\"co1\">// Lower Upper Solver</span><br/><span class=\"kw1\">function</span> lusolve<span class=\"br0\">(</span>A<span class=\"sy0\">,</span> b<span class=\"sy0\">,</span> update<span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>\t<span class=\"kw1\">var</span> lu <span class=\"sy0\">=</span> ludcmp<span class=\"br0\">(</span>A<span class=\"sy0\">,</span> update<span class=\"br0\">)</span><br/>\t<span class=\"kw1\">if</span> <span class=\"br0\">(</span>lu <span class=\"sy0\">===</span> <span class=\"kw2\">undefined</span><span class=\"br0\">)</span> <span class=\"kw1\">return</span> <span class=\"co1\">// Singular Matrix!</span><br/>\t<span class=\"kw1\">return</span> lubksb<span class=\"br0\">(</span>lu<span class=\"sy0\">,</span> b<span class=\"sy0\">,</span> update<span class=\"br0\">)</span><br/><span class=\"br0\">}</span><br/>\u00a0<br/><span class=\"co1\">// Lower Upper Decomposition</span><br/><span class=\"kw1\">function</span> ludcmp<span class=\"br0\">(</span>A<span class=\"sy0\">,</span> update<span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>\t<span class=\"co1\">// A is a matrix that we want to decompose into Lower and Upper matrices.</span><br/>\t<span class=\"kw1\">var</span> d <span class=\"sy0\">=</span> <span class=\"kw2\">true</span><br/>\t<span class=\"kw1\">var</span> n <span class=\"sy0\">=</span> A.<span class=\"me1\">length</span><br/>\t<span class=\"kw1\">var</span> idx <span class=\"sy0\">=</span> <span class=\"kw1\">new</span> <span class=\"kw4\">Array</span><span class=\"br0\">(</span>n<span class=\"br0\">)</span> <span class=\"co1\">// Output vector with row permutations from partial pivoting</span><br/>\t<span class=\"kw1\">var</span> vv <span class=\"sy0\">=</span> <span class=\"kw1\">new</span> <span class=\"kw4\">Array</span><span class=\"br0\">(</span>n<span class=\"br0\">)</span>  <span class=\"co1\">// Scaling information</span><br/>\u00a0<br/>\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw1\">var</span> i<span class=\"sy0\">=</span><span class=\"nu0\">0</span><span class=\"sy0\">;</span> i<span class=\"sy0\">&lt;</span>n<span class=\"sy0\">;</span> i<span class=\"sy0\">++</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>\t\t<span class=\"kw1\">var</span> max <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><br/>\t\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw1\">var</span> j<span class=\"sy0\">=</span><span class=\"nu0\">0</span><span class=\"sy0\">;</span> j<span class=\"sy0\">&lt;</span>n<span class=\"sy0\">;</span> j<span class=\"sy0\">++</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>\t\t\t<span class=\"kw1\">var</span> temp <span class=\"sy0\">=</span> <span class=\"kw4\">Math</span>.<span class=\"me1\">abs</span><span class=\"br0\">(</span>A<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>j<span class=\"br0\">]</span><span class=\"br0\">)</span><br/>\t\t\t<span class=\"kw1\">if</span> <span class=\"br0\">(</span>temp <span class=\"sy0\">&gt;</span> max<span class=\"br0\">)</span> max <span class=\"sy0\">=</span> temp<br/>\t\t<span class=\"br0\">}</span><br/>\t\t<span class=\"kw1\">if</span> <span class=\"br0\">(</span>max <span class=\"sy0\">==</span> <span class=\"nu0\">0</span><span class=\"br0\">)</span> <span class=\"kw1\">return</span> <span class=\"co1\">// Singular Matrix!</span><br/>\t\tvv<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"nu0\">1</span> <span class=\"sy0\">/</span> max <span class=\"co1\">// Scaling</span><br/>\t<span class=\"br0\">}</span><br/>\u00a0<br/>\t<span class=\"kw1\">if</span> <span class=\"br0\">(</span><span class=\"sy0\">!</span>update<span class=\"br0\">)</span> <span class=\"br0\">{</span> <span class=\"co1\">// make a copy of A </span><br/>\t\t<span class=\"kw1\">var</span> Acpy <span class=\"sy0\">=</span> <span class=\"kw1\">new</span> <span class=\"kw4\">Array</span><span class=\"br0\">(</span>n<span class=\"br0\">)</span><br/>\t\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw1\">var</span> i<span class=\"sy0\">=</span><span class=\"nu0\">0</span><span class=\"sy0\">;</span> i<span class=\"sy0\">&lt;</span>n<span class=\"sy0\">;</span> i<span class=\"sy0\">++</span><span class=\"br0\">)</span> <span class=\"br0\">{</span>\t\t<br/>\t\t\t<span class=\"kw1\">var</span> Ai <span class=\"sy0\">=</span> A<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <br/>\t\t\tAcpyi <span class=\"sy0\">=</span> <span class=\"kw1\">new</span> <span class=\"kw4\">Array</span><span class=\"br0\">(</span>Ai.<span class=\"me1\">length</span><span class=\"br0\">)</span><br/>\t\t\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span>j<span class=\"sy0\">=</span><span class=\"nu0\">0</span><span class=\"sy0\">;</span> j<span class=\"sy0\">&lt;</span>Ai.<span class=\"me1\">length</span><span class=\"sy0\">;</span> j<span class=\"sy0\">+=</span><span class=\"nu0\">1</span><span class=\"br0\">)</span> Acpyi<span class=\"br0\">[</span>j<span class=\"br0\">]</span> <span class=\"sy0\">=</span> Ai<span class=\"br0\">[</span>j<span class=\"br0\">]</span><br/>\t\t\tAcpy<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> Acpyi<br/>\t\t<span class=\"br0\">}</span><br/>\t\tA <span class=\"sy0\">=</span> Acpy<br/>\t<span class=\"br0\">}</span><br/>\u00a0<br/>\t<span class=\"kw1\">var</span> tiny <span class=\"sy0\">=</span> 1e<span class=\"sy0\">-</span>20 <span class=\"co1\">// in case pivot element is zero</span><br/>\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw1\">var</span> i<span class=\"sy0\">=</span><span class=\"nu0\">0</span><span class=\"sy0\">;</span> <span class=\"sy0\">;</span> i<span class=\"sy0\">++</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>\t\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw1\">var</span> j<span class=\"sy0\">=</span><span class=\"nu0\">0</span><span class=\"sy0\">;</span> j<span class=\"sy0\">&lt;</span>i<span class=\"sy0\">;</span> j<span class=\"sy0\">++</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>\t\t\t<span class=\"kw1\">var</span> sum <span class=\"sy0\">=</span> A<span class=\"br0\">[</span>j<span class=\"br0\">]</span><span class=\"br0\">[</span>i<span class=\"br0\">]</span><br/>\t\t\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw1\">var</span> k<span class=\"sy0\">=</span><span class=\"nu0\">0</span><span class=\"sy0\">;</span> k<span class=\"sy0\">&lt;</span>j<span class=\"sy0\">;</span> k<span class=\"sy0\">++</span><span class=\"br0\">)</span> sum <span class=\"sy0\">-=</span> A<span class=\"br0\">[</span>j<span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"br0\">]</span> <span class=\"sy0\">*</span> A<span class=\"br0\">[</span>k<span class=\"br0\">]</span><span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>\t\t\tA<span class=\"br0\">[</span>j<span class=\"br0\">]</span><span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> sum<br/>\t\t<span class=\"br0\">}</span><br/>\t\t<span class=\"kw1\">var</span> jmax <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><br/>\t\t<span class=\"kw1\">var</span> max <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span><br/>\t\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw1\">var</span> j<span class=\"sy0\">=</span>i<span class=\"sy0\">;</span> j<span class=\"sy0\">&lt;</span>n<span class=\"sy0\">;</span> j<span class=\"sy0\">++</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>\t\t\t<span class=\"kw1\">var</span> sum <span class=\"sy0\">=</span> A<span class=\"br0\">[</span>j<span class=\"br0\">]</span><span class=\"br0\">[</span>i<span class=\"br0\">]</span><br/>\t\t\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw1\">var</span> k<span class=\"sy0\">=</span><span class=\"nu0\">0</span><span class=\"sy0\">;</span> k<span class=\"sy0\">&lt;</span>i<span class=\"sy0\">;</span> k<span class=\"sy0\">++</span><span class=\"br0\">)</span> sum <span class=\"sy0\">-=</span> A<span class=\"br0\">[</span>j<span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"br0\">]</span> <span class=\"sy0\">*</span> A<span class=\"br0\">[</span>k<span class=\"br0\">]</span><span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>\t\t\tA<span class=\"br0\">[</span>j<span class=\"br0\">]</span><span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> sum<br/>\t\t\t<span class=\"kw1\">var</span> temp <span class=\"sy0\">=</span> vv<span class=\"br0\">[</span>j<span class=\"br0\">]</span> <span class=\"sy0\">*</span> <span class=\"kw4\">Math</span>.<span class=\"me1\">abs</span><span class=\"br0\">(</span>sum<span class=\"br0\">)</span><br/>\t\t\t<span class=\"kw1\">if</span> <span class=\"br0\">(</span>temp <span class=\"sy0\">&gt;=</span> max<span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>\t\t\t\tmax <span class=\"sy0\">=</span> temp<br/>\t\t\t\tjmax <span class=\"sy0\">=</span> j<br/>\t\t\t<span class=\"br0\">}</span><br/>\t\t<span class=\"br0\">}</span><br/>\t\t<span class=\"kw1\">if</span> <span class=\"br0\">(</span>i <span class=\"sy0\">&lt;=</span> jmax<span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>\t\t\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw1\">var</span> j<span class=\"sy0\">=</span><span class=\"nu0\">0</span><span class=\"sy0\">;</span> j<span class=\"sy0\">&lt;</span>n<span class=\"sy0\">;</span> j<span class=\"sy0\">++</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>\t\t\t\t<span class=\"kw1\">var</span> temp <span class=\"sy0\">=</span> A<span class=\"br0\">[</span>jmax<span class=\"br0\">]</span><span class=\"br0\">[</span>j<span class=\"br0\">]</span><br/>\t\t\t\tA<span class=\"br0\">[</span>jmax<span class=\"br0\">]</span><span class=\"br0\">[</span>j<span class=\"br0\">]</span> <span class=\"sy0\">=</span> A<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>j<span class=\"br0\">]</span><br/>\t\t\t\tA<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>j<span class=\"br0\">]</span> <span class=\"sy0\">=</span> temp<br/>\t\t\t<span class=\"br0\">}</span><br/>\t\t\td <span class=\"sy0\">=</span> <span class=\"sy0\">!</span>d<span class=\"sy0\">;</span><br/>\t\t\tvv<span class=\"br0\">[</span>jmax<span class=\"br0\">]</span> <span class=\"sy0\">=</span> vv<span class=\"br0\">[</span>i<span class=\"br0\">]</span><br/>\t\t<span class=\"br0\">}</span><br/>\t\tidx<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> jmax<span class=\"sy0\">;</span><br/>\t\t<span class=\"kw1\">if</span> <span class=\"br0\">(</span>i <span class=\"sy0\">==</span> n<span class=\"sy0\">-</span><span class=\"nu0\">1</span><span class=\"br0\">)</span> <span class=\"kw1\">break</span><span class=\"sy0\">;</span><br/>\t\t<span class=\"kw1\">var</span> temp <span class=\"sy0\">=</span> A<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>i<span class=\"br0\">]</span><br/>\t\t<span class=\"kw1\">if</span> <span class=\"br0\">(</span>temp <span class=\"sy0\">==</span> <span class=\"nu0\">0</span><span class=\"br0\">)</span> A<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> temp <span class=\"sy0\">=</span> tiny<br/>\t\ttemp <span class=\"sy0\">=</span> <span class=\"nu0\">1</span> <span class=\"sy0\">/</span> temp<br/>\t\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw1\">var</span> j<span class=\"sy0\">=</span>i<span class=\"sy0\">+</span><span class=\"nu0\">1</span><span class=\"sy0\">;</span> j<span class=\"sy0\">&lt;</span>n<span class=\"sy0\">;</span> j<span class=\"sy0\">++</span><span class=\"br0\">)</span> A<span class=\"br0\">[</span>j<span class=\"br0\">]</span><span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">*=</span> temp<br/>\t<span class=\"br0\">}</span><br/>\t<span class=\"kw1\">return</span> <span class=\"br0\">{</span>A<span class=\"sy0\">:</span>A<span class=\"sy0\">,</span> idx<span class=\"sy0\">:</span>idx<span class=\"sy0\">,</span> d<span class=\"sy0\">:</span>d<span class=\"br0\">}</span><br/><span class=\"br0\">}</span><br/>\u00a0<br/><span class=\"co1\">// Lower Upper Back Substitution</span><br/><span class=\"kw1\">function</span> lubksb<span class=\"br0\">(</span>lu<span class=\"sy0\">,</span> b<span class=\"sy0\">,</span> update<span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>\t<span class=\"co1\">// solves the set of n linear equations A*x = b.</span><br/>\t<span class=\"co1\">// lu is the object containing A, idx and d as determined by the routine ludcmp.</span><br/>\t<span class=\"kw1\">var</span> A <span class=\"sy0\">=</span> lu.<span class=\"me1\">A</span><br/>\t<span class=\"kw1\">var</span> idx <span class=\"sy0\">=</span> lu.<span class=\"me1\">idx</span><br/>\t<span class=\"kw1\">var</span> n <span class=\"sy0\">=</span> idx.<span class=\"me1\">length</span><br/>\u00a0<br/>\t<span class=\"kw1\">if</span> <span class=\"br0\">(</span><span class=\"sy0\">!</span>update<span class=\"br0\">)</span> <span class=\"br0\">{</span> <span class=\"co1\">// make a copy of b</span><br/>\t\t<span class=\"kw1\">var</span> bcpy <span class=\"sy0\">=</span> <span class=\"kw1\">new</span> <span class=\"kw4\">Array</span><span class=\"br0\">(</span>n<span class=\"br0\">)</span> <br/>\t\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw1\">var</span> i<span class=\"sy0\">=</span><span class=\"nu0\">0</span><span class=\"sy0\">;</span> i<span class=\"sy0\">&lt;</span>b.<span class=\"me1\">length</span><span class=\"sy0\">;</span> i<span class=\"sy0\">+=</span><span class=\"nu0\">1</span><span class=\"br0\">)</span> bcpy<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> b<span class=\"br0\">[</span>i<span class=\"br0\">]</span><br/>\t\tb <span class=\"sy0\">=</span> bcpy<br/>\t<span class=\"br0\">}</span><br/>\u00a0<br/>\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw1\">var</span> ii<span class=\"sy0\">=-</span><span class=\"nu0\">1</span><span class=\"sy0\">,</span> i<span class=\"sy0\">=</span><span class=\"nu0\">0</span><span class=\"sy0\">;</span> i<span class=\"sy0\">&lt;</span>n<span class=\"sy0\">;</span> i<span class=\"sy0\">++</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>\t\t<span class=\"kw1\">var</span> ix <span class=\"sy0\">=</span> idx<span class=\"br0\">[</span>i<span class=\"br0\">]</span><br/>\t\t<span class=\"kw1\">var</span> sum <span class=\"sy0\">=</span> b<span class=\"br0\">[</span>ix<span class=\"br0\">]</span><br/>\t\tb<span class=\"br0\">[</span>ix<span class=\"br0\">]</span> <span class=\"sy0\">=</span> b<span class=\"br0\">[</span>i<span class=\"br0\">]</span><br/>\t\t<span class=\"kw1\">if</span> <span class=\"br0\">(</span>ii <span class=\"sy0\">&gt;</span> <span class=\"sy0\">-</span><span class=\"nu0\">1</span><span class=\"br0\">)</span><br/>\t\t\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw1\">var</span> j<span class=\"sy0\">=</span>ii<span class=\"sy0\">;</span> j<span class=\"sy0\">&lt;</span>i<span class=\"sy0\">;</span> j<span class=\"sy0\">++</span><span class=\"br0\">)</span> sum <span class=\"sy0\">-=</span> A<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>j<span class=\"br0\">]</span> <span class=\"sy0\">*</span> b<span class=\"br0\">[</span>j<span class=\"br0\">]</span><br/>\t\t<span class=\"kw1\">else</span> <span class=\"kw1\">if</span> <span class=\"br0\">(</span>sum<span class=\"br0\">)</span><br/>\t\t\tii <span class=\"sy0\">=</span> i<br/>\t\tb<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> sum<br/>\t<span class=\"br0\">}</span><br/>\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw1\">var</span> i<span class=\"sy0\">=</span>n<span class=\"sy0\">-</span><span class=\"nu0\">1</span><span class=\"sy0\">;</span> i<span class=\"sy0\">&gt;=</span><span class=\"nu0\">0</span><span class=\"sy0\">;</span> i<span class=\"sy0\">--</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>\t\t<span class=\"kw1\">var</span> sum <span class=\"sy0\">=</span> b<span class=\"br0\">[</span>i<span class=\"br0\">]</span><br/>\t\t<span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"kw1\">var</span> j<span class=\"sy0\">=</span>i<span class=\"sy0\">+</span><span class=\"nu0\">1</span><span class=\"sy0\">;</span> j<span class=\"sy0\">&lt;</span>n<span class=\"sy0\">;</span> j<span class=\"sy0\">++</span><span class=\"br0\">)</span> sum <span class=\"sy0\">-=</span> A<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>j<span class=\"br0\">]</span> <span class=\"sy0\">*</span> b<span class=\"br0\">[</span>j<span class=\"br0\">]</span><br/>\t\tb<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> sum <span class=\"sy0\">/</span> A<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>i<span class=\"br0\">]</span><br/>\t<span class=\"br0\">}</span><br/>\t<span class=\"kw1\">return</span> b <span class=\"co1\">// solution vector x</span><br/><span class=\"br0\">}</span><br/>\u00a0<br/>document.<span class=\"me1\">write</span><span class=\"br0\">(</span><br/>\tlusolve<span class=\"br0\">(</span><br/>\t\t<span class=\"br0\">[</span><br/>\t\t\t<span class=\"br0\">[</span><span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.00</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0.00</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0.00</span><span class=\"sy0\">,</span>   <span class=\"nu0\">0.00</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>                \t<span class=\"br0\">[</span><span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.63</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.39</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0.25</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0.16</span><span class=\"sy0\">,</span>   <span class=\"nu0\">0.10</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>                \t<span class=\"br0\">[</span><span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">1.26</span><span class=\"sy0\">,</span> <span class=\"nu0\">1.58</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1.98</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2.49</span><span class=\"sy0\">,</span>   <span class=\"nu0\">3.13</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>                \t<span class=\"br0\">[</span><span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">1.88</span><span class=\"sy0\">,</span> <span class=\"nu0\">3.55</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6.70</span><span class=\"sy0\">,</span> <span class=\"nu0\">12.62</span><span class=\"sy0\">,</span>  <span class=\"nu0\">23.80</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>                \t<span class=\"br0\">[</span><span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">2.51</span><span class=\"sy0\">,</span> <span class=\"nu0\">6.32</span><span class=\"sy0\">,</span> <span class=\"nu0\">15.88</span><span class=\"sy0\">,</span> <span class=\"nu0\">39.90</span><span class=\"sy0\">,</span> <span class=\"nu0\">100.28</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>                \t<span class=\"br0\">[</span><span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">3.14</span><span class=\"sy0\">,</span> <span class=\"nu0\">9.87</span><span class=\"sy0\">,</span> <span class=\"nu0\">31.01</span><span class=\"sy0\">,</span> <span class=\"nu0\">97.41</span><span class=\"sy0\">,</span> <span class=\"nu0\">306.02</span><span class=\"br0\">]</span><br/>\t\t<span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>    \t\t<span class=\"br0\">[</span><span class=\"sy0\">-</span><span class=\"nu0\">0.01</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.61</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.91</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0.99</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0.60</span><span class=\"sy0\">,</span>   <span class=\"nu0\">0.02</span><span class=\"br0\">]</span><br/>\t<span class=\"br0\">)</span><br/><span class=\"br0\">)</span></pre>"}, {"lang": "Julia", "loc": 1, "block": "<pre class=\"text highlighted_source\">x = A \\ b</pre>"}, {"lang": "Klong", "loc": 7, "block": "<pre class=\"text highlighted_source\">\u00a0<br/>elim::{[h m];h::*m::<a class=\"__cf_email__\" data-cfemail=\"95edd5\" href=\"/cdn-cgi/l/email-protection\">[email\u00a0protected]</a>&gt;*'x;<br/>      \u00a0:[2&gt;#x;x;(,h),0,:\\.f({1_x}'{x-h**x%*h}'1_m)]}<br/>subst::{[v];v::[];<br/>        {v::v,((*x)-/:[[]~v;[];v*<a class=\"__cf_email__\" data-cfemail=\"730b3342\" href=\"/cdn-cgi/l/email-protection\">[email\u00a0protected]</a>+!#v])%<a class=\"__cf_email__\" data-cfemail=\"e39ba3d2\" href=\"/cdn-cgi/l/email-protection\">[email\u00a0protected]</a>+#v}'||'x;|v}<br/>gauss::{subst(elim(x))}<br/>\u00a0</pre>"}, {"lang": "Kotlin", "loc": 81, "block": "<pre class=\"scala highlighted_source\"><span class=\"co1\">// version 1.1.51</span><br/>\u00a0<br/><a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> ta <span class=\"sy0\">=</span> arrayOf<span class=\"br0\">(</span><br/>    doubleArrayOf<span class=\"br0\">(</span><span class=\"nu0\">1.00</span>, <span class=\"nu0\">0.00</span>, <span class=\"nu0\">0.00</span>, <span class=\"nu0\">0.00</span>, <span class=\"nu0\">0.00</span>, <span class=\"nu0\">0.00</span><span class=\"br0\">)</span>,<br/>    doubleArrayOf<span class=\"br0\">(</span><span class=\"nu0\">1.00</span>, <span class=\"nu0\">0.63</span>, <span class=\"nu0\">0.39</span>, <span class=\"nu0\">0.25</span>, <span class=\"nu0\">0.16</span>, <span class=\"nu0\">0.10</span><span class=\"br0\">)</span>,<br/>    doubleArrayOf<span class=\"br0\">(</span><span class=\"nu0\">1.00</span>, <span class=\"nu0\">1.26</span>, <span class=\"nu0\">1.58</span>, <span class=\"nu0\">1.98</span>, <span class=\"nu0\">2.49</span>, <span class=\"nu0\">3.13</span><span class=\"br0\">)</span>,<br/>    doubleArrayOf<span class=\"br0\">(</span><span class=\"nu0\">1.00</span>, <span class=\"nu0\">1.88</span>, <span class=\"nu0\">3.55</span>, <span class=\"nu0\">6.70</span>, <span class=\"nu0\">12.62</span>, <span class=\"nu0\">23.80</span><span class=\"br0\">)</span>,<br/>    doubleArrayOf<span class=\"br0\">(</span><span class=\"nu0\">1.00</span>, <span class=\"nu0\">2.51</span>, <span class=\"nu0\">6.32</span>, <span class=\"nu0\">15.88</span>, <span class=\"nu0\">39.90</span>, <span class=\"nu0\">100.28</span><span class=\"br0\">)</span>,<br/>    doubleArrayOf<span class=\"br0\">(</span><span class=\"nu0\">1.00</span>, <span class=\"nu0\">3.14</span>, <span class=\"nu0\">9.87</span>, <span class=\"nu0\">31.01</span>, <span class=\"nu0\">97.41</span>, <span class=\"nu0\">306.02</span><span class=\"br0\">)</span><br/><span class=\"br0\">)</span><br/>\u00a0<br/><a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> tb <span class=\"sy0\">=</span> doubleArrayOf<span class=\"br0\">(</span>-<span class=\"nu0\">0.01</span>, <span class=\"nu0\">0.61</span>, <span class=\"nu0\">0.91</span>, <span class=\"nu0\">0.99</span>, <span class=\"nu0\">0.60</span>, <span class=\"nu0\">0.02</span><span class=\"br0\">)</span><br/>\u00a0<br/><a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> tx <span class=\"sy0\">=</span> doubleArrayOf<span class=\"br0\">(</span><br/>    -<span class=\"nu0\">0.01</span>, <span class=\"nu0\">1.602790394502114</span>, -<span class=\"nu0\">1.6132030599055613</span>,<br/>    <span class=\"nu0\">1.2454941213714368</span>, -<span class=\"nu0\">0.4909897195846576</span>, <span class=\"nu0\">0.065760696175232</span><br/><span class=\"br0\">)</span><br/>\u00a0<br/>const <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> EPSILON <span class=\"sy0\">=</span> 1e-14  <span class=\"co1\">// tolerance required</span><br/>\u00a0<br/>fun gaussPartial<span class=\"br0\">(</span>a0<span class=\"sy0\">:</span> Array<span class=\"sy0\">&lt;</span>DoubleArray<span class=\"sy0\">&gt;</span>, b0<span class=\"sy0\">:</span> DoubleArray<span class=\"br0\">)</span><span class=\"sy0\">:</span> DoubleArray <span class=\"br0\">{</span><br/>    <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> m <span class=\"sy0\">=</span> b0.<span class=\"me1\">size</span><br/>    <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> a <span class=\"sy0\">=</span> Array<span class=\"br0\">(</span>m<span class=\"br0\">)</span> <span class=\"br0\">{</span> DoubleArray<span class=\"br0\">(</span>m<span class=\"br0\">)</span> <span class=\"br0\">}</span><br/>    <a href=\"http://scala-lang.org\"><span class=\"kw1\">for</span></a> <span class=\"br0\">(</span><span class=\"br0\">(</span>i, ai<span class=\"br0\">)</span> in a0.<span class=\"me1\">withIndex</span><span class=\"br0\">(</span><span class=\"br0\">)</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>        <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> row <span class=\"sy0\">=</span> ai.<span class=\"me1\">copyOf</span><span class=\"br0\">(</span>m + <span class=\"nu0\">1</span><span class=\"br0\">)</span><br/>        row<span class=\"br0\">[</span>m<span class=\"br0\">]</span> <span class=\"sy0\">=</span> b0<span class=\"br0\">[</span>i<span class=\"br0\">]</span><br/>        a<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> row<br/>    <span class=\"br0\">}</span><br/>    <a href=\"http://scala-lang.org\"><span class=\"kw1\">for</span></a> <span class=\"br0\">(</span>k in <span class=\"nu0\">0</span> until a.<span class=\"me1\">size</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>        <a href=\"http://scala-lang.org\"><span class=\"kw1\">var</span></a> iMax <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><br/>        <a href=\"http://scala-lang.org\"><span class=\"kw1\">var</span></a> max <span class=\"sy0\">=</span> -<span class=\"nu0\">1.0</span><br/>        <a href=\"http://scala-lang.org\"><span class=\"kw1\">for</span></a> <span class=\"br0\">(</span>i in k until m<span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>            <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> row <span class=\"sy0\">=</span> a<span class=\"br0\">[</span>i<span class=\"br0\">]</span><br/>            <span class=\"co1\">// compute scale factor s = max abs in row</span><br/>            <a href=\"http://scala-lang.org\"><span class=\"kw1\">var</span></a> s <span class=\"sy0\">=</span> -<span class=\"nu0\">1.0</span><br/>            <a href=\"http://scala-lang.org\"><span class=\"kw1\">for</span></a> <span class=\"br0\">(</span>j in k until m<span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>                <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> e <span class=\"sy0\">=</span> Math.<span class=\"me1\">abs</span><span class=\"br0\">(</span>row<span class=\"br0\">[</span>j<span class=\"br0\">]</span><span class=\"br0\">)</span><br/>                <a href=\"http://scala-lang.org\"><span class=\"kw1\">if</span></a> <span class=\"br0\">(</span>e <span class=\"sy0\">&gt;</span> s<span class=\"br0\">)</span> s <span class=\"sy0\">=</span> e<br/>            <span class=\"br0\">}</span><br/>            <span class=\"co1\">// scale the abs used to pick the pivot</span><br/>            <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> abs <span class=\"sy0\">=</span> Math.<span class=\"me1\">abs</span><span class=\"br0\">(</span>row<span class=\"br0\">[</span>k<span class=\"br0\">]</span><span class=\"br0\">)</span> / s<br/>            <a href=\"http://scala-lang.org\"><span class=\"kw1\">if</span></a> <span class=\"br0\">(</span>abs <span class=\"sy0\">&gt;</span> max<span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>                iMax <span class=\"sy0\">=</span> i<br/>                max <span class=\"sy0\">=</span> abs<br/>            <span class=\"br0\">}</span><br/>        <span class=\"br0\">}</span><br/>        <a href=\"http://scala-lang.org\"><span class=\"kw1\">if</span></a> <span class=\"br0\">(</span>a<span class=\"br0\">[</span>iMax<span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"br0\">]</span> <span class=\"sy0\">==</span> <span class=\"nu0\">0.0</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>            <a href=\"http://scala-lang.org\"><span class=\"kw1\">throw</span></a> RuntimeException<span class=\"br0\">(</span><span class=\"st0\">\"Matrix is singular.\"</span><span class=\"br0\">)</span><br/>        <span class=\"br0\">}</span><br/>        <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> tmp <span class=\"sy0\">=</span> a<span class=\"br0\">[</span>k<span class=\"br0\">]</span><br/>        a<span class=\"br0\">[</span>k<span class=\"br0\">]</span> <span class=\"sy0\">=</span> a<span class=\"br0\">[</span>iMax<span class=\"br0\">]</span><br/>        a<span class=\"br0\">[</span>iMax<span class=\"br0\">]</span> <span class=\"sy0\">=</span> tmp<br/>        <a href=\"http://scala-lang.org\"><span class=\"kw1\">for</span></a> <span class=\"br0\">(</span>i in k + <span class=\"nu0\">1</span> until m<span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>            <a href=\"http://scala-lang.org\"><span class=\"kw1\">for</span></a> <span class=\"br0\">(</span>j in k + <span class=\"nu0\">1</span>..<span class=\"me1\">m</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>                a<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>j<span class=\"br0\">]</span> -<span class=\"sy0\">=</span> a<span class=\"br0\">[</span>k<span class=\"br0\">]</span><span class=\"br0\">[</span>j<span class=\"br0\">]</span> <span class=\"sy0\">*</span> a<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"br0\">]</span> / a<span class=\"br0\">[</span>k<span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"br0\">]</span><br/>            <span class=\"br0\">}</span><br/>            a<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"nu0\">0.0</span><br/>        <span class=\"br0\">}</span><br/>    <span class=\"br0\">}</span><br/>    <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> x <span class=\"sy0\">=</span> DoubleArray<span class=\"br0\">(</span>m<span class=\"br0\">)</span><br/>    <a href=\"http://scala-lang.org\"><span class=\"kw1\">for</span></a> <span class=\"br0\">(</span>i in m - <span class=\"nu0\">1</span> downTo <span class=\"nu0\">0</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>        x<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">=</span> a<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>m<span class=\"br0\">]</span><br/>        <a href=\"http://scala-lang.org\"><span class=\"kw1\">for</span></a> <span class=\"br0\">(</span>j in i + <span class=\"nu0\">1</span> until m<span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>            x<span class=\"br0\">[</span>i<span class=\"br0\">]</span> -<span class=\"sy0\">=</span> a<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>j<span class=\"br0\">]</span> <span class=\"sy0\">*</span> x<span class=\"br0\">[</span>j<span class=\"br0\">]</span><br/>        <span class=\"br0\">}</span><br/>        x<span class=\"br0\">[</span>i<span class=\"br0\">]</span> /<span class=\"sy0\">=</span> a<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>i<span class=\"br0\">]</span><br/>    <span class=\"br0\">}</span><br/>    <a href=\"http://scala-lang.org\"><span class=\"kw1\">return</span></a> x<br/><span class=\"br0\">}</span><br/>\u00a0<br/>fun main<span class=\"br0\">(</span>args<span class=\"sy0\">:</span> Array<span class=\"sy0\">&lt;</span>String<span class=\"sy0\">&gt;</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>    <a href=\"http://scala-lang.org\"><span class=\"kw1\">val</span></a> x <span class=\"sy0\">=</span> gaussPartial<span class=\"br0\">(</span>ta, tb<span class=\"br0\">)</span><br/>    println<span class=\"br0\">(</span>x.<span class=\"me1\">asList</span><span class=\"br0\">(</span><span class=\"br0\">)</span><span class=\"br0\">)</span><br/>    <a href=\"http://scala-lang.org\"><span class=\"kw1\">for</span></a> <span class=\"br0\">(</span><span class=\"br0\">(</span>i, xi<span class=\"br0\">)</span> in x.<span class=\"me1\">withIndex</span><span class=\"br0\">(</span><span class=\"br0\">)</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>        <a href=\"http://scala-lang.org\"><span class=\"kw1\">if</span></a> <span class=\"br0\">(</span>Math.<span class=\"me1\">abs</span><span class=\"br0\">(</span>tx<span class=\"br0\">[</span>i<span class=\"br0\">]</span> - xi<span class=\"br0\">)</span> <span class=\"sy0\">&gt;</span> EPSILON<span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>            println<span class=\"br0\">(</span><span class=\"st0\">\"Out of tolerance.\"</span><span class=\"br0\">)</span><br/>            println<span class=\"br0\">(</span><span class=\"st0\">\"Expected values are ${tx.asList()}\"</span><span class=\"br0\">)</span><br/>            <a href=\"http://scala-lang.org\"><span class=\"kw1\">return</span></a><br/>        <span class=\"br0\">}</span><br/>    <span class=\"br0\">}</span><br/><span class=\"br0\">}</span></pre>"}, {"lang": "M2000 Interpreter", "loc": 101, "block": "<pre class=\"text highlighted_source\">\u00a0<br/>module checkit {<br/>      Dim Base 1, a(6, 6), b(6)<br/>      a(1,1)= 1.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.00, 0.63, 0.39, 0.25, 0.16, 0.10, 1.00, 1.26, 1.58, 1.98, 2.49, 3.13, 1.00, 1.88, 3.55, 6.70, 12.62, 23.80, 1.00, 2.51, 6.32, 15.88, 39.90, 100.28, 1.00, 3.14, 9.87, 31.01, 97.41, 306.02<br/>      \\\\ remove \\\\ to feed next array<br/>      \\\\ a(1,1)=1.1,0.12,0.13,0.12,0.14,-0.12,1.21,0.63,0.39,0.25,0.16,0.1,1.03,1.26,1.58,1.98,2.49,3.13, 1.06,1.88,3.55,6.7,12.62,23.8, 1.12,2.51,6.32,15.88,39.9,100.28,1.16,3.14,9.87,31.01,97.41,306.02<br/>      for i=1 to 6\u00a0: for j=1 to 6\u00a0: a(i,j)=val(a(i,j)-&gt;Decimal)\u00a0:Next j:Next i<br/>      b(1)=-0.01, 0.61, 0.91, 0.99, 0.60, 0.02<br/>      for i=1 to 6\u00a0: b(i)=val(b(i)-&gt;Decimal)\u00a0:Next i<br/>      function GaussJordan(a(), b()) {<br/>            cols=dimension(a(),1)<br/>            rows=dimension(a(),2)<br/>            \\\\ make augmented matrix<br/>            Dim Base 1, a(cols, rows)<br/>            \\\\ feed array with rationals<br/>            Dim Base 1, b(Len(b()))<br/>            for diag=1 to rows {<br/>                        max_row=diag<br/>                        max_val=abs(a(diag, diag))<br/>                        if diag&lt;rows Then {<br/>                              for ro=diag+1 to rows {<br/>                                    d=abs(a(ro, diag))<br/>                                    if d&gt;max_val then max_row=ro\u00a0: max_val=d<br/>                              }<br/>                        }<br/>            \\\\         SwapRows diag, max_row<br/>                        if diag&lt;&gt;max_row then {<br/>                              for i=1 to cols {<br/>                                    swap a(diag, i), a(max_row, i)<br/>                              }<br/>                              swap b(diag), b(max_row)<br/>                        }<br/>                        invd= a(diag, diag)<br/>                        if diag&lt;=cols then {<br/>                              for col=diag to cols {<br/>                                    a(diag, col)/=invd<br/>                              }<br/>                        }<br/>                        b(diag)/=invd<br/>                        for ro=1 to rows {<br/>                              d1=a(ro,diag)<br/>                              d2=d1*b(diag)<br/>                              if ro&lt;&gt;diag Then {<br/>                                         for col=diag to cols {a(ro, col)-=d1*a(diag, col)}<br/>                                          b(ro)-=d2  <br/>                              }<br/>                        }        <br/>                  }<br/>            =b()<br/>      }<br/>      Function ArrayLines$(a(), leftmargin=6, maxwidth=8,decimals$=\"\") {<br/>            \\\\ defualt  no set  decimals, can show any number<br/>            ex$={<br/>            }<br/>           const way$=\", {0:\"+decimals$+\":-\"+str$(maxwidth,\"\")+\"}\"<br/>            if dimension(a())=1 then {<br/>                  m=each(a())<br/>                  while m {ex$+=format$(way$,array(m))}<br/>                  Insert 3, 2  ex$=string$(\" \", leftmargin)<br/>                  =ex$\u00a0:    Break<br/>            } <br/>            for i=1 to dimension(a(),1)  {<br/>                  ex1$=\"\"<br/>                  for j=1 to dimension(a(),2 ) {<br/>                              ex1$+=format$(way$,a(i,j))<br/>                  }<br/>                  Insert 1,2  ex1$=string$(\" \", leftmargin)<br/>                  ex$+=ex1$+{<br/>                  }<br/>            }<br/>            =ex$<br/>      }<br/>      mm=GaussJordan(a(), b())<br/>            c=each(mm)<br/>            while c {<br/>                  print array(c)<br/>            }<br/>      \\\\ check accuracy<br/>      link mm to r()<br/>      \\\\ prepare output document<br/>      Document out$={Algorithm using decimals<br/>                  }+\"Matrix A:\"+ArrayLines$(a(),,,\"2\")+{<br/>                  }+\"Vector B:\"+ArrayLines$(b(),,,\"2\")+{<br/>                  }+\"Solution: \"+{<br/>                  }<br/>      acc=25<br/>      for i=1 to  dimension(a(),1)<br/>            sum=a(1,1)-a(1,1)<br/>            For j=1 to dimension(a(),2)<br/>                  sum+=r(j)*a(i,j)<br/>            next j<br/>            p$=format$(\"Coef. {0::-2},  rounding to {1} decimal, compare {2:-5}, solution: {3}\", i, acc, round(sum-b(i),acc)<a class=\"__cf_email__\" data-cfemail=\"1b262b5b\" href=\"/cdn-cgi/l/email-protection\">[email\u00a0protected]</a>, r(i) )<br/>            Print p$<br/>            Out$=p$+{<br/>            }<br/>      next i<br/>      Report out$<br/>      clipboard out$<br/>}<br/>checkit<br/>\u00a0</pre>"}, {"lang": "Mathematica / Wolfram Language", "loc": 1, "block": "<pre class=\"text highlighted_source\">GaussianElimination[A_?MatrixQ, b_?VectorQ]\u00a0:= Last /@ RowReduce[Flatten /@ Transpose[{A, b}]]</pre>"}, {"lang": "MATLAB", "loc": 72, "block": "<pre class=\"matlab highlighted_source\">\u00a0<br/><span class=\"kw1\">function</span> <span class=\"br0\">[</span> x <span class=\"br0\">]</span> = GaussElim<span class=\"br0\">(</span> A, b<span class=\"br0\">)</span><br/>\u00a0<br/><span class=\"co1\">% Ensures A is n by n</span><br/>sz = <a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/size.html\"><span class=\"kw2\">size</span></a><span class=\"br0\">(</span>A<span class=\"br0\">)</span>;<br/><span class=\"kw1\">if</span> sz<span class=\"br0\">(</span><span class=\"nu0\">1</span><span class=\"br0\">)</span>~=sz<span class=\"br0\">(</span><span class=\"nu0\">2</span><span class=\"br0\">)</span><br/>    <a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/fprintf.html\"><span class=\"kw2\">fprintf</span></a><span class=\"br0\">(</span><span class=\"co2\">'A is not n by n\\n'</span><span class=\"br0\">)</span>;<br/>    <a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/clear.html\"><span class=\"kw2\">clear</span></a> x;<br/>    <span class=\"kw1\">return</span>;<br/><span class=\"kw1\">end</span><br/>\u00a0<br/>n = sz<span class=\"br0\">(</span><span class=\"nu0\">1</span><span class=\"br0\">)</span>;<br/>\u00a0<br/><span class=\"co1\">% Ensures b is n x 1.</span><br/><span class=\"kw1\">if</span> n~=sz<span class=\"br0\">(</span><span class=\"nu0\">1</span><span class=\"br0\">)</span><br/>    <a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/fprintf.html\"><span class=\"kw2\">fprintf</span></a><span class=\"br0\">(</span><span class=\"co2\">'b is not 1 by n.\\n'</span><span class=\"br0\">)</span>;<br/>    <span class=\"kw1\">return</span><br/><span class=\"kw1\">end</span><br/>\u00a0<br/>x = <a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/zeros.html\"><span class=\"kw2\">zeros</span></a><span class=\"br0\">(</span>n,<span class=\"nu0\">1</span><span class=\"br0\">)</span>;<br/>aug = <span class=\"br0\">[</span>A b<span class=\"br0\">]</span>;<br/>tempmatrix = aug;<br/>\u00a0<br/><span class=\"kw1\">for</span> <a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/i.html\"><span class=\"kw2\"><span class=\"re0\">i</span></span></a>=<span class=\"nu0\">2</span>:sz<span class=\"br0\">(</span><span class=\"nu0\">1</span><span class=\"br0\">)</span><br/>\u00a0<br/>\u00a0<br/>    <span class=\"co1\">% Find maximum of row and divide by the maximum</span><br/>    tempmatrix<span class=\"br0\">(</span><span class=\"nu0\">1</span>,:<span class=\"br0\">)</span> = tempmatrix<span class=\"br0\">(</span><span class=\"nu0\">1</span>,:<span class=\"br0\">)</span>/<a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/max.html\"><span class=\"kw2\">max</span></a><span class=\"br0\">(</span>tempmatrix<span class=\"br0\">(</span><span class=\"nu0\">1</span>,:<span class=\"br0\">)</span><span class=\"br0\">)</span>;<br/>\u00a0<br/>    <span class=\"co1\">% Finds the maximum in column</span><br/>    temp = <a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/find.html\"><span class=\"kw2\">find</span></a><span class=\"br0\">(</span><a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/abs.html\"><span class=\"kw2\">abs</span></a><span class=\"br0\">(</span>tempmatrix<span class=\"br0\">)</span> - <a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/max.html\"><span class=\"kw2\">max</span></a><span class=\"br0\">(</span><a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/abs.html\"><span class=\"kw2\">abs</span></a><span class=\"br0\">(</span>tempmatrix<span class=\"br0\">(</span>:,<span class=\"nu0\">1</span><span class=\"br0\">)</span><span class=\"br0\">)</span><span class=\"br0\">)</span><span class=\"br0\">)</span>;<br/>    <span class=\"kw1\">if</span> <a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/length.html\"><span class=\"kw2\">length</span></a><span class=\"br0\">(</span>temp<span class=\"br0\">)</span>&gt;<span class=\"nu0\">2</span><br/>        <span class=\"kw1\">for</span> <a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/j.html\"><span class=\"kw2\"><span class=\"re0\">j</span></span></a>=<span class=\"nu0\">1</span>:<a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/length.html\"><span class=\"kw2\">length</span></a><span class=\"br0\">(</span>temp<span class=\"br0\">)</span>-<span class=\"nu0\">1</span><br/>            <span class=\"kw1\">if</span> <a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/j.html\"><span class=\"kw2\"><span class=\"re0\">j</span></span></a>~=temp<span class=\"br0\">(</span><a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/j.html\"><span class=\"kw2\"><span class=\"re0\">j</span></span></a><span class=\"br0\">)</span><br/>                maxi = <a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/j.html\"><span class=\"kw2\"><span class=\"re0\">j</span></span></a>; <span class=\"co1\">%maxi = column number of maximum</span><br/>                <span class=\"kw1\">break</span>;<br/>            <span class=\"kw1\">end</span><br/>        <span class=\"kw1\">end</span><br/>    <span class=\"kw1\">else</span> <span class=\"co1\">% length(temp)==2</span><br/>        maxi=<span class=\"nu0\">1</span>;<br/>    <span class=\"kw1\">end</span><br/>\u00a0<br/>    <span class=\"co1\">% Row swap if maxi is not 1</span><br/>    <span class=\"kw1\">if</span> maxi~=<span class=\"nu0\">1</span><br/>        temp = tempmatrix<span class=\"br0\">(</span>maxi,:<span class=\"br0\">)</span>;<br/>        tempmatrix<span class=\"br0\">(</span>maxi,:<span class=\"br0\">)</span> = tempmatrix<span class=\"br0\">(</span><span class=\"nu0\">1</span>,:<span class=\"br0\">)</span>;<br/>        tempmatrix<span class=\"br0\">(</span><span class=\"nu0\">1</span>,:<span class=\"br0\">)</span> = temp;<br/>    <span class=\"kw1\">end</span>    <br/>\u00a0<br/>    <span class=\"co1\">% Row reducing</span><br/>    <span class=\"kw1\">for</span> <a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/j.html\"><span class=\"kw2\"><span class=\"re0\">j</span></span></a>=<span class=\"nu0\">2</span>:<a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/length.html\"><span class=\"kw2\">length</span></a><span class=\"br0\">(</span>tempmatrix<span class=\"br0\">)</span>-<span class=\"nu0\">1</span><br/>        tempmatrix<span class=\"br0\">(</span><a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/j.html\"><span class=\"kw2\"><span class=\"re0\">j</span></span></a>,:<span class=\"br0\">)</span> = tempmatrix<span class=\"br0\">(</span><a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/j.html\"><span class=\"kw2\"><span class=\"re0\">j</span></span></a>,:<span class=\"br0\">)</span>-tempmatrix<span class=\"br0\">(</span><a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/j.html\"><span class=\"kw2\"><span class=\"re0\">j</span></span></a>,<span class=\"nu0\">1</span><span class=\"br0\">)</span>/tempmatrix<span class=\"br0\">(</span><span class=\"nu0\">1</span>,<span class=\"nu0\">1</span><span class=\"br0\">)</span>*tempmatrix<span class=\"br0\">(</span><span class=\"nu0\">1</span>,:<span class=\"br0\">)</span>;<br/>        <span class=\"kw1\">if</span> tempmatrix<span class=\"br0\">(</span><a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/j.html\"><span class=\"kw2\"><span class=\"re0\">j</span></span></a>,<a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/j.html\"><span class=\"kw2\"><span class=\"re0\">j</span></span></a><span class=\"br0\">)</span>==<span class=\"nu0\">0</span> || isnan<span class=\"br0\">(</span>tempmatrix<span class=\"br0\">(</span><a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/j.html\"><span class=\"kw2\"><span class=\"re0\">j</span></span></a>,<a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/j.html\"><span class=\"kw2\"><span class=\"re0\">j</span></span></a><span class=\"br0\">)</span><span class=\"br0\">)</span> || <a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/abs.html\"><span class=\"kw2\">abs</span></a><span class=\"br0\">(</span>tempmatrix<span class=\"br0\">(</span><a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/j.html\"><span class=\"kw2\"><span class=\"re0\">j</span></span></a>,<a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/j.html\"><span class=\"kw2\"><span class=\"re0\">j</span></span></a><span class=\"br0\">)</span><span class=\"br0\">)</span>==<a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/inf.html\"><span class=\"kw2\">Inf</span></a><br/>            <a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/fprintf.html\"><span class=\"kw2\">fprintf</span></a><span class=\"br0\">(</span><span class=\"co2\">'Error: Matrix is singular.\\n'</span><span class=\"br0\">)</span>;<br/>            <a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/clear.html\"><span class=\"kw2\">clear</span></a> x;<br/>            <span class=\"kw1\">return</span><br/>        <span class=\"kw1\">end</span><br/>    <span class=\"kw1\">end</span><br/>    aug<span class=\"br0\">(</span><span class=\"re0\">i</span>-<span class=\"nu0\">1</span>:<span class=\"kw1\">end</span>,<span class=\"re0\">i</span>-<span class=\"nu0\">1</span>:<span class=\"kw1\">end</span><span class=\"br0\">)</span> = tempmatrix;<br/>\u00a0<br/>    <span class=\"co1\">% Decrease matrix size</span><br/>    tempmatrix = tempmatrix<span class=\"br0\">(</span><span class=\"nu0\">2</span>:<span class=\"kw1\">end</span>,<span class=\"nu0\">2</span>:<span class=\"kw1\">end</span><span class=\"br0\">)</span>;<br/><span class=\"kw1\">end</span><br/>\u00a0<br/><span class=\"co1\">% Backwards Substitution</span><br/>x<span class=\"br0\">(</span><span class=\"kw1\">end</span><span class=\"br0\">)</span> = aug<span class=\"br0\">(</span><span class=\"kw1\">end</span>,<span class=\"kw1\">end</span><span class=\"br0\">)</span>/aug<span class=\"br0\">(</span><span class=\"kw1\">end</span>,end-<span class=\"nu0\">1</span><span class=\"br0\">)</span>;<br/><span class=\"kw1\">for</span> <a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/i.html\"><span class=\"kw2\"><span class=\"re0\">i</span></span></a>=n-<span class=\"nu0\">1</span>:-<span class=\"nu0\">1</span>:<span class=\"nu0\">1</span><br/>    x<span class=\"br0\">(</span><a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/i.html\"><span class=\"kw2\"><span class=\"re0\">i</span></span></a><span class=\"br0\">)</span> = <span class=\"br0\">(</span>aug<span class=\"br0\">(</span><a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/i.html\"><span class=\"kw2\"><span class=\"re0\">i</span></span></a>,<span class=\"kw1\">end</span><span class=\"br0\">)</span>-dot<span class=\"br0\">(</span>aug<span class=\"br0\">(</span><a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/i.html\"><span class=\"kw2\"><span class=\"re0\">i</span></span></a>,<span class=\"nu0\">1</span>:end-<span class=\"nu0\">1</span><span class=\"br0\">)</span>,x<span class=\"br0\">)</span><span class=\"br0\">)</span>/aug<span class=\"br0\">(</span><a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/i.html\"><span class=\"kw2\"><span class=\"re0\">i</span></span></a>,<a href=\"http://www.mathworks.com/access/helpdesk/help/techdoc/ref/i.html\"><span class=\"kw2\"><span class=\"re0\">i</span></span></a><span class=\"br0\">)</span>;<br/><span class=\"kw1\">end</span><br/>\u00a0<br/><span class=\"kw1\">end</span><br/>\u00a0</pre>"}, {"lang": "OCaml", "loc": 30, "block": "<pre class=\"ocaml highlighted_source\">\u00a0<br/><span class=\"kw1\">module</span> <a href=\"http://caml.inria.fr/pub/docs/manual-ocaml/libref/Array.html\"><span class=\"kw2\">Array</span></a> <span class=\"sy0\">=</span> <span class=\"kw1\">struct</span><br/>  <span class=\"kw1\">include</span> <a href=\"http://caml.inria.fr/pub/docs/manual-ocaml/libref/Array.html\"><span class=\"kw2\">Array</span></a><br/>  <span class=\"co1\">(* Computes: f a.(0) + f a.(1) + ... where + is 'g'. *)</span><br/>  <span class=\"kw1\">let</span> foldmap g f a <span class=\"sy0\">=</span><br/>    <span class=\"kw1\">let</span> n <span class=\"sy0\">=</span> <a href=\"http://caml.inria.fr/pub/docs/manual-ocaml/libref/Array.html\"><span class=\"kw2\">Array</span></a><span class=\"sy0\">.</span>length a <span class=\"kw1\">in</span><br/>    <span class=\"kw1\">let</span> <span class=\"kw1\">rec</span> aux acc i <span class=\"sy0\">=</span><br/>      <span class=\"kw1\">if</span> i <span class=\"sy0\">&gt;=</span> n <span class=\"kw1\">then</span> acc <span class=\"kw1\">else</span> aux <span class=\"br0\">(</span>g acc <span class=\"br0\">(</span>f a<span class=\"sy0\">.</span><span class=\"br0\">(</span>i<span class=\"br0\">)</span><span class=\"br0\">)</span><span class=\"br0\">)</span> <span class=\"br0\">(</span><a href=\"http://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VALsucc\"><span class=\"kw3\">succ</span></a> i<span class=\"br0\">)</span><br/>    <span class=\"kw1\">in</span> aux <span class=\"br0\">(</span>f a<span class=\"sy0\">.</span><span class=\"br0\">(</span><span class=\"nu0\">0</span><span class=\"br0\">)</span><span class=\"br0\">)</span> <span class=\"nu0\">1</span><br/>\u00a0<br/>  <span class=\"co1\">(* like the stdlib fold_left, but also provides index to f *)</span><br/>  <span class=\"kw1\">let</span> foldi_left f x a <span class=\"sy0\">=</span><br/>    <span class=\"kw1\">let</span> r <span class=\"sy0\">=</span> <span class=\"kw1\">ref</span> x <span class=\"kw1\">in</span><br/>    <span class=\"kw1\">for</span> i <span class=\"sy0\">=</span> <span class=\"nu0\">0</span> <span class=\"kw1\">to</span> length a <span class=\"sy0\">-</span> <span class=\"nu0\">1</span> <span class=\"kw1\">do</span><br/>      r <span class=\"sy0\">:=</span> f i <span class=\"sy0\">!</span>r <span class=\"br0\">(</span>unsafe_get a i<span class=\"br0\">)</span><br/>    <span class=\"kw1\">done</span><span class=\"sy0\">;</span><br/>    <span class=\"sy0\">!</span>r<br/><span class=\"kw1\">end</span><br/>\u00a0<br/><span class=\"kw1\">let</span> foldmap_range g f <span class=\"br0\">(</span>a,b<span class=\"br0\">)</span> <span class=\"sy0\">=</span><br/>  <span class=\"kw1\">let</span> <span class=\"kw1\">rec</span> aux acc n <span class=\"sy0\">=</span><br/>    <span class=\"kw1\">let</span> n <span class=\"sy0\">=</span> <a href=\"http://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VALsucc\"><span class=\"kw3\">succ</span></a> n <span class=\"kw1\">in</span><br/>    <span class=\"kw1\">if</span> n <span class=\"sy0\">&gt;</span> b <span class=\"kw1\">then</span> acc <span class=\"kw1\">else</span> aux <span class=\"br0\">(</span>g acc <span class=\"br0\">(</span>f n<span class=\"br0\">)</span><span class=\"br0\">)</span> n<br/>  <span class=\"kw1\">in</span> aux <span class=\"br0\">(</span>f a<span class=\"br0\">)</span> a<br/>\u00a0<br/><span class=\"kw1\">let</span> fold_range f init <span class=\"br0\">(</span>a,b<span class=\"br0\">)</span> <span class=\"sy0\">=</span><br/>  <span class=\"kw1\">let</span> <span class=\"kw1\">rec</span> aux acc n <span class=\"sy0\">=</span><br/>    <span class=\"kw1\">if</span> n <span class=\"sy0\">&gt;</span> b <span class=\"kw1\">then</span> acc <span class=\"kw1\">else</span> aux <span class=\"br0\">(</span>f acc n<span class=\"br0\">)</span> <span class=\"br0\">(</span><a href=\"http://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VALsucc\"><span class=\"kw3\">succ</span></a> n<span class=\"br0\">)</span><br/>  <span class=\"kw1\">in</span> aux init a<br/>\u00a0</pre>"}, {"lang": "PARI/GP", "loc": 1, "block": "<pre class=\"parigp highlighted_source\"><span class=\"kw1\">matsolve</span><span class=\"br0\">(</span>A<span class=\"sy0\">,</span>B<span class=\"br0\">)</span></pre>"}, {"lang": "Perl", "loc": 9, "block": "<pre class=\"perl highlighted_source\"><span class=\"kw2\">use</span> Math<span class=\"sy0\">::</span><span class=\"me2\">Matrix</span><span class=\"sy0\">;</span><br/><span class=\"kw1\">my</span> <span class=\"re0\">$a</span> <span class=\"sy0\">=</span> Math<span class=\"sy0\">::</span><span class=\"me2\">Matrix</span><span class=\"sy0\">-&gt;</span><span class=\"kw2\">new</span><span class=\"br0\">(</span><span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"sy0\">,</span><span class=\"nu0\">1</span><span class=\"sy0\">,</span><span class=\"nu0\">0</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>                          <span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"sy0\">,</span><span class=\"nu0\">0</span><span class=\"sy0\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>                          <span class=\"br0\">[</span><span class=\"nu0\">2</span><span class=\"sy0\">,</span><span class=\"nu0\">0</span><span class=\"sy0\">,</span><span class=\"nu0\">1</span><span class=\"br0\">]</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/><span class=\"kw1\">my</span> <span class=\"re0\">$b</span> <span class=\"sy0\">=</span> Math<span class=\"sy0\">::</span><span class=\"me2\">Matrix</span><span class=\"sy0\">-&gt;</span><span class=\"kw2\">new</span><span class=\"br0\">(</span><span class=\"br0\">[</span><span class=\"nu0\">1</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>                          <span class=\"br0\">[</span><span class=\"nu0\">2</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>                          <span class=\"br0\">[</span><span class=\"nu0\">4</span><span class=\"br0\">]</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/><span class=\"kw1\">my</span> <span class=\"re0\">$x</span> <span class=\"sy0\">=</span> <span class=\"re0\">$a</span><span class=\"sy0\">-&gt;</span><span class=\"me1\">concat</span><span class=\"br0\">(</span><span class=\"re0\">$b</span><span class=\"br0\">)</span><span class=\"sy0\">-&gt;</span><span class=\"me1\">solve</span><span class=\"sy0\">;</span><br/><a href=\"http://perldoc.perl.org/functions/print.html\"><span class=\"kw3\">print</span></a> <span class=\"re0\">$x</span><span class=\"sy0\">;</span></pre>"}, {"lang": "Perl 6", "loc": 58, "block": "<pre class=\"perl6 highlighted_source\"><span class=\"kw2\">sub</span> gauss<span class=\"sy0\">-</span>jordan<span class=\"sy0\">-</span>solve <span class=\"br0\">(</span><span class=\"re0\">@a</span><span class=\"sy0\">,</span> <span class=\"re0\">@b</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>    <span class=\"re0\">@b</span><span class=\"sy0\">.</span><span class=\"kw3\">kv</span><span class=\"sy0\">.</span><span class=\"kw3\">map</span><span class=\"sy0\">:</span> <span class=\"br0\">{</span> <span class=\"re0\">@a</span><span class=\"br0\">[</span><span class=\"re0\">$^k</span><span class=\"br0\">]</span><span class=\"sy0\">.</span><span class=\"me1\">append</span><span class=\"sy0\">:</span> <span class=\"re0\">$^v</span> <span class=\"br0\">}</span><span class=\"sy0\">;</span><br/>    <span class=\"re0\">@a</span><span class=\"sy0\">.</span><span class=\"re0\">&amp;rref</span><span class=\"br0\">[</span><span class=\"sy0\">*</span><span class=\"br0\">]</span>\u00bb<span class=\"br0\">[</span><span class=\"sy0\">*-</span><span class=\"nu0\">1</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/><span class=\"br0\">}</span><br/>\u00a0<br/><span class=\"co1\"># reduced row echelon form (Gauss-Jordan elimination)</span><br/><span class=\"kw2\">sub</span> rref <span class=\"br0\">(</span><span class=\"re0\">@m</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>    <span class=\"kw1\">return</span> <span class=\"kw1\">unless</span> <span class=\"re0\">@m</span><span class=\"sy0\">;</span><br/>    <span class=\"kw1\">my</span> <span class=\"br0\">(</span><span class=\"re0\">$lead</span><span class=\"sy0\">,</span> <span class=\"re0\">$rows</span><span class=\"sy0\">,</span> <span class=\"re0\">$cols</span><span class=\"br0\">)</span> <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"sy0\">+</span><span class=\"re0\">@m</span><span class=\"sy0\">,</span> <span class=\"sy0\">+</span><span class=\"re0\">@m</span><span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>\u00a0<br/>    <span class=\"kw1\">for</span> <span class=\"sy0\">^</span><span class=\"re0\">$rows</span> <span class=\"sy0\">-&gt;</span> <span class=\"re0\">$r</span> <span class=\"br0\">{</span><br/>        <span class=\"re0\">$lead</span> <span class=\"sy0\">&lt;</span> <span class=\"re0\">$cols</span> <span class=\"kw1\">or</span> <span class=\"kw1\">return</span> <span class=\"re0\">@m</span><span class=\"sy0\">;</span><br/>        <span class=\"kw1\">my</span> <span class=\"re0\">$i</span> <span class=\"sy0\">=</span> <span class=\"re0\">$r</span><span class=\"sy0\">;</span><br/>        <span class=\"kw1\">until</span> <span class=\"re0\">@m</span><span class=\"br0\">[</span><span class=\"re0\">$i</span><span class=\"sy0\">;</span><span class=\"re0\">$lead</span><span class=\"br0\">]</span> <span class=\"br0\">{</span><br/>            <span class=\"sy0\">++</span><span class=\"re0\">$i</span> <span class=\"sy0\">==</span> <span class=\"re0\">$rows</span> <span class=\"kw1\">or</span> <span class=\"kw1\">next</span><span class=\"sy0\">;</span><br/>            <span class=\"re0\">$i</span> <span class=\"sy0\">=</span> <span class=\"re0\">$r</span><span class=\"sy0\">;</span><br/>            <span class=\"sy0\">++</span><span class=\"re0\">$lead</span> <span class=\"sy0\">==</span> <span class=\"re0\">$cols</span> <span class=\"kw1\">and</span> <span class=\"kw1\">return</span> <span class=\"re0\">@m</span><span class=\"sy0\">;</span><br/>        <span class=\"br0\">}</span><br/>        <span class=\"re0\">@m</span><span class=\"br0\">[</span><span class=\"re0\">$i</span><span class=\"sy0\">,</span> <span class=\"re0\">$r</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"re0\">@m</span><span class=\"br0\">[</span><span class=\"re0\">$r</span><span class=\"sy0\">,</span> <span class=\"re0\">$i</span><span class=\"br0\">]</span> <span class=\"kw1\">if</span> <span class=\"re0\">$r</span> <span class=\"sy0\">!=</span> <span class=\"re0\">$i</span><span class=\"sy0\">;</span><br/>        <span class=\"kw1\">my</span> <span class=\"re0\">$lv</span> <span class=\"sy0\">=</span> <span class=\"re0\">@m</span><span class=\"br0\">[</span><span class=\"re0\">$r</span><span class=\"sy0\">;</span><span class=\"re0\">$lead</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>        <span class=\"re0\">@m</span><span class=\"br0\">[</span><span class=\"re0\">$r</span><span class=\"br0\">]</span>\u00a0\u00bb<span class=\"sy0\">/=</span>\u00bb <span class=\"re0\">$lv</span><span class=\"sy0\">;</span><br/>        <span class=\"kw1\">for</span> <span class=\"sy0\">^</span><span class=\"re0\">$rows</span> <span class=\"sy0\">-&gt;</span> <span class=\"re0\">$n</span> <span class=\"br0\">{</span><br/>            <span class=\"kw1\">next</span> <span class=\"kw1\">if</span> <span class=\"re0\">$n</span> <span class=\"sy0\">==</span> <span class=\"re0\">$r</span><span class=\"sy0\">;</span><br/>            <span class=\"re0\">@m</span><span class=\"br0\">[</span><span class=\"re0\">$n</span><span class=\"br0\">]</span>\u00a0\u00bb<span class=\"sy0\">-=</span>\u00bb <span class=\"re0\">@m</span><span class=\"br0\">[</span><span class=\"re0\">$r</span><span class=\"br0\">]</span>\u00a0\u00bb<span class=\"sy0\">*</span>\u00bb <span class=\"br0\">(</span><span class=\"re0\">@m</span><span class=\"br0\">[</span><span class=\"re0\">$n</span><span class=\"sy0\">;</span><span class=\"re0\">$lead</span><span class=\"br0\">]</span> <span class=\"sy0\">//</span> <span class=\"nu0\">0</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>        <span class=\"br0\">}</span><br/>        <span class=\"sy0\">++</span><span class=\"re0\">$lead</span><span class=\"sy0\">;</span><br/>    <span class=\"br0\">}</span><br/>    <span class=\"re0\">@m</span><br/><span class=\"br0\">}</span><br/>\u00a0<br/><span class=\"kw2\">sub</span> rat<span class=\"sy0\">-</span>or<span class=\"sy0\">-</span>int <span class=\"br0\">(</span><span class=\"re0\">$num</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>    <span class=\"kw1\">return</span> <span class=\"re0\">$num</span> <span class=\"kw1\">unless</span> <span class=\"re0\">$num</span> <span class=\"sy0\">~~</span> Rat<span class=\"sy0\">;</span><br/>    <span class=\"kw1\">return</span> <span class=\"re0\">$num</span><span class=\"sy0\">.</span><span class=\"me1\">narrow</span> <span class=\"kw1\">if</span> <span class=\"re0\">$num</span><span class=\"sy0\">.</span><span class=\"me1\">narrow</span><span class=\"sy0\">.</span><span class=\"me1\">WHAT</span> <span class=\"sy0\">~~</span> Int<span class=\"sy0\">;</span><br/>    <span class=\"re0\">$num</span><span class=\"sy0\">.</span><span class=\"kw3\">nude</span><span class=\"sy0\">.</span><span class=\"kw3\">join</span><span class=\"sy0\">:</span> <span class=\"st_h\">'/'</span><span class=\"sy0\">;</span><br/><span class=\"br0\">}</span><br/>\u00a0<br/><span class=\"kw2\">sub</span> say<span class=\"sy0\">-</span>it <span class=\"br0\">(</span><span class=\"re0\">$message</span><span class=\"sy0\">,</span> <span class=\"re0\">@array</span><span class=\"sy0\">,</span> <span class=\"re0\">$fmt</span> <span class=\"sy0\">=</span> <span class=\"st0\">\"\u00a0%8s\"</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>    <span class=\"kw3\">say</span> <span class=\"st0\">\"<span class=\"es0\">\\n</span>$message\"</span><span class=\"sy0\">;</span><br/>    <span class=\"re0\">$_</span>\u00bb<span class=\"sy0\">.</span><span class=\"re0\">&amp;rat</span><span class=\"sy0\">-</span>or<span class=\"sy0\">-</span>int<span class=\"sy0\">.</span><span class=\"kw3\">fmt</span><span class=\"br0\">(</span><span class=\"re0\">$fmt</span><span class=\"br0\">)</span><span class=\"sy0\">.</span><span class=\"me1\">put</span> <span class=\"kw1\">for</span> <span class=\"re0\">@array</span><span class=\"sy0\">;</span><br/><span class=\"br0\">}</span><br/>\u00a0<br/><span class=\"kw1\">my</span> <span class=\"re0\">@a</span> <span class=\"sy0\">=</span> <span class=\"br0\">(</span><br/>    <span class=\"br0\">[</span> <span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.00</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0.00</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0.00</span><span class=\"sy0\">,</span>   <span class=\"nu0\">0.00</span> <span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>    <span class=\"br0\">[</span> <span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.63</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.39</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0.25</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0.16</span><span class=\"sy0\">,</span>   <span class=\"nu0\">0.10</span> <span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>    <span class=\"br0\">[</span> <span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">1.26</span><span class=\"sy0\">,</span> <span class=\"nu0\">1.58</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1.98</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2.49</span><span class=\"sy0\">,</span>   <span class=\"nu0\">3.13</span> <span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>    <span class=\"br0\">[</span> <span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">1.88</span><span class=\"sy0\">,</span> <span class=\"nu0\">3.55</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6.70</span><span class=\"sy0\">,</span> <span class=\"nu0\">12.62</span><span class=\"sy0\">,</span>  <span class=\"nu0\">23.80</span> <span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>    <span class=\"br0\">[</span> <span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">2.51</span><span class=\"sy0\">,</span> <span class=\"nu0\">6.32</span><span class=\"sy0\">,</span> <span class=\"nu0\">15.88</span><span class=\"sy0\">,</span> <span class=\"nu0\">39.90</span><span class=\"sy0\">,</span> <span class=\"nu0\">100.28</span> <span class=\"br0\">]</span><span class=\"sy0\">,</span><br/>    <span class=\"br0\">[</span> <span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">3.14</span><span class=\"sy0\">,</span> <span class=\"nu0\">9.87</span><span class=\"sy0\">,</span> <span class=\"nu0\">31.01</span><span class=\"sy0\">,</span> <span class=\"nu0\">97.41</span><span class=\"sy0\">,</span> <span class=\"nu0\">306.02</span> <span class=\"br0\">]</span><span class=\"sy0\">,</span><br/><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/><span class=\"kw1\">my</span> <span class=\"re0\">@b</span> <span class=\"sy0\">=</span> <span class=\"br0\">(</span> <span class=\"sy0\">-</span><span class=\"nu0\">0.01</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.61</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.91</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.99</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.60</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.02</span> <span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\u00a0<br/>say<span class=\"sy0\">-</span>it <span class=\"st_h\">'A matrix:'</span><span class=\"sy0\">,</span> <span class=\"re0\">@a</span><span class=\"sy0\">,</span> <span class=\"st0\">\"%6.2f\"</span><span class=\"sy0\">;</span><br/>say<span class=\"sy0\">-</span>it <span class=\"st_h\">'or, A in exact rationals:'</span><span class=\"sy0\">,</span> <span class=\"re0\">@a</span><span class=\"sy0\">;</span><br/>say<span class=\"sy0\">-</span>it <span class=\"st_h\">'B matrix:'</span><span class=\"sy0\">,</span> <span class=\"re0\">@b</span><span class=\"sy0\">,</span> <span class=\"st0\">\"%6.2f\"</span><span class=\"sy0\">;</span><br/>say<span class=\"sy0\">-</span>it <span class=\"st_h\">'or, B in exact rationals:'</span><span class=\"sy0\">,</span> <span class=\"re0\">@b</span><span class=\"sy0\">;</span><br/>say<span class=\"sy0\">-</span>it <span class=\"st_h\">'x matrix:'</span><span class=\"sy0\">,</span> <span class=\"br0\">(</span><span class=\"kw1\">my</span> <span class=\"re0\">@gj</span> <span class=\"sy0\">=</span> gauss<span class=\"sy0\">-</span>jordan<span class=\"sy0\">-</span>solve <span class=\"re0\">@a</span><span class=\"sy0\">,</span> <span class=\"re0\">@b</span><span class=\"br0\">)</span><span class=\"sy0\">,</span> <span class=\"st0\">\"%16.12f\"</span><span class=\"sy0\">;</span><br/>say<span class=\"sy0\">-</span>it <span class=\"st_h\">'or, x in exact rationals:'</span><span class=\"sy0\">,</span> <span class=\"re0\">@gj</span><span class=\"sy0\">,</span> <span class=\"st0\">\"%28s\"</span><span class=\"sy0\">;</span><br/>\u00a0</pre>"}, {"lang": "PHP", "loc": 75, "block": "<pre class=\"php highlighted_source\"><span class=\"kw2\">function</span> swap_rows<span class=\"br0\">(</span><span class=\"sy0\">&amp;</span><span class=\"re0\">$a</span><span class=\"sy0\">,</span> <span class=\"sy0\">&amp;</span><span class=\"re0\">$b</span><span class=\"sy0\">,</span> <span class=\"re0\">$r1</span><span class=\"sy0\">,</span> <span class=\"re0\">$r2</span><span class=\"br0\">)</span><br/><span class=\"br0\">{</span><br/>    <span class=\"kw1\">if</span> <span class=\"br0\">(</span><span class=\"re0\">$r1</span> <span class=\"sy0\">==</span> <span class=\"re0\">$r2</span><span class=\"br0\">)</span> <span class=\"kw1\">return</span><span class=\"sy0\">;</span><br/>\u00a0<br/>    <span class=\"re0\">$tmp</span> <span class=\"sy0\">=</span> <span class=\"re0\">$a</span><span class=\"br0\">[</span><span class=\"re0\">$r1</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>    <span class=\"re0\">$a</span><span class=\"br0\">[</span><span class=\"re0\">$r1</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"re0\">$a</span><span class=\"br0\">[</span><span class=\"re0\">$r2</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>    <span class=\"re0\">$a</span><span class=\"br0\">[</span><span class=\"re0\">$r2</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"re0\">$tmp</span><span class=\"sy0\">;</span><br/>\u00a0<br/>    <span class=\"re0\">$tmp</span> <span class=\"sy0\">=</span> <span class=\"re0\">$b</span><span class=\"br0\">[</span><span class=\"re0\">$r1</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>    <span class=\"re0\">$b</span><span class=\"br0\">[</span><span class=\"re0\">$r1</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"re0\">$b</span><span class=\"br0\">[</span><span class=\"re0\">$r2</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>    <span class=\"re0\">$b</span><span class=\"br0\">[</span><span class=\"re0\">$r2</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"re0\">$tmp</span><span class=\"sy0\">;</span><br/><span class=\"br0\">}</span><br/>\u00a0<br/><span class=\"kw2\">function</span> gauss_eliminate<span class=\"br0\">(</span><span class=\"re0\">$A</span><span class=\"sy0\">,</span> <span class=\"re0\">$b</span><span class=\"sy0\">,</span> <span class=\"re0\">$N</span><span class=\"br0\">)</span><br/><span class=\"br0\">{</span><br/>    <span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"re0\">$col</span> <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span> <span class=\"re0\">$col</span> <span class=\"sy0\">&lt;</span> <span class=\"re0\">$N</span><span class=\"sy0\">;</span> <span class=\"re0\">$col</span><span class=\"sy0\">++</span><span class=\"br0\">)</span><br/>    <span class=\"br0\">{</span><br/>        <span class=\"re0\">$j</span> <span class=\"sy0\">=</span> <span class=\"re0\">$col</span><span class=\"sy0\">;</span><br/>        <span class=\"re0\">$max</span> <span class=\"sy0\">=</span> <span class=\"re0\">$A</span><span class=\"br0\">[</span><span class=\"re0\">$j</span><span class=\"br0\">]</span><span class=\"br0\">[</span><span class=\"re0\">$j</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>\u00a0<br/>        <span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"re0\">$i</span> <span class=\"sy0\">=</span> <span class=\"re0\">$col</span> <span class=\"sy0\">+</span> <span class=\"nu0\">1</span><span class=\"sy0\">;</span> <span class=\"re0\">$i</span> <span class=\"sy0\">&lt;</span> <span class=\"re0\">$N</span><span class=\"sy0\">;</span> <span class=\"re0\">$i</span><span class=\"sy0\">++</span><span class=\"br0\">)</span><br/>        <span class=\"br0\">{</span><br/>            <span class=\"re0\">$tmp</span> <span class=\"sy0\">=</span> <a href=\"http://www.php.net/abs\"><span class=\"kw3\">abs</span></a><span class=\"br0\">(</span><span class=\"re0\">$A</span><span class=\"br0\">[</span><span class=\"re0\">$i</span><span class=\"br0\">]</span><span class=\"br0\">[</span><span class=\"re0\">$col</span><span class=\"br0\">]</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>            <span class=\"kw1\">if</span> <span class=\"br0\">(</span><span class=\"re0\">$tmp</span> <span class=\"sy0\">&gt;</span> <span class=\"re0\">$max</span><span class=\"br0\">)</span><br/>            <span class=\"br0\">{</span><br/>                <span class=\"re0\">$j</span> <span class=\"sy0\">=</span> <span class=\"re0\">$i</span><span class=\"sy0\">;</span><br/>                <span class=\"re0\">$max</span> <span class=\"sy0\">=</span> <span class=\"re0\">$tmp</span><span class=\"sy0\">;</span><br/>            <span class=\"br0\">}</span><br/>        <span class=\"br0\">}</span><br/>\u00a0<br/>        swap_rows<span class=\"br0\">(</span><span class=\"re0\">$A</span><span class=\"sy0\">,</span> <span class=\"re0\">$b</span><span class=\"sy0\">,</span> <span class=\"re0\">$col</span><span class=\"sy0\">,</span> <span class=\"re0\">$j</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\u00a0<br/>        <span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"re0\">$i</span> <span class=\"sy0\">=</span> <span class=\"re0\">$col</span> <span class=\"sy0\">+</span> <span class=\"nu0\">1</span><span class=\"sy0\">;</span> <span class=\"re0\">$i</span> <span class=\"sy0\">&lt;</span> <span class=\"re0\">$N</span><span class=\"sy0\">;</span> <span class=\"re0\">$i</span><span class=\"sy0\">++</span><span class=\"br0\">)</span><br/>        <span class=\"br0\">{</span><br/>            <span class=\"re0\">$tmp</span> <span class=\"sy0\">=</span> <span class=\"re0\">$A</span><span class=\"br0\">[</span><span class=\"re0\">$i</span><span class=\"br0\">]</span><span class=\"br0\">[</span><span class=\"re0\">$col</span><span class=\"br0\">]</span> <span class=\"sy0\">/</span> <span class=\"re0\">$A</span><span class=\"br0\">[</span><span class=\"re0\">$col</span><span class=\"br0\">]</span><span class=\"br0\">[</span><span class=\"re0\">$col</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>            <span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"re0\">$j</span> <span class=\"sy0\">=</span> <span class=\"re0\">$col</span> <span class=\"sy0\">+</span> <span class=\"nu0\">1</span><span class=\"sy0\">;</span> <span class=\"re0\">$j</span> <span class=\"sy0\">&lt;</span> <span class=\"re0\">$N</span><span class=\"sy0\">;</span> <span class=\"re0\">$j</span><span class=\"sy0\">++</span><span class=\"br0\">)</span><br/>            <span class=\"br0\">{</span><br/>                <span class=\"re0\">$A</span><span class=\"br0\">[</span><span class=\"re0\">$i</span><span class=\"br0\">]</span><span class=\"br0\">[</span><span class=\"re0\">$j</span><span class=\"br0\">]</span> <span class=\"sy0\">-=</span> <span class=\"re0\">$tmp</span> <span class=\"sy0\">*</span> <span class=\"re0\">$A</span><span class=\"br0\">[</span><span class=\"re0\">$col</span><span class=\"br0\">]</span><span class=\"br0\">[</span><span class=\"re0\">$j</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>            <span class=\"br0\">}</span><br/>            <span class=\"re0\">$A</span><span class=\"br0\">[</span><span class=\"re0\">$i</span><span class=\"br0\">]</span><span class=\"br0\">[</span><span class=\"re0\">$col</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span><br/>            <span class=\"re0\">$b</span><span class=\"br0\">[</span><span class=\"re0\">$i</span><span class=\"br0\">]</span> <span class=\"sy0\">-=</span> <span class=\"re0\">$tmp</span> <span class=\"sy0\">*</span> <span class=\"re0\">$b</span><span class=\"br0\">[</span><span class=\"re0\">$col</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>        <span class=\"br0\">}</span><br/>    <span class=\"br0\">}</span><br/>    <span class=\"re0\">$x</span> <span class=\"sy0\">=</span> <a href=\"http://www.php.net/array\"><span class=\"kw3\">array</span></a><span class=\"br0\">(</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>    <span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"re0\">$col</span> <span class=\"sy0\">=</span> <span class=\"re0\">$N</span> <span class=\"sy0\">-</span> <span class=\"nu0\">1</span><span class=\"sy0\">;</span> <span class=\"re0\">$col</span> <span class=\"sy0\">&gt;=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span> <span class=\"re0\">$col</span><span class=\"sy0\">--</span><span class=\"br0\">)</span><br/>    <span class=\"br0\">{</span><br/>        <span class=\"re0\">$tmp</span> <span class=\"sy0\">=</span> <span class=\"re0\">$b</span><span class=\"br0\">[</span><span class=\"re0\">$col</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>        <span class=\"kw1\">for</span> <span class=\"br0\">(</span><span class=\"re0\">$j</span> <span class=\"sy0\">=</span> <span class=\"re0\">$N</span> <span class=\"sy0\">-</span> <span class=\"nu0\">1</span><span class=\"sy0\">;</span> <span class=\"re0\">$j</span> <span class=\"sy0\">&gt;</span> <span class=\"re0\">$col</span><span class=\"sy0\">;</span> <span class=\"re0\">$j</span><span class=\"sy0\">--</span><span class=\"br0\">)</span><br/>        <span class=\"br0\">{</span><br/>            <span class=\"re0\">$tmp</span> <span class=\"sy0\">-=</span> <span class=\"re0\">$x</span><span class=\"br0\">[</span><span class=\"re0\">$j</span><span class=\"br0\">]</span> <span class=\"sy0\">*</span> <span class=\"re0\">$A</span><span class=\"br0\">[</span><span class=\"re0\">$col</span><span class=\"br0\">]</span><span class=\"br0\">[</span><span class=\"re0\">$j</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>        <span class=\"br0\">}</span><br/>        <span class=\"re0\">$x</span><span class=\"br0\">[</span><span class=\"re0\">$col</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"re0\">$tmp</span> <span class=\"sy0\">/</span> <span class=\"re0\">$A</span><span class=\"br0\">[</span><span class=\"re0\">$col</span><span class=\"br0\">]</span><span class=\"br0\">[</span><span class=\"re0\">$col</span><span class=\"br0\">]</span><span class=\"sy0\">;</span><br/>    <span class=\"br0\">}</span><br/>    <span class=\"kw1\">return</span> <span class=\"re0\">$x</span><span class=\"sy0\">;</span><br/><span class=\"br0\">}</span><br/>\u00a0<br/><span class=\"kw2\">function</span> test_gauss<span class=\"br0\">(</span><span class=\"br0\">)</span><br/><span class=\"br0\">{</span><br/>    <span class=\"re0\">$a</span> <span class=\"sy0\">=</span> <a href=\"http://www.php.net/array\"><span class=\"kw3\">array</span></a><span class=\"br0\">(</span><br/>        <a href=\"http://www.php.net/array\"><span class=\"kw3\">array</span></a><span class=\"br0\">(</span><span class=\"nu19\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu19\">0.00</span><span class=\"sy0\">,</span> <span class=\"nu19\">0.00</span><span class=\"sy0\">,</span>  <span class=\"nu19\">0.00</span><span class=\"sy0\">,</span>  <span class=\"nu19\">0.00</span><span class=\"sy0\">,</span> <span class=\"nu19\">0.00</span><span class=\"br0\">)</span><span class=\"sy0\">,</span><br/>        <a href=\"http://www.php.net/array\"><span class=\"kw3\">array</span></a><span class=\"br0\">(</span><span class=\"nu19\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu19\">0.63</span><span class=\"sy0\">,</span> <span class=\"nu19\">0.39</span><span class=\"sy0\">,</span>  <span class=\"nu19\">0.25</span><span class=\"sy0\">,</span>  <span class=\"nu19\">0.16</span><span class=\"sy0\">,</span> <span class=\"nu19\">0.10</span><span class=\"br0\">)</span><span class=\"sy0\">,</span><br/>        <a href=\"http://www.php.net/array\"><span class=\"kw3\">array</span></a><span class=\"br0\">(</span><span class=\"nu19\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu19\">1.26</span><span class=\"sy0\">,</span> <span class=\"nu19\">1.58</span><span class=\"sy0\">,</span>  <span class=\"nu19\">1.98</span><span class=\"sy0\">,</span>  <span class=\"nu19\">2.49</span><span class=\"sy0\">,</span> <span class=\"nu19\">3.13</span><span class=\"br0\">)</span><span class=\"sy0\">,</span><br/>        <a href=\"http://www.php.net/array\"><span class=\"kw3\">array</span></a><span class=\"br0\">(</span><span class=\"nu19\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu19\">1.88</span><span class=\"sy0\">,</span> <span class=\"nu19\">3.55</span><span class=\"sy0\">,</span>  <span class=\"nu19\">6.70</span><span class=\"sy0\">,</span> <span class=\"nu19\">12.62</span><span class=\"sy0\">,</span> <span class=\"nu19\">23.80</span><span class=\"br0\">)</span><span class=\"sy0\">,</span><br/>        <a href=\"http://www.php.net/array\"><span class=\"kw3\">array</span></a><span class=\"br0\">(</span><span class=\"nu19\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu19\">2.51</span><span class=\"sy0\">,</span> <span class=\"nu19\">6.32</span><span class=\"sy0\">,</span> <span class=\"nu19\">15.88</span><span class=\"sy0\">,</span> <span class=\"nu19\">39.90</span><span class=\"sy0\">,</span> <span class=\"nu19\">100.28</span><span class=\"br0\">)</span><span class=\"sy0\">,</span><br/>        <a href=\"http://www.php.net/array\"><span class=\"kw3\">array</span></a><span class=\"br0\">(</span><span class=\"nu19\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu19\">3.14</span><span class=\"sy0\">,</span> <span class=\"nu19\">9.87</span><span class=\"sy0\">,</span> <span class=\"nu19\">31.01</span><span class=\"sy0\">,</span> <span class=\"nu19\">97.41</span><span class=\"sy0\">,</span> <span class=\"nu19\">306.02</span><span class=\"br0\">)</span><br/>    <span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>    <span class=\"re0\">$b</span> <span class=\"sy0\">=</span> <a href=\"http://www.php.net/array\"><span class=\"kw3\">array</span></a><span class=\"br0\">(</span> <span class=\"sy0\">-</span><span class=\"nu19\">0.01</span><span class=\"sy0\">,</span> <span class=\"nu19\">0.61</span><span class=\"sy0\">,</span> <span class=\"nu19\">0.91</span><span class=\"sy0\">,</span> <span class=\"nu19\">0.99</span><span class=\"sy0\">,</span> <span class=\"nu19\">0.60</span><span class=\"sy0\">,</span> <span class=\"nu19\">0.02</span> <span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\u00a0<br/>    <span class=\"re0\">$x</span> <span class=\"sy0\">=</span> gauss_eliminate<span class=\"br0\">(</span><span class=\"re0\">$a</span><span class=\"sy0\">,</span> <span class=\"re0\">$b</span><span class=\"sy0\">,</span> <span class=\"nu0\">6</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\u00a0<br/>    <a href=\"http://www.php.net/ksort\"><span class=\"kw3\">ksort</span></a><span class=\"br0\">(</span><span class=\"re0\">$x</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>    <a href=\"http://www.php.net/print_r\"><span class=\"kw3\">print_r</span></a><span class=\"br0\">(</span><span class=\"re0\">$x</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/><span class=\"br0\">}</span><br/>\u00a0<br/>test_gauss<span class=\"br0\">(</span><span class=\"br0\">)</span><span class=\"sy0\">;</span></pre>"}, {"lang": "PL/I", "loc": 71, "block": "<pre class=\"pli highlighted_source\">Solve<span class=\"sy0\">:</span> <span class=\"kw1\">procedure</span> <span class=\"kw1\">options</span> <span class=\"br0\">(</span><span class=\"kw1\">main</span><span class=\"br0\">)</span><span class=\"sy0\">;</span>    <span class=\"coMULTI\">/* 11 January 2014 */</span><br/>\u00a0<br/>   <span class=\"kw1\">declare</span> n <span class=\"kw1\">fixed</span> <span class=\"kw1\">binary</span><span class=\"sy0\">;</span><br/>   <span class=\"kw1\">put</span> <span class=\"br0\">(</span><span class=\"st0\">'Program to solve n simultaneous equations of the form Ax = b. Please type n:'</span> <span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>   <span class=\"kw1\">get</span> <span class=\"br0\">(</span>n<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\u00a0<br/><span class=\"kw1\">begin</span><span class=\"sy0\">;</span><br/>   <span class=\"kw1\">declare</span> <span class=\"br0\">(</span>A<span class=\"br0\">(</span>n<span class=\"sy0\">,</span> n<span class=\"br0\">)</span><span class=\"sy0\">,</span> b<span class=\"br0\">(</span>n<span class=\"br0\">)</span><span class=\"sy0\">,</span> x<span class=\"br0\">(</span>n<span class=\"br0\">)</span><span class=\"br0\">)</span> <span class=\"kw1\">float</span><span class=\"br0\">(</span><span class=\"nu0\">18</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>   <span class=\"kw1\">declare</span> <span class=\"br0\">(</span>SA<span class=\"br0\">(</span>n<span class=\"sy0\">,</span>n<span class=\"br0\">)</span><span class=\"sy0\">,</span> Sb<span class=\"br0\">(</span>n<span class=\"br0\">)</span><span class=\"br0\">)</span> <span class=\"kw1\">float</span> <span class=\"br0\">(</span><span class=\"nu0\">18</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>   <span class=\"kw1\">declare</span> i <span class=\"kw1\">fixed</span> <span class=\"kw1\">binary</span><span class=\"sy0\">;</span><br/>\u00a0<br/>   <span class=\"kw1\">put</span> <span class=\"kw1\">skip</span> <span class=\"kw1\">list</span> <span class=\"br0\">(</span><span class=\"st0\">'Please type A:'</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>   <span class=\"kw1\">get</span> <span class=\"br0\">(</span>a<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>   <span class=\"kw1\">put</span> <span class=\"kw1\">skip</span> <span class=\"kw1\">list</span> <span class=\"br0\">(</span><span class=\"st0\">'Please type the right-hand sides, b:'</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>   <span class=\"kw1\">get</span> <span class=\"br0\">(</span>b<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\u00a0<br/>   SA <span class=\"sy0\">=</span> A<span class=\"sy0\">;</span> Sb <span class=\"sy0\">=</span> b<span class=\"sy0\">;</span><br/>\u00a0<br/>   <span class=\"kw1\">put</span> <span class=\"kw1\">skip</span> <span class=\"kw1\">list</span> <span class=\"br0\">(</span><span class=\"st0\">'The equations are:'</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>   <span class=\"kw1\">do</span> i <span class=\"sy0\">=</span> <span class=\"nu0\">1</span> <span class=\"kw1\">to</span> n<span class=\"sy0\">;</span><br/>      <span class=\"kw1\">put</span> <span class=\"kw1\">skip</span> <span class=\"kw1\">edit</span> <span class=\"br0\">(</span>A<span class=\"br0\">(</span>i<span class=\"sy0\">,*</span><span class=\"br0\">)</span><span class=\"sy0\">,</span> b<span class=\"br0\">(</span>i<span class=\"br0\">)</span><span class=\"br0\">)</span> <span class=\"br0\">(</span>f<span class=\"br0\">(</span><span class=\"nu0\">5</span><span class=\"br0\">)</span><span class=\"sy0\">,</span> x<span class=\"br0\">(</span><span class=\"nu0\">1</span><span class=\"br0\">)</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>   <span class=\"kw1\">end</span><span class=\"sy0\">;</span><br/>\u00a0<br/>   <span class=\"kw1\">call</span> Gauss_elimination <span class=\"br0\">(</span>A<span class=\"sy0\">,</span> b<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\u00a0<br/>   <span class=\"kw1\">call</span> Backward_substitution <span class=\"br0\">(</span>A<span class=\"sy0\">,</span> b<span class=\"sy0\">,</span> x<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\u00a0<br/>   <span class=\"kw1\">put</span> <span class=\"kw1\">skip</span> <span class=\"kw1\">list</span> <span class=\"br0\">(</span><span class=\"st0\">'Solutions:'</span><span class=\"br0\">)</span><span class=\"sy0\">;</span> <span class=\"kw1\">put</span> <span class=\"kw1\">skip</span> <span class=\"kw1\">data</span> <span class=\"br0\">(</span>x<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\u00a0<br/>   <span class=\"coMULTI\">/* Check solutions: */</span><br/>   <span class=\"kw1\">put</span> <span class=\"kw1\">skip</span> <span class=\"kw1\">list</span> <span class=\"br0\">(</span><span class=\"st0\">'Residuals:'</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>   <span class=\"kw1\">do</span> i <span class=\"sy0\">=</span> <span class=\"nu0\">1</span> <span class=\"kw1\">to</span> n<span class=\"sy0\">;</span><br/>      <span class=\"kw1\">put</span> <span class=\"kw1\">skip</span> <span class=\"kw1\">list</span> <span class=\"br0\">(</span><span class=\"kw1\">sum</span><span class=\"br0\">(</span>SA<span class=\"br0\">(</span>i<span class=\"sy0\">,*</span><span class=\"br0\">)</span> <span class=\"sy0\">*</span> x<span class=\"br0\">(</span><span class=\"sy0\">*</span><span class=\"br0\">)</span><span class=\"br0\">)</span> <span class=\"sy0\">-</span> Sb<span class=\"br0\">(</span>i<span class=\"br0\">)</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>   <span class=\"kw1\">end</span><span class=\"sy0\">;</span><br/><span class=\"kw1\">end</span><span class=\"sy0\">;</span><br/>\u00a0<br/>Gauss_elimination<span class=\"sy0\">:</span> <span class=\"kw1\">procedure</span> <span class=\"br0\">(</span>A<span class=\"sy0\">,</span> b<span class=\"br0\">)</span> <span class=\"kw1\">options</span> <span class=\"br0\">(</span><span class=\"kw1\">reorder</span><span class=\"br0\">)</span><span class=\"sy0\">;</span> <span class=\"coMULTI\">/* Triangularise */</span><br/>   <span class=\"kw1\">declare</span> <span class=\"br0\">(</span>A<span class=\"br0\">(</span><span class=\"sy0\">*,*</span><span class=\"br0\">)</span><span class=\"sy0\">,</span> b<span class=\"br0\">(</span><span class=\"sy0\">*</span><span class=\"br0\">)</span><span class=\"br0\">)</span> <span class=\"kw1\">float</span><span class=\"br0\">(</span><span class=\"nu0\">18</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>   <span class=\"kw1\">declare</span> n <span class=\"kw1\">fixed</span> <span class=\"kw1\">binary</span> <span class=\"kw1\">initial</span> <span class=\"br0\">(</span><span class=\"kw1\">hbound</span><span class=\"br0\">(</span>A<span class=\"sy0\">,</span> <span class=\"nu0\">1</span><span class=\"br0\">)</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>   <span class=\"kw1\">declare</span> <span class=\"br0\">(</span>i<span class=\"sy0\">,</span> j<span class=\"sy0\">,</span> k<span class=\"br0\">)</span> <span class=\"kw1\">fixed</span> <span class=\"kw1\">binary</span><span class=\"sy0\">;</span><br/>   <span class=\"kw1\">declare</span> t <span class=\"kw1\">float</span><span class=\"br0\">(</span><span class=\"nu0\">18</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\u00a0<br/>   <span class=\"kw1\">do</span> j <span class=\"sy0\">=</span> <span class=\"nu0\">1</span> <span class=\"kw1\">to</span> n<span class=\"sy0\">;</span><br/>      <span class=\"kw1\">do</span> i <span class=\"sy0\">=</span> j<span class=\"sy0\">+</span><span class=\"nu0\">1</span> <span class=\"kw1\">to</span> n<span class=\"sy0\">;</span> <span class=\"coMULTI\">/* For each of the rows beneath the current (pivot) row. */</span><br/>         t <span class=\"sy0\">=</span> A<span class=\"br0\">(</span>j<span class=\"sy0\">,</span>j<span class=\"br0\">)</span> <span class=\"sy0\">/</span> A<span class=\"br0\">(</span>i<span class=\"sy0\">,</span>j<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>         <span class=\"kw1\">do</span> k <span class=\"sy0\">=</span> j<span class=\"sy0\">+</span><span class=\"nu0\">1</span> <span class=\"kw1\">to</span> n<span class=\"sy0\">;</span> <span class=\"coMULTI\">/* Subtract a multiple of row i from row j. */</span><br/>            A<span class=\"br0\">(</span>i<span class=\"sy0\">,</span>k<span class=\"br0\">)</span> <span class=\"sy0\">=</span> A<span class=\"br0\">(</span>j<span class=\"sy0\">,</span>k<span class=\"br0\">)</span> <span class=\"sy0\">-</span> t<span class=\"sy0\">*</span>A<span class=\"br0\">(</span>i<span class=\"sy0\">,</span>k<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>         <span class=\"kw1\">end</span><span class=\"sy0\">;</span><br/>         b<span class=\"br0\">(</span>i<span class=\"br0\">)</span> <span class=\"sy0\">=</span> b<span class=\"br0\">(</span>j<span class=\"br0\">)</span> <span class=\"sy0\">-</span> t<span class=\"sy0\">*</span>b<span class=\"br0\">(</span>i<span class=\"br0\">)</span><span class=\"sy0\">;</span> <span class=\"coMULTI\">/* ... and the right-hand side. */</span><br/>      <span class=\"kw1\">end</span><span class=\"sy0\">;</span><br/>   <span class=\"kw1\">end</span><span class=\"sy0\">;</span><br/><span class=\"kw1\">end</span> Gauss_elimination<span class=\"sy0\">;</span><br/>\u00a0<br/>Backward_substitution<span class=\"sy0\">:</span> <span class=\"kw1\">procedure</span> <span class=\"br0\">(</span>A<span class=\"sy0\">,</span> b<span class=\"sy0\">,</span> x<span class=\"br0\">)</span> <span class=\"kw1\">options</span> <span class=\"br0\">(</span><span class=\"kw1\">reorder</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>   <span class=\"kw1\">declare</span> <span class=\"br0\">(</span>A<span class=\"br0\">(</span><span class=\"sy0\">*,*</span><span class=\"br0\">)</span><span class=\"sy0\">,</span> b<span class=\"br0\">(</span><span class=\"sy0\">*</span><span class=\"br0\">)</span><span class=\"sy0\">,</span> x<span class=\"br0\">(</span><span class=\"sy0\">*</span><span class=\"br0\">)</span><span class=\"br0\">)</span> <span class=\"kw1\">float</span><span class=\"br0\">(</span><span class=\"nu0\">18</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>   <span class=\"kw1\">declare</span> t <span class=\"kw1\">float</span><span class=\"br0\">(</span><span class=\"nu0\">18</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>   <span class=\"kw1\">declare</span> n <span class=\"kw1\">fixed</span> <span class=\"kw1\">binary</span> <span class=\"kw1\">initial</span> <span class=\"br0\">(</span><span class=\"kw1\">hbound</span><span class=\"br0\">(</span>A<span class=\"sy0\">,</span> <span class=\"nu0\">1</span><span class=\"br0\">)</span><span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>   <span class=\"kw1\">declare</span> <span class=\"br0\">(</span>i<span class=\"sy0\">,</span> j<span class=\"br0\">)</span> <span class=\"kw1\">fixed</span> <span class=\"kw1\">binary</span><span class=\"sy0\">;</span><br/>\u00a0<br/>   x<span class=\"br0\">(</span>n<span class=\"br0\">)</span> <span class=\"sy0\">=</span> b<span class=\"br0\">(</span>n<span class=\"br0\">)</span> <span class=\"sy0\">/</span> a<span class=\"br0\">(</span>n<span class=\"sy0\">,</span>n<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>\u00a0<br/>   <span class=\"kw1\">do</span> j <span class=\"sy0\">=</span> n<span class=\"sy0\">-</span><span class=\"nu0\">1</span> <span class=\"kw1\">to</span> <span class=\"nu0\">1</span> <span class=\"kw1\">by</span> <span class=\"sy0\">-</span><span class=\"nu0\">1</span><span class=\"sy0\">;</span><br/>      t <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span><br/>      <span class=\"kw1\">do</span> i <span class=\"sy0\">=</span> j<span class=\"sy0\">+</span><span class=\"nu0\">1</span> <span class=\"kw1\">to</span> n<span class=\"sy0\">;</span><br/>         t <span class=\"sy0\">=</span> t <span class=\"sy0\">+</span> a<span class=\"br0\">(</span>j<span class=\"sy0\">,</span>i<span class=\"br0\">)</span><span class=\"sy0\">*</span>x<span class=\"br0\">(</span>i<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>      <span class=\"kw1\">end</span><span class=\"sy0\">;</span><br/>      x<span class=\"br0\">(</span>j<span class=\"br0\">)</span> <span class=\"sy0\">=</span> <span class=\"br0\">(</span>b<span class=\"br0\">(</span>j<span class=\"br0\">)</span> <span class=\"sy0\">-</span> t<span class=\"br0\">)</span> <span class=\"sy0\">/</span> a<span class=\"br0\">(</span>j<span class=\"sy0\">,</span>j<span class=\"br0\">)</span><span class=\"sy0\">;</span><br/>   <span class=\"kw1\">end</span><span class=\"sy0\">;</span><br/><span class=\"kw1\">end</span> Backward_substitution<span class=\"sy0\">;</span><br/>\u00a0<br/><span class=\"kw1\">end</span> Solve<span class=\"sy0\">;</span></pre>"}, {"lang": "PowerShell", "loc": 56, "block": "<pre class=\"powershell highlighted_source\">\u00a0<br/><span class=\"kw3\">function</span> gauss<span class=\"br0\">(</span><span class=\"re0\">$a</span><span class=\"sy0\">,</span><span class=\"re0\">$b</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>    <span class=\"re0\">$n</span> <span class=\"sy0\">=</span> <span class=\"re0\">$a</span>.count  <br/>    <span class=\"kw3\">for</span> <span class=\"br0\">(</span><span class=\"re0\">$k</span> <span class=\"sy0\">=</span> <span class=\"nu0\">0</span>; <span class=\"re0\">$k</span> <span class=\"kw4\">-lt</span> <span class=\"re0\">$n</span>; <span class=\"re0\">$k</span><span class=\"sy0\">++</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>        <span class=\"re0\">$lmax</span><span class=\"sy0\">,</span> <span class=\"re0\">$max</span> <span class=\"sy0\">=</span> <span class=\"re0\">$k</span><span class=\"sy0\">,</span> <span class=\"br0\">[</span>Math<span class=\"br0\">]</span>::Abs<span class=\"br0\">(</span><span class=\"re0\">$a</span><span class=\"br0\">[</span><span class=\"re0\">$k</span><span class=\"br0\">]</span><span class=\"br0\">[</span><span class=\"re0\">$k</span><span class=\"br0\">]</span><span class=\"br0\">)</span><br/>        <span class=\"kw3\">for</span> <span class=\"br0\">(</span><span class=\"re0\">$l</span> <span class=\"sy0\">=</span> <span class=\"re0\">$k</span><span class=\"sy0\">+</span><span class=\"nu0\">1</span>; <span class=\"re0\">$l</span> <span class=\"kw4\">-lt</span> <span class=\"re0\">$n</span>; <span class=\"re0\">$l</span><span class=\"sy0\">++</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>            <span class=\"re0\">$tmp</span> <span class=\"sy0\">=</span> <span class=\"br0\">[</span>Math<span class=\"br0\">]</span>::Abs<span class=\"br0\">(</span><span class=\"re0\">$a</span><span class=\"br0\">[</span><span class=\"re0\">$l</span><span class=\"br0\">]</span><span class=\"br0\">[</span><span class=\"re0\">$k</span><span class=\"br0\">]</span><span class=\"br0\">)</span><br/>            <span class=\"kw3\">if</span><span class=\"br0\">(</span><span class=\"re0\">$max</span> <span class=\"kw4\">-lt</span> <span class=\"re0\">$tmp</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>                <span class=\"re0\">$max</span><span class=\"sy0\">,</span> <span class=\"re0\">$lmax</span> <span class=\"sy0\">=</span> <span class=\"re0\">$tmp</span><span class=\"sy0\">,</span> <span class=\"re0\">$l</span><br/>            <span class=\"br0\">}</span><br/>        <span class=\"br0\">}</span>        <br/>        <span class=\"kw3\">if</span> <span class=\"br0\">(</span><span class=\"re0\">$k</span> <span class=\"kw4\">-ne</span> <span class=\"re0\">$lmax</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>            <span class=\"re0\">$a</span><span class=\"br0\">[</span><span class=\"re0\">$k</span><span class=\"br0\">]</span><span class=\"sy0\">,</span> <span class=\"re0\">$a</span><span class=\"br0\">[</span><span class=\"re0\">$lmax</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"re0\">$a</span><span class=\"br0\">[</span><span class=\"re0\">$lmax</span><span class=\"br0\">]</span><span class=\"sy0\">,</span> <span class=\"re0\">$a</span><span class=\"br0\">[</span><span class=\"re0\">$k</span><span class=\"br0\">]</span><br/>            <span class=\"re0\">$b</span><span class=\"br0\">[</span><span class=\"re0\">$k</span><span class=\"br0\">]</span><span class=\"sy0\">,</span> <span class=\"re0\">$b</span><span class=\"br0\">[</span><span class=\"re0\">$lmax</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"re0\">$b</span><span class=\"br0\">[</span><span class=\"re0\">$lmax</span><span class=\"br0\">]</span><span class=\"sy0\">,</span> <span class=\"re0\">$b</span><span class=\"br0\">[</span><span class=\"re0\">$k</span><span class=\"br0\">]</span><br/>        <span class=\"br0\">}</span><br/>        <span class=\"re0\">$akk</span> <span class=\"sy0\">=</span> <span class=\"re0\">$a</span><span class=\"br0\">[</span><span class=\"re0\">$k</span><span class=\"br0\">]</span><span class=\"br0\">[</span><span class=\"re0\">$k</span><span class=\"br0\">]</span><br/>        <span class=\"kw3\">for</span> <span class=\"br0\">(</span><span class=\"re0\">$i</span> <span class=\"sy0\">=</span> <span class=\"re0\">$k</span><span class=\"sy0\">+</span><span class=\"nu0\">1</span>; <span class=\"re0\">$i</span> <span class=\"kw4\">-lt</span> <span class=\"re0\">$n</span>; <span class=\"re0\">$i</span><span class=\"sy0\">++</span><span class=\"br0\">)</span><span class=\"br0\">{</span><br/>            <span class=\"re0\">$aik</span>  <span class=\"sy0\">=</span> <span class=\"re0\">$a</span><span class=\"br0\">[</span><span class=\"re0\">$i</span><span class=\"br0\">]</span><span class=\"br0\">[</span><span class=\"re0\">$k</span><span class=\"br0\">]</span><br/>            <span class=\"kw3\">for</span> <span class=\"br0\">(</span><span class=\"re0\">$j</span> <span class=\"sy0\">=</span> <span class=\"re0\">$k</span>; <span class=\"re0\">$j</span> <span class=\"kw4\">-lt</span> <span class=\"re0\">$n</span>; <span class=\"re0\">$j</span><span class=\"sy0\">++</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>                <span class=\"re0\">$a</span><span class=\"br0\">[</span><span class=\"re0\">$i</span><span class=\"br0\">]</span><span class=\"br0\">[</span><span class=\"re0\">$j</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"re0\">$a</span><span class=\"br0\">[</span><span class=\"re0\">$i</span><span class=\"br0\">]</span><span class=\"br0\">[</span><span class=\"re0\">$j</span><span class=\"br0\">]</span><span class=\"sy0\">*</span><span class=\"re0\">$akk</span> <span class=\"sy0\">-</span> <span class=\"re0\">$a</span><span class=\"br0\">[</span><span class=\"re0\">$k</span><span class=\"br0\">]</span><span class=\"br0\">[</span><span class=\"re0\">$j</span><span class=\"br0\">]</span><span class=\"sy0\">*</span><span class=\"re0\">$aik</span><br/>            <span class=\"br0\">}</span><br/>            <span class=\"re0\">$b</span><span class=\"br0\">[</span><span class=\"re0\">$i</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"re0\">$b</span><span class=\"br0\">[</span><span class=\"re0\">$i</span><span class=\"br0\">]</span><span class=\"sy0\">*</span><span class=\"re0\">$akk</span> <span class=\"sy0\">-</span> <span class=\"re0\">$b</span><span class=\"br0\">[</span><span class=\"re0\">$k</span><span class=\"br0\">]</span><span class=\"sy0\">*</span><span class=\"re0\">$aik</span><br/>        <span class=\"br0\">}</span>    <br/>    <span class=\"br0\">}</span><br/>    <span class=\"kw3\">for</span> <span class=\"br0\">(</span><span class=\"re0\">$i</span> <span class=\"sy0\">=</span> <span class=\"re0\">$n</span><span class=\"sy0\">-</span><span class=\"nu0\">1</span>; <span class=\"re0\">$i</span> <span class=\"kw4\">-ge</span> <span class=\"nu0\">0</span>; <span class=\"re0\">$i</span><span class=\"sy0\">--</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>        <span class=\"kw3\">for</span> <span class=\"br0\">(</span><span class=\"re0\">$j</span> <span class=\"sy0\">=</span> <span class=\"re0\">$i</span><span class=\"sy0\">+</span><span class=\"nu0\">1</span>; <span class=\"re0\">$j</span> <span class=\"kw4\">-lt</span> <span class=\"re0\">$n</span>; <span class=\"re0\">$j</span><span class=\"sy0\">++</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>            <span class=\"re0\">$b</span><span class=\"br0\">[</span><span class=\"re0\">$i</span><span class=\"br0\">]</span> <span class=\"sy0\">-=</span> <span class=\"re0\">$b</span><span class=\"br0\">[</span><span class=\"re0\">$j</span><span class=\"br0\">]</span><span class=\"sy0\">*</span><span class=\"re0\">$a</span><span class=\"br0\">[</span><span class=\"re0\">$i</span><span class=\"br0\">]</span><span class=\"br0\">[</span><span class=\"re0\">$j</span><span class=\"br0\">]</span><br/>        <span class=\"br0\">}</span><br/>        <span class=\"re0\">$b</span><span class=\"br0\">[</span><span class=\"re0\">$i</span><span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"re0\">$b</span><span class=\"br0\">[</span><span class=\"re0\">$i</span><span class=\"br0\">]</span><span class=\"sy0\">/</span><span class=\"re0\">$a</span><span class=\"br0\">[</span><span class=\"re0\">$i</span><span class=\"br0\">]</span><span class=\"br0\">[</span><span class=\"re0\">$i</span><span class=\"br0\">]</span><br/>    <span class=\"br0\">}</span><br/>    <span class=\"re0\">$b</span><br/><span class=\"br0\">}</span><br/><span class=\"kw3\">function</span> show<span class=\"br0\">(</span><span class=\"re0\">$a</span><span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>    <span class=\"kw3\">if</span><span class=\"br0\">(</span><span class=\"re0\">$a</span><span class=\"br0\">)</span> <span class=\"br0\">{</span> <br/>        <span class=\"nu0\">0</span>..<span class=\"br0\">(</span><span class=\"re0\">$a</span>.Count <span class=\"sy0\">-</span> <span class=\"nu0\">1</span><span class=\"br0\">)</span> <span class=\"sy0\">|</span> <span class=\"kw3\">foreach</span><span class=\"br0\">{</span> <span class=\"kw3\">if</span><span class=\"br0\">(</span><span class=\"re0\">$a</span><span class=\"br0\">[</span><a href=\"about:blank\"><span class=\"kw6\">$_</span></a><span class=\"br0\">]</span><span class=\"br0\">)</span><span class=\"br0\">{</span><span class=\"st0\">\"$($a[$_][0..($a[$_].count -1)])\"</span><span class=\"br0\">}</span><span class=\"kw3\">else</span><span class=\"br0\">{</span><span class=\"st0\">\"\"</span><span class=\"br0\">}</span> <span class=\"br0\">}</span><br/>    <span class=\"br0\">}</span><br/><span class=\"br0\">}</span><br/><span class=\"re0\">$a</span> <span class=\"sy0\">=</span><span class=\"br0\">(</span><br/><span class=\"sy0\">@</span><span class=\"br0\">(</span><span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.00</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0.00</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.00</span><span class=\"br0\">)</span><span class=\"sy0\">,</span><br/><span class=\"sy0\">@</span><span class=\"br0\">(</span><span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.63</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.39</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0.25</span><span class=\"sy0\">,</span>  <span class=\"nu0\">0.16</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.10</span><span class=\"br0\">)</span><span class=\"sy0\">,</span><br/><span class=\"sy0\">@</span><span class=\"br0\">(</span><span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">1.26</span><span class=\"sy0\">,</span> <span class=\"nu0\">1.58</span><span class=\"sy0\">,</span>  <span class=\"nu0\">1.98</span><span class=\"sy0\">,</span>  <span class=\"nu0\">2.49</span><span class=\"sy0\">,</span> <span class=\"nu0\">3.13</span><span class=\"br0\">)</span><span class=\"sy0\">,</span><br/><span class=\"sy0\">@</span><span class=\"br0\">(</span><span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">1.88</span><span class=\"sy0\">,</span> <span class=\"nu0\">3.55</span><span class=\"sy0\">,</span>  <span class=\"nu0\">6.70</span><span class=\"sy0\">,</span> <span class=\"nu0\">12.62</span><span class=\"sy0\">,</span> <span class=\"nu0\">23.80</span><span class=\"br0\">)</span><span class=\"sy0\">,</span><br/><span class=\"sy0\">@</span><span class=\"br0\">(</span><span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">2.51</span><span class=\"sy0\">,</span> <span class=\"nu0\">6.32</span><span class=\"sy0\">,</span> <span class=\"nu0\">15.88</span><span class=\"sy0\">,</span> <span class=\"nu0\">39.90</span><span class=\"sy0\">,</span> <span class=\"nu0\">100.28</span><span class=\"br0\">)</span><span class=\"sy0\">,</span><br/><span class=\"sy0\">@</span><span class=\"br0\">(</span><span class=\"nu0\">1.00</span><span class=\"sy0\">,</span> <span class=\"nu0\">3.14</span><span class=\"sy0\">,</span> <span class=\"nu0\">9.87</span><span class=\"sy0\">,</span> <span class=\"nu0\">31.01</span><span class=\"sy0\">,</span> <span class=\"nu0\">97.41</span><span class=\"sy0\">,</span> <span class=\"nu0\">306.02</span><span class=\"br0\">)</span><br/><span class=\"br0\">)</span><br/><span class=\"st0\">\"a =\"</span><br/>show <span class=\"re0\">$a</span><br/><span class=\"st0\">\"\"</span><br/><span class=\"re0\">$b</span> <span class=\"sy0\">=</span> <span class=\"sy0\">@</span><span class=\"br0\">(</span><span class=\"sy0\">-</span><span class=\"nu0\">0.01</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.61</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.91</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.99</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.60</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.02</span><span class=\"br0\">)</span><br/><span class=\"st0\">\"b =\"</span><br/><span class=\"re0\">$b</span><br/><span class=\"st0\">\"\"</span><br/><span class=\"st0\">\"x =\"</span><br/>gauss <span class=\"re0\">$a</span> <span class=\"re0\">$b</span><br/>\u00a0<br/>\u00a0</pre>"}, {"lang": "Python", "loc": 96, "block": "<pre class=\"python highlighted_source\"><span class=\"co1\"># The 'gauss' function takes two matrices, 'a' and 'b', with 'a' square, and it return the determinant of 'a' and a matrix 'x' such that a*x = b.</span><br/><span class=\"co1\"># If 'b' is the identity, then 'x' is the inverse of 'a'.</span><br/>\u00a0<br/><span class=\"kw1\">import</span> <span class=\"kw3\">copy</span><br/><span class=\"kw1\">from</span> fractions <span class=\"kw1\">import</span> Fraction<br/>\u00a0<br/><span class=\"kw1\">def</span> gauss<span class=\"br0\">(</span>a<span class=\"sy0\">,</span> b<span class=\"br0\">)</span>:<br/>    a <span class=\"sy0\">=</span> <span class=\"kw3\">copy</span>.<span class=\"me1\">deepcopy</span><span class=\"br0\">(</span>a<span class=\"br0\">)</span><br/>    b <span class=\"sy0\">=</span> <span class=\"kw3\">copy</span>.<span class=\"me1\">deepcopy</span><span class=\"br0\">(</span>b<span class=\"br0\">)</span><br/>    n <span class=\"sy0\">=</span> <span class=\"kw2\">len</span><span class=\"br0\">(</span>a<span class=\"br0\">)</span><br/>    p <span class=\"sy0\">=</span> <span class=\"kw2\">len</span><span class=\"br0\">(</span>b<span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span><span class=\"br0\">)</span><br/>    det <span class=\"sy0\">=</span> <span class=\"nu0\">1</span><br/>    <span class=\"kw1\">for</span> i <span class=\"kw1\">in</span> <span class=\"kw2\">range</span><span class=\"br0\">(</span>n - <span class=\"nu0\">1</span><span class=\"br0\">)</span>:<br/>        k <span class=\"sy0\">=</span> i<br/>        <span class=\"kw1\">for</span> j <span class=\"kw1\">in</span> <span class=\"kw2\">range</span><span class=\"br0\">(</span>i + <span class=\"nu0\">1</span><span class=\"sy0\">,</span> n<span class=\"br0\">)</span>:<br/>            <span class=\"kw1\">if</span> <span class=\"kw2\">abs</span><span class=\"br0\">(</span>a<span class=\"br0\">[</span>j<span class=\"br0\">]</span><span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">)</span> <span class=\"sy0\">&gt;</span> <span class=\"kw2\">abs</span><span class=\"br0\">(</span>a<span class=\"br0\">[</span>k<span class=\"br0\">]</span><span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">)</span>:<br/>                k <span class=\"sy0\">=</span> j<br/>        <span class=\"kw1\">if</span> k <span class=\"sy0\">!=</span> i:<br/>            a<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"sy0\">,</span> a<span class=\"br0\">[</span>k<span class=\"br0\">]</span> <span class=\"sy0\">=</span> a<span class=\"br0\">[</span>k<span class=\"br0\">]</span><span class=\"sy0\">,</span> a<span class=\"br0\">[</span>i<span class=\"br0\">]</span><br/>            b<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"sy0\">,</span> b<span class=\"br0\">[</span>k<span class=\"br0\">]</span> <span class=\"sy0\">=</span> b<span class=\"br0\">[</span>k<span class=\"br0\">]</span><span class=\"sy0\">,</span> b<span class=\"br0\">[</span>i<span class=\"br0\">]</span><br/>            det <span class=\"sy0\">=</span> -det<br/>\u00a0<br/>        <span class=\"kw1\">for</span> j <span class=\"kw1\">in</span> <span class=\"kw2\">range</span><span class=\"br0\">(</span>i + <span class=\"nu0\">1</span><span class=\"sy0\">,</span> n<span class=\"br0\">)</span>:<br/>            t <span class=\"sy0\">=</span> a<span class=\"br0\">[</span>j<span class=\"br0\">]</span><span class=\"br0\">[</span>i<span class=\"br0\">]</span>/a<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>i<span class=\"br0\">]</span><br/>            <span class=\"kw1\">for</span> k <span class=\"kw1\">in</span> <span class=\"kw2\">range</span><span class=\"br0\">(</span>i + <span class=\"nu0\">1</span><span class=\"sy0\">,</span> n<span class=\"br0\">)</span>:<br/>                a<span class=\"br0\">[</span>j<span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"br0\">]</span> -<span class=\"sy0\">=</span> t*a<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"br0\">]</span><br/>            <span class=\"kw1\">for</span> k <span class=\"kw1\">in</span> <span class=\"kw2\">range</span><span class=\"br0\">(</span>p<span class=\"br0\">)</span>:<br/>                b<span class=\"br0\">[</span>j<span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"br0\">]</span> -<span class=\"sy0\">=</span> t*b<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"br0\">]</span><br/>\u00a0<br/>    <span class=\"kw1\">for</span> i <span class=\"kw1\">in</span> <span class=\"kw2\">range</span><span class=\"br0\">(</span>n - <span class=\"nu0\">1</span><span class=\"sy0\">,</span> -<span class=\"nu0\">1</span><span class=\"sy0\">,</span> -<span class=\"nu0\">1</span><span class=\"br0\">)</span>:<br/>        <span class=\"kw1\">for</span> j <span class=\"kw1\">in</span> <span class=\"kw2\">range</span><span class=\"br0\">(</span>i + <span class=\"nu0\">1</span><span class=\"sy0\">,</span> n<span class=\"br0\">)</span>:<br/>            t <span class=\"sy0\">=</span> a<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>j<span class=\"br0\">]</span><br/>            <span class=\"kw1\">for</span> k <span class=\"kw1\">in</span> <span class=\"kw2\">range</span><span class=\"br0\">(</span>p<span class=\"br0\">)</span>:<br/>                b<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"br0\">]</span> -<span class=\"sy0\">=</span> t*b<span class=\"br0\">[</span>j<span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"br0\">]</span><br/>        t <span class=\"sy0\">=</span> <span class=\"nu0\">1</span>/a<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>i<span class=\"br0\">]</span><br/>        det *<span class=\"sy0\">=</span> a<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>i<span class=\"br0\">]</span><br/>        <span class=\"kw1\">for</span> j <span class=\"kw1\">in</span> <span class=\"kw2\">range</span><span class=\"br0\">(</span>p<span class=\"br0\">)</span>:<br/>            b<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>j<span class=\"br0\">]</span> *<span class=\"sy0\">=</span> t<br/>    <span class=\"kw1\">return</span> det<span class=\"sy0\">,</span> b<br/>\u00a0<br/><span class=\"kw1\">def</span> zeromat<span class=\"br0\">(</span>p<span class=\"sy0\">,</span> q<span class=\"br0\">)</span>:<br/>    <span class=\"kw1\">return</span> <span class=\"br0\">[</span><span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span>*q <span class=\"kw1\">for</span> i <span class=\"kw1\">in</span> <span class=\"kw2\">range</span><span class=\"br0\">(</span>p<span class=\"br0\">)</span><span class=\"br0\">]</span><br/>\u00a0<br/><span class=\"kw1\">def</span> matmul<span class=\"br0\">(</span>a<span class=\"sy0\">,</span> b<span class=\"br0\">)</span>:<br/>    n<span class=\"sy0\">,</span> p <span class=\"sy0\">=</span> <span class=\"kw2\">len</span><span class=\"br0\">(</span>a<span class=\"br0\">)</span><span class=\"sy0\">,</span> <span class=\"kw2\">len</span><span class=\"br0\">(</span>a<span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span><span class=\"br0\">)</span><br/>    p1<span class=\"sy0\">,</span> q <span class=\"sy0\">=</span> <span class=\"kw2\">len</span><span class=\"br0\">(</span>b<span class=\"br0\">)</span><span class=\"sy0\">,</span> <span class=\"kw2\">len</span><span class=\"br0\">(</span>b<span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"br0\">]</span><span class=\"br0\">)</span><br/>    <span class=\"kw1\">if</span> p <span class=\"sy0\">!=</span> p1:<br/>        <span class=\"kw1\">raise</span> <span class=\"kw2\">ValueError</span><span class=\"br0\">(</span><span class=\"st0\">\"Incompatible dimensions\"</span><span class=\"br0\">)</span><br/>    c <span class=\"sy0\">=</span> zeromat<span class=\"br0\">(</span>n<span class=\"sy0\">,</span> q<span class=\"br0\">)</span><br/>    <span class=\"kw1\">for</span> i <span class=\"kw1\">in</span> <span class=\"kw2\">range</span><span class=\"br0\">(</span>n<span class=\"br0\">)</span>:<br/>        <span class=\"kw1\">for</span> j <span class=\"kw1\">in</span> <span class=\"kw2\">range</span><span class=\"br0\">(</span>q<span class=\"br0\">)</span>:<br/>                c<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>j<span class=\"br0\">]</span> <span class=\"sy0\">=</span> <span class=\"kw2\">sum</span><span class=\"br0\">(</span>a<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">[</span>k<span class=\"br0\">]</span>*b<span class=\"br0\">[</span>k<span class=\"br0\">]</span><span class=\"br0\">[</span>j<span class=\"br0\">]</span> <span class=\"kw1\">for</span> k <span class=\"kw1\">in</span> <span class=\"kw2\">range</span><span class=\"br0\">(</span>p<span class=\"br0\">)</span><span class=\"br0\">)</span><br/>    <span class=\"kw1\">return</span> c<br/>\u00a0<br/>\u00a0<br/><span class=\"kw1\">def</span> mapmat<span class=\"br0\">(</span>f<span class=\"sy0\">,</span> a<span class=\"br0\">)</span>:<br/>    <span class=\"kw1\">return</span> <span class=\"br0\">[</span><span class=\"kw2\">list</span><span class=\"br0\">(</span><span class=\"kw2\">map</span><span class=\"br0\">(</span>f<span class=\"sy0\">,</span> v<span class=\"br0\">)</span><span class=\"br0\">)</span> <span class=\"kw1\">for</span> v <span class=\"kw1\">in</span> a<span class=\"br0\">]</span><br/>\u00a0<br/><span class=\"kw1\">def</span> ratmat<span class=\"br0\">(</span>a<span class=\"br0\">)</span>:<br/>    <span class=\"kw1\">return</span> mapmat<span class=\"br0\">(</span>Fraction<span class=\"sy0\">,</span> a<span class=\"br0\">)</span><br/>\u00a0<br/><span class=\"co1\"># As an example, compute the determinant and inverse of 3x3 magic square</span><br/>\u00a0<br/>a <span class=\"sy0\">=</span> <span class=\"br0\">[</span><span class=\"br0\">[</span><span class=\"nu0\">2</span><span class=\"sy0\">,</span> <span class=\"nu0\">9</span><span class=\"sy0\">,</span> <span class=\"nu0\">4</span><span class=\"br0\">]</span><span class=\"sy0\">,</span> <span class=\"br0\">[</span><span class=\"nu0\">7</span><span class=\"sy0\">,</span> <span class=\"nu0\">5</span><span class=\"sy0\">,</span> <span class=\"nu0\">3</span><span class=\"br0\">]</span><span class=\"sy0\">,</span> <span class=\"br0\">[</span><span class=\"nu0\">6</span><span class=\"sy0\">,</span> <span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">8</span><span class=\"br0\">]</span><span class=\"br0\">]</span><br/>b <span class=\"sy0\">=</span> <span class=\"br0\">[</span><span class=\"br0\">[</span><span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">0</span><span class=\"br0\">]</span><span class=\"sy0\">,</span> <span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">0</span><span class=\"br0\">]</span><span class=\"sy0\">,</span> <span class=\"br0\">[</span><span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">1</span><span class=\"br0\">]</span><span class=\"br0\">]</span><br/>det<span class=\"sy0\">,</span> c <span class=\"sy0\">=</span> gauss<span class=\"br0\">(</span>a<span class=\"sy0\">,</span> b<span class=\"br0\">)</span><br/>\u00a0<br/>det<br/>-<span class=\"nu0\">360.0</span><br/>\u00a0<br/>c<br/><span class=\"br0\">[</span><span class=\"br0\">[</span>-<span class=\"nu0\">0.10277777777777776</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.18888888888888888</span><span class=\"sy0\">,</span> -<span class=\"nu0\">0.019444444444444438</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/><span class=\"br0\">[</span><span class=\"nu0\">0.10555555555555554</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.02222222222222223</span><span class=\"sy0\">,</span> -<span class=\"nu0\">0.061111111111111116</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/><span class=\"br0\">[</span><span class=\"nu0\">0.0638888888888889</span><span class=\"sy0\">,</span> -<span class=\"nu0\">0.14444444444444446</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.14722222222222223</span><span class=\"br0\">]</span><span class=\"br0\">]</span><br/>\u00a0<br/><span class=\"co1\"># Check product</span><br/>matmul<span class=\"br0\">(</span>a<span class=\"sy0\">,</span> c<span class=\"br0\">)</span><br/><span class=\"br0\">[</span><span class=\"br0\">[</span><span class=\"nu0\">1.0</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.0</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.0</span><span class=\"br0\">]</span><span class=\"sy0\">,</span> <span class=\"br0\">[</span><span class=\"nu0\">5.551115123125783e-17</span><span class=\"sy0\">,</span> <span class=\"nu0\">1.0</span><span class=\"sy0\">,</span> <span class=\"nu0\">0.0</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/><span class=\"br0\">[</span><span class=\"nu0\">1.1102230246251565e-16</span><span class=\"sy0\">,</span> -<span class=\"nu0\">2.220446049250313e-16</span><span class=\"sy0\">,</span> <span class=\"nu0\">1.0</span><span class=\"br0\">]</span><span class=\"br0\">]</span><br/>\u00a0<br/><span class=\"co1\"># Same with fractions, so the result is exact</span><br/>\u00a0<br/>det<span class=\"sy0\">,</span> c <span class=\"sy0\">=</span> gauss<span class=\"br0\">(</span>ratmat<span class=\"br0\">(</span>a<span class=\"br0\">)</span><span class=\"sy0\">,</span> ratmat<span class=\"br0\">(</span>b<span class=\"br0\">)</span><span class=\"br0\">)</span><br/>\u00a0<br/>det<br/>Fraction<span class=\"br0\">(</span>-<span class=\"nu0\">360</span><span class=\"sy0\">,</span> <span class=\"nu0\">1</span><span class=\"br0\">)</span><br/>\u00a0<br/>c<br/><span class=\"br0\">[</span><span class=\"br0\">[</span>Fraction<span class=\"br0\">(</span>-<span class=\"nu0\">37</span><span class=\"sy0\">,</span> <span class=\"nu0\">360</span><span class=\"br0\">)</span><span class=\"sy0\">,</span> Fraction<span class=\"br0\">(</span><span class=\"nu0\">17</span><span class=\"sy0\">,</span> <span class=\"nu0\">90</span><span class=\"br0\">)</span><span class=\"sy0\">,</span> Fraction<span class=\"br0\">(</span>-<span class=\"nu0\">7</span><span class=\"sy0\">,</span> <span class=\"nu0\">360</span><span class=\"br0\">)</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/><span class=\"br0\">[</span>Fraction<span class=\"br0\">(</span><span class=\"nu0\">19</span><span class=\"sy0\">,</span> <span class=\"nu0\">180</span><span class=\"br0\">)</span><span class=\"sy0\">,</span> Fraction<span class=\"br0\">(</span><span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">45</span><span class=\"br0\">)</span><span class=\"sy0\">,</span> Fraction<span class=\"br0\">(</span>-<span class=\"nu0\">11</span><span class=\"sy0\">,</span> <span class=\"nu0\">180</span><span class=\"br0\">)</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/><span class=\"br0\">[</span>Fraction<span class=\"br0\">(</span><span class=\"nu0\">23</span><span class=\"sy0\">,</span> <span class=\"nu0\">360</span><span class=\"br0\">)</span><span class=\"sy0\">,</span> Fraction<span class=\"br0\">(</span>-<span class=\"nu0\">13</span><span class=\"sy0\">,</span> <span class=\"nu0\">90</span><span class=\"br0\">)</span><span class=\"sy0\">,</span> Fraction<span class=\"br0\">(</span><span class=\"nu0\">53</span><span class=\"sy0\">,</span> <span class=\"nu0\">360</span><span class=\"br0\">)</span><span class=\"br0\">]</span><span class=\"br0\">]</span><br/>\u00a0<br/>matmul<span class=\"br0\">(</span>a<span class=\"sy0\">,</span> c<span class=\"br0\">)</span><br/><span class=\"br0\">[</span><span class=\"br0\">[</span>Fraction<span class=\"br0\">(</span><span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">1</span><span class=\"br0\">)</span><span class=\"sy0\">,</span> Fraction<span class=\"br0\">(</span><span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">1</span><span class=\"br0\">)</span><span class=\"sy0\">,</span> Fraction<span class=\"br0\">(</span><span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">1</span><span class=\"br0\">)</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/><span class=\"br0\">[</span>Fraction<span class=\"br0\">(</span><span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">1</span><span class=\"br0\">)</span><span class=\"sy0\">,</span> Fraction<span class=\"br0\">(</span><span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">1</span><span class=\"br0\">)</span><span class=\"sy0\">,</span> Fraction<span class=\"br0\">(</span><span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">1</span><span class=\"br0\">)</span><span class=\"br0\">]</span><span class=\"sy0\">,</span><br/><span class=\"br0\">[</span>Fraction<span class=\"br0\">(</span><span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">1</span><span class=\"br0\">)</span><span class=\"sy0\">,</span> Fraction<span class=\"br0\">(</span><span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"nu0\">1</span><span class=\"br0\">)</span><span class=\"sy0\">,</span> Fraction<span class=\"br0\">(</span><span class=\"nu0\">1</span><span class=\"sy0\">,</span> <span class=\"nu0\">1</span><span class=\"br0\">)</span><span class=\"br0\">]</span><span class=\"br0\">]</span></pre>"}, {"lang": "Racket", "loc": 15, "block": "<pre class=\"text highlighted_source\">\u00a0<br/>#lang racket<br/>(require math/matrix)<br/>(define A <br/>  (matrix [[1.00  0.00  0.00  0.00  0.00   0.00]<br/>           [1.00  0.63  0.39  0.25  0.16   0.10]<br/>           [1.00  1.26  1.58  1.98  2.49   3.13]<br/>           [1.00  1.88  3.55  6.70 12.62  23.80]<br/>           [1.00  2.51  6.32 15.88 39.90 100.28]<br/>           [1.00  3.14  9.87 31.01 97.41 306.02]]))<br/>\u00a0<br/>(define b (col-matrix [-0.01 0.61 0.91 0.99 0.60 0.02]))<br/>\u00a0<br/>(matrix-solve A b)<br/>\u00a0</pre>"}, {"lang": "REXX", "loc": 90, "block": "<pre class=\"rexx highlighted_source\"><span class=\"coMULTI\">/* REXX ---------------------------------------------------------------<br/>* 07.08.2014 Walter Pachl translated from PL/I)<br/>* improved to get integer results for, e.g. this input:<br/>  -6 -18  13   6  -6 -15  -2  -9    -231<br/>   2  20   9   2  16 -12 -18  -5     647<br/>  23  18 -14 -14  -1  16  25 -17    -907<br/>  -8  -1 -19   4   3 -14  23   8     248<br/>  25  20  -6  15   0 -10   9  17    1316<br/> -13  -1   3   5  -2  17  14 -12   -1080<br/>  19  24 -21  -5 -19   0 -24 -17    1006<br/>  20  -3 -14 -16 -23 -25 -15  20    1496 <br/>*--------------------------------------------------------------------*/</span><br/>  <span class=\"kw1\">Numeric</span> <span class=\"kw2\">Digits</span> <span class=\"nu0\">20</span><br/>  <span class=\"kw1\">Parse</span> <span class=\"kw1\">Arg</span> t<br/>  n=<span class=\"nu0\">3</span><br/>  <span class=\"kw1\">Parse</span> <span class=\"kw2\">Value</span> <span class=\"st0\">'1  2  3 14'</span> <span class=\"kw2\">With</span> a<span class=\"sy0\">.</span>1<span class=\"sy0\">.</span>1 a<span class=\"sy0\">.</span>1<span class=\"sy0\">.</span>2 a<span class=\"sy0\">.</span>1<span class=\"sy0\">.</span>3 b<span class=\"sy0\">.</span>1<br/>  <span class=\"kw1\">Parse</span> <span class=\"kw2\">Value</span> <span class=\"st0\">'2  1  3 13'</span> <span class=\"kw2\">With</span> a<span class=\"sy0\">.</span>2<span class=\"sy0\">.</span>1 a<span class=\"sy0\">.</span>2<span class=\"sy0\">.</span>2 a<span class=\"sy0\">.</span>2<span class=\"sy0\">.</span>3 b<span class=\"sy0\">.</span>2<br/>  <span class=\"kw1\">Parse</span> <span class=\"kw2\">Value</span> <span class=\"st0\">'3 -2 -1 -4'</span> <span class=\"kw2\">With</span> a<span class=\"sy0\">.</span>3<span class=\"sy0\">.</span>1 a<span class=\"sy0\">.</span>3<span class=\"sy0\">.</span>2 a<span class=\"sy0\">.</span>3<span class=\"sy0\">.</span>3 b<span class=\"sy0\">.</span>3<br/>  <span class=\"kw1\">If</span> t=<span class=\"nu0\">6</span> <span class=\"kw3\">Then</span> <span class=\"kw1\">Do</span><br/>    n=<span class=\"nu0\">6</span><br/>    <span class=\"kw1\">Parse</span> <span class=\"kw2\">Value</span> <span class=\"st0\">'1.00 0.00 0.00  0.00  0.00 0.00  '</span> <span class=\"kw2\">With</span> a<span class=\"sy0\">.</span>1<span class=\"sy0\">.</span>1 a<span class=\"sy0\">.</span>1<span class=\"sy0\">.</span>2 a<span class=\"sy0\">.</span>1<span class=\"sy0\">.</span>3 a<span class=\"sy0\">.</span>1<span class=\"sy0\">.</span>4 a<span class=\"sy0\">.</span>1<span class=\"sy0\">.</span>5 a<span class=\"sy0\">.</span>1<span class=\"sy0\">.</span>6 <span class=\"sy0\">.</span><br/>    <span class=\"kw1\">Parse</span> <span class=\"kw2\">Value</span> <span class=\"st0\">'1.00 0.63 0.39  0.25  0.16 0.10  '</span> <span class=\"kw2\">With</span> a<span class=\"sy0\">.</span>2<span class=\"sy0\">.</span>1 a<span class=\"sy0\">.</span>2<span class=\"sy0\">.</span>2 a<span class=\"sy0\">.</span>2<span class=\"sy0\">.</span>3 a<span class=\"sy0\">.</span>2<span class=\"sy0\">.</span>4 a<span class=\"sy0\">.</span>2<span class=\"sy0\">.</span>5 a<span class=\"sy0\">.</span>2<span class=\"sy0\">.</span>6 <span class=\"sy0\">.</span><br/>    <span class=\"kw1\">Parse</span> <span class=\"kw2\">Value</span> <span class=\"st0\">'1.00 1.26 1.58  1.98  2.49 3.13  '</span> <span class=\"kw2\">With</span> a<span class=\"sy0\">.</span>3<span class=\"sy0\">.</span>1 a<span class=\"sy0\">.</span>3<span class=\"sy0\">.</span>2 a<span class=\"sy0\">.</span>3<span class=\"sy0\">.</span>3 a<span class=\"sy0\">.</span>3<span class=\"sy0\">.</span>4 a<span class=\"sy0\">.</span>3<span class=\"sy0\">.</span>5 a<span class=\"sy0\">.</span>3<span class=\"sy0\">.</span>6 <span class=\"sy0\">.</span><br/>    <span class=\"kw1\">Parse</span> <span class=\"kw2\">Value</span> <span class=\"st0\">'1.00 1.88 3.55  6.70 12.62 23.80 '</span> <span class=\"kw2\">With</span> a<span class=\"sy0\">.</span>4<span class=\"sy0\">.</span>1 a<span class=\"sy0\">.</span>4<span class=\"sy0\">.</span>2 a<span class=\"sy0\">.</span>4<span class=\"sy0\">.</span>3 a<span class=\"sy0\">.</span>4<span class=\"sy0\">.</span>4 a<span class=\"sy0\">.</span>4<span class=\"sy0\">.</span>5 a<span class=\"sy0\">.</span>4<span class=\"sy0\">.</span>6 <span class=\"sy0\">.</span><br/>    <span class=\"kw1\">Parse</span> <span class=\"kw2\">Value</span> <span class=\"st0\">'1.00 2.51 6.32 15.88 39.90 100.28'</span> <span class=\"kw2\">With</span> a<span class=\"sy0\">.</span>5<span class=\"sy0\">.</span>1 a<span class=\"sy0\">.</span>5<span class=\"sy0\">.</span>2 a<span class=\"sy0\">.</span>5<span class=\"sy0\">.</span>3 a<span class=\"sy0\">.</span>5<span class=\"sy0\">.</span>4 a<span class=\"sy0\">.</span>5<span class=\"sy0\">.</span>5 a<span class=\"sy0\">.</span>5<span class=\"sy0\">.</span>6 <span class=\"sy0\">.</span><br/>    <span class=\"kw1\">Parse</span> <span class=\"kw2\">Value</span> <span class=\"st0\">'1.00 3.14 9.87 31.01 97.41 306.02'</span> <span class=\"kw2\">With</span> a<span class=\"sy0\">.</span>6<span class=\"sy0\">.</span>1 a<span class=\"sy0\">.</span>6<span class=\"sy0\">.</span>2 a<span class=\"sy0\">.</span>6<span class=\"sy0\">.</span>3 a<span class=\"sy0\">.</span>6<span class=\"sy0\">.</span>4 a<span class=\"sy0\">.</span>6<span class=\"sy0\">.</span>5 a<span class=\"sy0\">.</span>6<span class=\"sy0\">.</span>6 <span class=\"sy0\">.</span><br/>    <span class=\"kw1\">Parse</span> <span class=\"kw2\">Value</span> <span class=\"st0\">'-0.01 0.61 0.91 0.99 0.60 0.02'</span>    <span class=\"kw2\">With</span> b<span class=\"sy0\">.</span>1 b<span class=\"sy0\">.</span>2 b<span class=\"sy0\">.</span>3 b<span class=\"sy0\">.</span>4 b<span class=\"sy0\">.</span>5 b<span class=\"sy0\">.</span>6 <span class=\"sy0\">.</span><br/>    <span class=\"kw3\">End</span><br/>  <span class=\"kw1\">Do</span> i=<span class=\"nu0\">1</span> <span class=\"kw2\">To</span> n<br/>    <span class=\"kw1\">Do</span> j=<span class=\"nu0\">1</span> <span class=\"kw2\">To</span> n<br/>      sa<span class=\"sy0\">.</span>i<span class=\"sy0\">.</span>j=a<span class=\"sy0\">.</span>i<span class=\"sy0\">.</span>j<br/>      <span class=\"kw3\">End</span><br/>    sb<span class=\"sy0\">.</span>i=b<span class=\"sy0\">.</span>i<br/>    <span class=\"kw3\">End</span><br/>  <span class=\"kw1\">Say</span> <span class=\"st0\">'The equations are:'</span><br/>  <span class=\"kw1\">do</span> i = <span class=\"nu0\">1</span> <span class=\"kw2\">to</span> n;<br/>    ol=<span class=\"st0\">''</span><br/>    <span class=\"kw1\">Do</span> j=<span class=\"nu0\">1</span> <span class=\"kw2\">To</span> n<br/>      ol=ol <span class=\"kw6\">format</span><span class=\"br0\">(</span>a<span class=\"sy0\">.</span>i<span class=\"sy0\">.</span>j,<span class=\"nu0\">4</span>,<span class=\"nu0\">4</span><span class=\"br0\">)</span><br/>      <span class=\"kw3\">End</span><br/>    ol=ol<span class=\"st0\">'  '</span><span class=\"kw6\">format</span><span class=\"br0\">(</span>b<span class=\"sy0\">.</span>i,<span class=\"nu0\">4</span>,<span class=\"nu0\">4</span><span class=\"br0\">)</span><br/>    <span class=\"kw1\">Say</span> ol<br/>    <span class=\"kw3\">end</span><br/>\u00a0<br/>  <span class=\"kw1\">call</span> Gauss_elimination<br/>\u00a0<br/>  <span class=\"kw1\">call</span> Backward_substitution<br/>\u00a0<br/>  <span class=\"kw1\">Say</span> <span class=\"st0\">'Solutions:'</span><br/>  <span class=\"kw1\">Do</span> i=<span class=\"nu0\">1</span> <span class=\"kw2\">To</span> n<br/>    <span class=\"kw1\">Say</span> <span class=\"st0\">'x('</span>i<span class=\"st0\">')='</span><span class=\"sy0\">||</span>x<span class=\"sy0\">.</span>i<br/>    <span class=\"kw3\">End</span><br/>\u00a0<br/>  <span class=\"coMULTI\">/* Check solutions: */</span><br/>  <span class=\"kw1\">Say</span> <span class=\"st0\">'Residuals:'</span><br/>  <span class=\"kw1\">do</span> i = <span class=\"nu0\">1</span> <span class=\"kw2\">to</span> n<br/>    res=<span class=\"nu0\">0</span><br/>    <span class=\"kw1\">Do</span> j=<span class=\"nu0\">1</span> <span class=\"kw2\">To</span> n<br/>      res=res+<span class=\"br0\">(</span>sa<span class=\"sy0\">.</span>i<span class=\"sy0\">.</span>j<span class=\"sy0\">*</span>x<span class=\"sy0\">.</span>j<span class=\"br0\">)</span><br/>      <span class=\"kw3\">End</span><br/>    res=res-sb<span class=\"sy0\">.</span>i<br/>    <span class=\"kw1\">Say</span> <span class=\"st0\">'res('</span>i<span class=\"st0\">')='</span>res<br/>    <span class=\"kw3\">End</span><br/>\u00a0<br/><span class=\"kw1\">Exit</span><br/>\u00a0<br/>Gauss_elimination:<br/>  <span class=\"kw1\">Do</span> j=<span class=\"nu0\">1</span> <span class=\"kw2\">to</span> n-<span class=\"nu0\">1</span>                    <br/>    ma=a<span class=\"sy0\">.</span>j<span class=\"sy0\">.</span>j                       <br/>    <span class=\"kw1\">Do</span> ja=j+<span class=\"nu0\">1</span> <span class=\"kw2\">To</span> n                 <br/>      mb=a<span class=\"sy0\">.</span>ja<span class=\"sy0\">.</span>j                    <br/>      <span class=\"kw1\">Do</span> i=<span class=\"nu0\">1</span> <span class=\"kw2\">To</span> n                  <br/>        new=a<span class=\"sy0\">.</span>j<span class=\"sy0\">.</span>i<span class=\"sy0\">*</span>mb-a<span class=\"sy0\">.</span>ja<span class=\"sy0\">.</span>i<span class=\"sy0\">*</span>ma     <br/>        a<span class=\"sy0\">.</span>ja<span class=\"sy0\">.</span>i=new                 <br/>        <span class=\"kw3\">End</span>                        <br/>      b<span class=\"sy0\">.</span>ja=b<span class=\"sy0\">.</span>j<span class=\"sy0\">*</span>mb-b<span class=\"sy0\">.</span>ja<span class=\"sy0\">*</span>ma          <br/>      <span class=\"kw3\">End</span>                          <br/>    <span class=\"kw3\">End</span><br/>  <span class=\"kw1\">Return</span><br/>\u00a0<br/>Backward_substitution:<br/>  x<span class=\"sy0\">.</span>n = b<span class=\"sy0\">.</span>n <span class=\"sy0\">/</span> a<span class=\"sy0\">.</span>n<span class=\"sy0\">.</span>n<br/>  <span class=\"kw1\">do</span> j = n-<span class=\"nu0\">1</span> <span class=\"kw2\">to</span> <span class=\"nu0\">1</span> <span class=\"kw2\">by</span> -<span class=\"nu0\">1</span><br/>     t = <span class=\"nu0\">0</span><br/>     <span class=\"kw1\">do</span> i = j+<span class=\"nu0\">1</span> <span class=\"kw2\">to</span> n<br/>        t = t + a<span class=\"sy0\">.</span>j<span class=\"sy0\">.</span>i<span class=\"sy0\">*</span>x<span class=\"sy0\">.</span>i<br/>     <span class=\"kw3\">end</span><br/>     x<span class=\"sy0\">.</span>j = <span class=\"br0\">(</span>b<span class=\"sy0\">.</span>j - t<span class=\"br0\">)</span> <span class=\"sy0\">/</span> a<span class=\"sy0\">.</span>j<span class=\"sy0\">.</span>j<br/>  <span class=\"kw3\">end</span><br/>  <span class=\"kw1\">Return</span></pre>"}, {"lang": "Ruby", "loc": 19, "block": "<pre class=\"ruby highlighted_source\">\u00a0<br/><span class=\"kw3\">require</span> <span class=\"st0\">'bigdecimal/ludcmp'</span><br/><span class=\"kw1\">include</span> LUSolve<br/>\u00a0<br/>BigDecimal::limit<span class=\"br0\">(</span><span class=\"nu0\">30</span><span class=\"br0\">)</span><br/>\u00a0<br/>a = <span class=\"br0\">[</span><span class=\"nu0\">1.00</span>, <span class=\"nu0\">0.00</span>, <span class=\"nu0\">0.00</span>, <span class=\"nu0\">0.00</span>, <span class=\"nu0\">0.00</span>, <span class=\"nu0\">0.00</span>,<br/>     <span class=\"nu0\">1.00</span>, <span class=\"nu0\">0.63</span>, <span class=\"nu0\">0.39</span>, <span class=\"nu0\">0.25</span>, <span class=\"nu0\">0.16</span>, <span class=\"nu0\">0.10</span>,<br/>     <span class=\"nu0\">1.00</span>, <span class=\"nu0\">1.26</span>, <span class=\"nu0\">1.58</span>, <span class=\"nu0\">1.98</span>, <span class=\"nu0\">2.49</span>, <span class=\"nu0\">3.13</span>,<br/>     <span class=\"nu0\">1.00</span>, <span class=\"nu0\">1.88</span>, <span class=\"nu0\">3.55</span>, <span class=\"nu0\">6.70</span>, <span class=\"nu0\">12.62</span>, <span class=\"nu0\">23.80</span>,<br/>     <span class=\"nu0\">1.00</span>, <span class=\"nu0\">2.51</span>, <span class=\"nu0\">6.32</span>, <span class=\"nu0\">15.88</span>, <span class=\"nu0\">39.90</span>, <span class=\"nu0\">100.28</span>,<br/>     <span class=\"nu0\">1.00</span>, <span class=\"nu0\">3.14</span>, <span class=\"nu0\">9.87</span>, <span class=\"nu0\">31.01</span>, <span class=\"nu0\">97.41</span>, <span class=\"nu0\">306.02</span><span class=\"br0\">]</span>.<span class=\"me1\">map</span><span class=\"br0\">{</span><span class=\"sy0\">|</span>i<span class=\"sy0\">|</span>BigDecimal<span class=\"br0\">(</span>i,<span class=\"nu0\">16</span><span class=\"br0\">)</span><span class=\"br0\">}</span><br/>b = <span class=\"br0\">[</span><span class=\"sy0\">-</span><span class=\"nu0\">0.01</span>, <span class=\"nu0\">0.61</span>, <span class=\"nu0\">0.91</span>, <span class=\"nu0\">0.99</span>, <span class=\"nu0\">0.60</span>, <span class=\"nu0\">0.02</span><span class=\"br0\">]</span>.<span class=\"me1\">map</span><span class=\"br0\">{</span><span class=\"sy0\">|</span>i<span class=\"sy0\">|</span>BigDecimal<span class=\"br0\">(</span>i,<span class=\"nu0\">16</span><span class=\"br0\">)</span><span class=\"br0\">}</span><br/>\u00a0<br/>n = <span class=\"nu0\">6</span><br/>zero = BigDecimal<span class=\"br0\">(</span><span class=\"st0\">\"0.0\"</span><span class=\"br0\">)</span><br/>one  = BigDecimal<span class=\"br0\">(</span><span class=\"st0\">\"1.0\"</span><span class=\"br0\">)</span><br/>\u00a0<br/>lusolve<span class=\"br0\">(</span>a, b, ludecomp<span class=\"br0\">(</span>a, n, zero,one<span class=\"br0\">)</span>, zero<span class=\"br0\">)</span>.<span class=\"me1\">each</span><span class=\"br0\">{</span><span class=\"sy0\">|</span>v<span class=\"sy0\">|</span> <span class=\"kw3\">puts</span> v.<span class=\"me1\">to_s</span><span class=\"br0\">(</span><span class=\"st0\">'F'</span><span class=\"br0\">)</span><span class=\"br0\">[</span><span class=\"nu0\">0</span>..<span class=\"nu0\">20</span><span class=\"br0\">]</span><span class=\"br0\">}</span></pre>"}, {"lang": "Sidef", "loc": 22, "block": "<pre class=\"ruby highlighted_source\">func gauss_jordan_solve <span class=\"br0\">(</span>a, b<span class=\"br0\">)</span> <span class=\"br0\">{</span><br/>\u00a0<br/>    var A = gather <span class=\"br0\">{</span><br/>        ^b <span class=\"sy0\">-&gt;</span> each <span class=\"br0\">{</span><span class=\"sy0\">|</span>i<span class=\"sy0\">|</span> take<span class=\"br0\">(</span>a<span class=\"br0\">[</span>i<span class=\"br0\">]</span> <span class=\"sy0\">+</span> b<span class=\"br0\">[</span>i<span class=\"br0\">]</span><span class=\"br0\">)</span> <span class=\"br0\">}</span><br/>    <span class=\"br0\">}</span><br/>\u00a0<br/>    rref<span class=\"br0\">(</span>A<span class=\"br0\">)</span>.<span class=\"me1\">map</span><span class=\"br0\">{</span> .<span class=\"me1\">last</span> <span class=\"br0\">}</span><br/><span class=\"br0\">}</span><br/>\u00a0<br/>var a = <span class=\"br0\">[</span><br/>    <span class=\"br0\">[</span> <span class=\"nu0\">1.00</span>, <span class=\"nu0\">0.00</span>, <span class=\"nu0\">0.00</span>,  <span class=\"nu0\">0.00</span>,  <span class=\"nu0\">0.00</span>,   <span class=\"nu0\">0.00</span> <span class=\"br0\">]</span>,<br/>    <span class=\"br0\">[</span> <span class=\"nu0\">1.00</span>, <span class=\"nu0\">0.63</span>, <span class=\"nu0\">0.39</span>,  <span class=\"nu0\">0.25</span>,  <span class=\"nu0\">0.16</span>,   <span class=\"nu0\">0.10</span> <span class=\"br0\">]</span>,<br/>    <span class=\"br0\">[</span> <span class=\"nu0\">1.00</span>, <span class=\"nu0\">1.26</span>, <span class=\"nu0\">1.58</span>,  <span class=\"nu0\">1.98</span>,  <span class=\"nu0\">2.49</span>,   <span class=\"nu0\">3.13</span> <span class=\"br0\">]</span>,<br/>    <span class=\"br0\">[</span> <span class=\"nu0\">1.00</span>, <span class=\"nu0\">1.88</span>, <span class=\"nu0\">3.55</span>,  <span class=\"nu0\">6.70</span>, <span class=\"nu0\">12.62</span>,  <span class=\"nu0\">23.80</span> <span class=\"br0\">]</span>,<br/>    <span class=\"br0\">[</span> <span class=\"nu0\">1.00</span>, <span class=\"nu0\">2.51</span>, <span class=\"nu0\">6.32</span>, <span class=\"nu0\">15.88</span>, <span class=\"nu0\">39.90</span>, <span class=\"nu0\">100.28</span> <span class=\"br0\">]</span>,<br/>    <span class=\"br0\">[</span> <span class=\"nu0\">1.00</span>, <span class=\"nu0\">3.14</span>, <span class=\"nu0\">9.87</span>, <span class=\"nu0\">31.01</span>, <span class=\"nu0\">97.41</span>, <span class=\"nu0\">306.02</span> <span class=\"br0\">]</span>,<br/><span class=\"br0\">]</span><br/>\u00a0<br/>var b = <span class=\"br0\">[</span> <span class=\"sy0\">-</span><span class=\"nu0\">0.01</span>, <span class=\"nu0\">0.61</span>, <span class=\"nu0\">0.91</span>, <span class=\"nu0\">0.99</span>, <span class=\"nu0\">0.60</span>, <span class=\"nu0\">0.02</span> <span class=\"br0\">]</span><br/>\u00a0<br/>var G = gauss_jordan_solve<span class=\"br0\">(</span>a, b<span class=\"br0\">)</span><br/>say G.<span class=\"me1\">map</span> <span class=\"br0\">{</span> <span class=\"st0\">\"%27s\"</span> <span class=\"sy0\">%</span> .<span class=\"me1\">as_rat</span> <span class=\"br0\">}</span>.<span class=\"me1\">join</span><span class=\"br0\">(</span><span class=\"st0\">\"<span class=\"es0\">\\n</span>\"</span><span class=\"br0\">)</span></pre>"}, {"lang": "Stata", "loc": 29, "block": "<pre class=\"text highlighted_source\">void gauss(real matrix a, real matrix b, real scalar det) {<br/>\treal scalar i,j,n,s<br/>\treal vector js<br/>\u00a0<br/>\tdet = 1<br/>\tn = rows(a)<br/>\tfor (i=1; i&lt;n; i++) {<br/>\t\tmaxindex(abs(a[i::n,i]), 1, js=., .)<br/>\t\tj = js[1]+i-1<br/>\t\tif (j!=i) {<br/>\t\t\ta[(i\\j),i..n] = a[(j\\i),i..n]<br/>\t\t\tb[(i\\j),.] = b[(j\\i),.]<br/>\t\t\tdet = -det<br/>\t\t}<br/>\t\tfor (j=i+1; j&lt;=n; j++) {<br/>\t\t\ts = a[j,i]/a[i,i]<br/>\t\t\ta[j,i+1..n] = a[j,i+1..n]-s*a[i,i+1..n]<br/>\t\t\tb[j,.] = b[j,.]-s*b[i,.]<br/>\t\t}<br/>\t}<br/>\u00a0<br/>\tfor (i=n; i&gt;=1; i--) {<br/>\t\tfor (j=i+1; j&lt;=n; j++) {<br/>\t\t\tb[i,.] = b[i,.]-a[i,j]*b[j,.]<br/>\t\t}<br/>\t\tb[i,.] = b[i,.]/a[i,i]<br/>\t\tdet = det*a[i,i]<br/>\t}<br/>}</pre>"}, {"lang": "Tcl", "loc": 12, "block": "<pre class=\"tcl highlighted_source\"><span class=\"kw2\">package</span> require math::<span class=\"me1\">linearalgebra</span><br/>\u00a0<br/><span class=\"kw1\">set</span> A <span class=\"br0\">{</span><br/>    <span class=\"br0\">{</span><span class=\"nu0\">1.00</span>  <span class=\"nu0\">0.00</span>  <span class=\"nu0\">0.00</span>  <span class=\"nu0\">0.00</span>  <span class=\"nu0\">0.00</span>   <span class=\"nu0\">0.00</span><span class=\"br0\">}</span><br/>    <span class=\"br0\">{</span><span class=\"nu0\">1.00</span>  <span class=\"nu0\">0.63</span>  <span class=\"nu0\">0.39</span>  <span class=\"nu0\">0.25</span>  <span class=\"nu0\">0.16</span>   <span class=\"nu0\">0.10</span><span class=\"br0\">}</span><br/>    <span class=\"br0\">{</span><span class=\"nu0\">1.00</span>  <span class=\"nu0\">1.26</span>  <span class=\"nu0\">1.58</span>  <span class=\"nu0\">1.98</span>  <span class=\"nu0\">2.49</span>   <span class=\"nu0\">3.13</span><span class=\"br0\">}</span><br/>    <span class=\"br0\">{</span><span class=\"nu0\">1.00</span>  <span class=\"nu0\">1.88</span>  <span class=\"nu0\">3.55</span>  <span class=\"nu0\">6.70</span> <span class=\"nu0\">12.62</span>  <span class=\"nu0\">23.80</span><span class=\"br0\">}</span><br/>    <span class=\"br0\">{</span><span class=\"nu0\">1.00</span>  <span class=\"nu0\">2.51</span>  <span class=\"nu0\">6.32</span> <span class=\"nu0\">15.88</span> <span class=\"nu0\">39.90</span> <span class=\"nu0\">100.28</span><span class=\"br0\">}</span><br/>    <span class=\"br0\">{</span><span class=\"nu0\">1.00</span>  <span class=\"nu0\">3.14</span>  <span class=\"nu0\">9.87</span> <span class=\"nu0\">31.01</span> <span class=\"nu0\">97.41</span> <span class=\"nu0\">306.02</span><span class=\"br0\">}</span><br/><span class=\"br0\">}</span><br/><span class=\"kw1\">set</span> b <span class=\"br0\">{</span>-<span class=\"nu0\">0.01</span> <span class=\"nu0\">0.61</span> <span class=\"nu0\">0.91</span> <span class=\"nu0\">0.99</span> <span class=\"nu0\">0.60</span> <span class=\"nu0\">0.02</span><span class=\"br0\">}</span><br/><span class=\"kw2\">puts</span> -nonewline <span class=\"br0\">[</span>math::<span class=\"me1\">linearalgebra</span>::<span class=\"me1\">show</span> <span class=\"br0\">[</span>math::<span class=\"me1\">linearalgebra</span>::<span class=\"me1\">solveGauss</span> <span class=\"re0\">$A</span> <span class=\"re0\">$b</span><span class=\"br0\">]</span> <span class=\"st0\">\"%.2f\"</span><span class=\"br0\">]</span></pre>"}, {"lang": "TI-83 BASIC", "loc": 8, "block": "<pre class=\"text highlighted_source\">[[   1.00   0.00   0.00   0.00   0.00   0.00  -0.01]<br/> [   1.00   0.63   0.39   0.25   0.16   0.10   0.61]<br/> [   1.00   1.26   1.58   1.98   2.49   3.13   0.91]<br/> [   1.00   1.88   3.55   6.70  12.62  23.80   0.99]<br/> [   1.00   2.51   6.32  15.88  39.90 100.28   0.60]<br/> [   1.00   3.14   9.87  31.01  97.41 306.02   0.02]]\u2192[A]<br/>Matr&gt;List(rref([A]),7,L1)<br/>L1</pre>"}, {"lang": "zkl", "loc": 11, "block": "<pre class=\"text highlighted_source\">var [const] GSL=Import(\"zklGSL\");\t// libGSL (GNU Scientific Library)<br/>a:=GSL.Matrix(6,6).set(<br/>   1.00, 0.00, 0.00,  0.00,  0.00,   0.00,<br/>   1.00, 0.63, 0.39,  0.25,  0.16,   0.10,<br/>   1.00, 1.26, 1.58,  1.98,  2.49,   3.13,<br/>   1.00, 1.88, 3.55,  6.70, 12.62,  23.80,<br/>   1.00, 2.51, 6.32, 15.88, 39.90, 100.28,<br/>   1.00, 3.14, 9.87, 31.01, 97.41, 306.02);<br/>b:=GSL.VectorFromData(-0.01, 0.61, 0.91,  0.99,  0.60,   0.02);<br/>x:=a.AxEQb(b);<br/>x.format(8,5).println();</pre>"}]}